<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 USGS National Water Information System (NWIS) | Environmental Informatics Using Research Infrastructures and their Data</title>
  <meta name="description" content="Course text for NAU INF 550" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 USGS National Water Information System (NWIS) | Environmental Informatics Using Research Infrastructures and their Data" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/Users/kdw223/Research/katharynduffy.github.io/images/EcoInfo4.png" />
  <meta property="og:description" content="Course text for NAU INF 550" />
  <meta name="github-repo" content="katharynduffy/katharynduffy.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 USGS National Water Information System (NWIS) | Environmental Informatics Using Research Infrastructures and their Data" />
  
  <meta name="twitter:description" content="Course text for NAU INF 550" />
  <meta name="twitter:image" content="/Users/kdw223/Research/katharynduffy.github.io/images/EcoInfo4.png" />

<meta name="author" content="Dr. Katharyn Duffy, Dr. Ben Ruddell" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="nasas-earth-observing-system-eos.html"/>
<link rel="next" href="frequently-asked-questions.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">INF550: EcoInformatics data collection tools & products, </a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#key-contributors"><i class="fa fa-check"></i>Key Contributors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html"><i class="fa fa-check"></i>Pre-Course Setup: EcoInformatics Tools</a><ul>
<li class="chapter" data-level="0.1" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#pre-course-skills-setup"><i class="fa fa-check"></i><b>0.1</b> Pre-Course Skills &amp; Setup</a><ul>
<li class="chapter" data-level="0.1.1" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#installing-or-updating-r"><i class="fa fa-check"></i><b>0.1.1</b> Installing or Updating R</a></li>
<li class="chapter" data-level="0.1.2" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#windows-rrstudio-setup"><i class="fa fa-check"></i><b>0.1.2</b> Windows R/RStudio Setup</a></li>
<li class="chapter" data-level="0.1.3" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#mac-rrstudio-setup"><i class="fa fa-check"></i><b>0.1.3</b> Mac R/RStudio Setup</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#linux-rrstudio-setup"><i class="fa fa-check"></i><b>0.2</b> Linux R/RStudio Setup</a><ul>
<li class="chapter" data-level="0.2.1" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#install-basic-packages-for-this-course"><i class="fa fa-check"></i><b>0.2.1</b> Install basic packages for this course</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#installing-and-setting-up-git-github-on-your-machine"><i class="fa fa-check"></i><b>0.3</b> Installing and Setting up Git &amp; Github on Your Machine</a></li>
<li class="chapter" data-level="0.4" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#installing-atom"><i class="fa fa-check"></i><b>0.4</b> Installing Atom</a></li>
<li class="chapter" data-level="0.5" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#linking-rstudio-to-git"><i class="fa fa-check"></i><b>0.5</b> Linking RStudio to Git</a></li>
<li class="chapter" data-level="0.6" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#how-we-will-be-conducting-this-course"><i class="fa fa-check"></i><b>0.6</b> How we will be Conducting this Course</a></li>
<li class="chapter" data-level="0.7" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#exercises"><i class="fa fa-check"></i><b>0.7</b> Exercises:</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="why-ecoinformatics.html"><a href="why-ecoinformatics.html"><i class="fa fa-check"></i><b>1</b> Why ‘EcoInformatics’?</a><ul>
<li class="chapter" data-level="1.1" data-path="why-ecoinformatics.html"><a href="why-ecoinformatics.html#the-framework-of-this-course"><i class="fa fa-check"></i><b>1.1</b> The Framework of this Course</a></li>
<li class="chapter" data-level="1.2" data-path="why-ecoinformatics.html"><a href="why-ecoinformatics.html#final-course-project-proposed-derived-data-product"><i class="fa fa-check"></i><b>1.2</b> Final Course Project: Proposed Derived Data Product</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html"><i class="fa fa-check"></i><b>2</b> Introduction to NEON &amp; its Data</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#learning-objectives"><i class="fa fa-check"></i><b>2.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#the-neon-project-mission-design"><i class="fa fa-check"></i><b>2.2</b> The NEON Project Mission &amp; Design</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#the-science-and-design-of-neon"><i class="fa fa-check"></i><b>2.3</b> The Science and Design of NEON</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#neons-spatial-design"><i class="fa fa-check"></i><b>2.4</b> NEON’s Spatial Design</a><ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#neon-samples-all-20-eco-regions"><i class="fa fa-check"></i><b>2.4.1</b> NEON Samples All 20 Eco-Regions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#how-neon-collects-data"><i class="fa fa-check"></i><b>2.5</b> How NEON Collects Data</a><ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#specimens-samples"><i class="fa fa-check"></i><b>2.5.1</b> Specimens &amp; Samples</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#airborne-remote-sensing"><i class="fa fa-check"></i><b>2.5.2</b> Airborne Remote Sensing</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#accessing-neon-data"><i class="fa fa-check"></i><b>2.6</b> Accessing NEON Data</a><ul>
<li class="chapter" data-level="2.6.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#pathways-to-access-neon-data"><i class="fa fa-check"></i><b>2.6.1</b> Pathways to access NEON Data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#hands-on-accessing-neon-data-user-tokens"><i class="fa fa-check"></i><b>2.7</b> Hands on: Accessing NEON Data &amp; User Tokens</a><ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#via-the-neon-api-with-your-user-token"><i class="fa fa-check"></i><b>2.7.1</b> Via the NEON API, with your User Token</a></li>
<li class="chapter" data-level="2.7.2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#get-a-neon-api-token"><i class="fa fa-check"></i><b>2.7.2</b> Get a NEON API Token</a></li>
<li class="chapter" data-level="2.7.3" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#use-the-api-token-in-neonutilities"><i class="fa fa-check"></i><b>2.7.3</b> Use the API token in neonUtilities</a></li>
<li class="chapter" data-level="2.7.4" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#token-management-for-open-code"><i class="fa fa-check"></i><b>2.7.4</b> Token management for open code</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#hands-on-neon-tos-data"><i class="fa fa-check"></i><b>2.8</b> Hands on: NEON TOS Data</a><ul>
<li class="chapter" data-level="2.8.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#pull-in-tree-data-from-neons-tos-and-investigate-relationships"><i class="fa fa-check"></i><b>2.8.1</b> Pull in Tree Data from NEON’s TOS and investigate relationships</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#intro-to-neon-exercises-part-1"><i class="fa fa-check"></i><b>2.9</b> Intro to NEON Exercises Part 1</a><ul>
<li class="chapter" data-level="2.9.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#computational"><i class="fa fa-check"></i><b>2.9.1</b> Computational</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#part-2-pulling-neon-data-via-the-api"><i class="fa fa-check"></i><b>2.10</b> Part 2: Pulling NEON Data via the API</a></li>
<li class="chapter" data-level="2.11" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#what-is-an-api"><i class="fa fa-check"></i><b>2.11</b> What is an API?</a><ul>
<li class="chapter" data-level="2.11.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#anatomy-of-an-api-call"><i class="fa fa-check"></i><b>2.11.1</b> Anatomy of an API call</a></li>
<li class="chapter" data-level="2.11.2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#targets"><i class="fa fa-check"></i><b>2.11.2</b> Targets:</a></li>
<li class="chapter" data-level="2.11.3" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#observational-data-os"><i class="fa fa-check"></i><b>2.11.3</b> Observational data (OS)</a></li>
<li class="chapter" data-level="2.11.4" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#instrumentation-data-is"><i class="fa fa-check"></i><b>2.11.4</b> Instrumentation data (IS)</a></li>
<li class="chapter" data-level="2.11.5" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#remote-sensing-data-aop"><i class="fa fa-check"></i><b>2.11.5</b> Remote sensing data (AOP)</a></li>
<li class="chapter" data-level="2.11.6" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#geolocation-data"><i class="fa fa-check"></i><b>2.11.6</b> Geolocation data</a></li>
<li class="chapter" data-level="2.11.7" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#querying-a-single-named-location"><i class="fa fa-check"></i><b>2.11.7</b> Querying a single named location</a></li>
<li class="chapter" data-level="2.11.8" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#taxonomy"><i class="fa fa-check"></i><b>2.11.8</b> Taxonomy</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#stacking-neon-data"><i class="fa fa-check"></i><b>2.12</b> Stacking NEON data</a></li>
<li class="chapter" data-level="2.13" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#intro-to-neon-exercises-written-questions"><i class="fa fa-check"></i><b>2.13</b> Intro to NEON Exercises: Written Questions</a></li>
<li class="chapter" data-level="2.14" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#intro-to-neon-exercises-part-2"><i class="fa fa-check"></i><b>2.14</b> Intro to NEON Exercises Part 2</a><ul>
<li class="chapter" data-level="2.14.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#written"><i class="fa fa-check"></i><b>2.14.1</b> Written</a></li>
<li class="chapter" data-level="2.14.2" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#neon-coding-lab-part-2"><i class="fa fa-check"></i><b>2.14.2</b> NEON Coding Lab Part 2</a></li>
</ul></li>
<li class="chapter" data-level="2.15" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#neon-coding-lab-part-2-1"><i class="fa fa-check"></i><b>2.15</b> NEON Coding Lab Part 2</a></li>
<li class="chapter" data-level="2.16" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#intro-to-neon-culmination-activity"><i class="fa fa-check"></i><b>2.16</b> Intro to NEON Culmination Activity</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html"><i class="fa fa-check"></i><b>3</b> Introduction to USA-NPN &amp; its Data</a><ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#hands-on-accessing-usa-npn-data-via-rnpn"><i class="fa fa-check"></i><b>3.1</b> Hands on: Accessing USA-NPN Data via rNPN</a><ul>
<li class="chapter" data-level="3.1.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#introduction"><i class="fa fa-check"></i><b>3.1.1</b> Introduction</a></li>
<li class="chapter" data-level="3.1.2" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#accessing-usa-npn-observational-data"><i class="fa fa-check"></i><b>3.1.2</b> Accessing USA-NPN Observational Data</a></li>
<li class="chapter" data-level="3.1.3" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#status-and-intensity-data"><i class="fa fa-check"></i><b>3.1.3</b> Status and Intensity Data</a></li>
<li class="chapter" data-level="3.1.4" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#individual-phenometrics"><i class="fa fa-check"></i><b>3.1.4</b> Individual Phenometrics</a></li>
<li class="chapter" data-level="3.1.5" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#site-phenometrics"><i class="fa fa-check"></i><b>3.1.5</b> Site Phenometrics</a></li>
<li class="chapter" data-level="3.1.6" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#magnitude-phenometrics"><i class="fa fa-check"></i><b>3.1.6</b> Magnitude Phenometrics</a></li>
<li class="chapter" data-level="3.1.7" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#usa-npn-geospatial-data"><i class="fa fa-check"></i><b>3.1.7</b> USA-NPN Geospatial Data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#accumulated-growing-degree-day-products"><i class="fa fa-check"></i><b>3.2</b> Accumulated Growing Degree Day Products</a></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#extended-spring-indices"><i class="fa fa-check"></i><b>3.3</b> Extended Spring Indices</a><ul>
<li class="chapter" data-level="3.3.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#other-layers"><i class="fa fa-check"></i><b>3.3.1</b> Other Layers</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#putting-it-all-together"><i class="fa fa-check"></i><b>3.4</b> Putting it all together:</a></li>
<li class="chapter" data-level="3.5" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#combine-point-and-raster-data"><i class="fa fa-check"></i><b>3.5</b> Combine Point and Raster Data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#step-1-get-the-data"><i class="fa fa-check"></i><b>3.5.1</b> Step 1: Get the data</a></li>
<li class="chapter" data-level="3.5.2" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#step-2-preparing-the-data"><i class="fa fa-check"></i><b>3.5.2</b> Step 2: Preparing the data</a></li>
<li class="chapter" data-level="3.5.3" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#step-3-define-style-options-and-create-graph"><i class="fa fa-check"></i><b>3.5.3</b> Step 3: Define style options and create graph</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#live-demo-code-with-lee-marsh-of-usa-npn"><i class="fa fa-check"></i><b>3.6</b> Live Demo Code with Lee Marsh of USA-NPN</a><ul>
<li class="chapter" data-level="3.6.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#basic-utility-functions"><i class="fa fa-check"></i><b>3.6.1</b> Basic Utility Functions</a></li>
<li class="chapter" data-level="3.6.2" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#download-observational-data"><i class="fa fa-check"></i><b>3.6.2</b> Download Observational Data</a></li>
<li class="chapter" data-level="3.6.3" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#magnitude-data"><i class="fa fa-check"></i><b>3.6.3</b> Magnitude Data</a></li>
<li class="chapter" data-level="3.6.4" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#downloading-geospatial-data"><i class="fa fa-check"></i><b>3.6.4</b> Downloading Geospatial Data</a></li>
<li class="chapter" data-level="3.6.5" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#putting-it-together"><i class="fa fa-check"></i><b>3.6.5</b> Putting it together</a></li>
<li class="chapter" data-level="3.6.6" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#other-data-sources-e.g.daymet-modis"><i class="fa fa-check"></i><b>3.6.6</b> Other Data Sources, e.g. Daymet, MODIS</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#usa-npn-coding-lab"><i class="fa fa-check"></i><b>3.7</b> USA-NPN Coding Lab</a></li>
<li class="chapter" data-level="3.8" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#neon-tos-phenology-data-lecture"><i class="fa fa-check"></i><b>3.8</b> NEON TOS Phenology Data Lecture</a></li>
<li class="chapter" data-level="3.9" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#understanding-observation-biases-and-censoring-in-citizen-science-data"><i class="fa fa-check"></i><b>3.9</b> Understanding Observation Biases and Censoring in Citizen Science Data</a><ul>
<li class="chapter" data-level="3.9.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#many-existing-modeling-approaches-fail-in-one-or-both-regards."><i class="fa fa-check"></i><b>3.9.1</b> Many existing modeling approaches fail in one (or both) regards.</a></li>
<li class="chapter" data-level="3.9.2" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#censoring"><i class="fa fa-check"></i><b>3.9.2</b> Censoring</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#so-then-how-can-we-model-censored-data"><i class="fa fa-check"></i><b>3.10</b> So then how can we model censored data?</a></li>
<li class="chapter" data-level="3.11" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#intro-to-usa-npn-culmination-activity"><i class="fa fa-check"></i><b>3.11</b> <strong>Intro to USA-NPN Culmination Activity</strong></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html"><i class="fa fa-check"></i><b>4</b> PhenoCam: Digital Repeat Photography Networks &amp; Methods</a><ul>
<li class="chapter" data-level="4.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#digital-repeat-photography-networks-learning-objectives"><i class="fa fa-check"></i><b>4.1</b> Digital Repeat Photography Networks Learning Objectives</a></li>
<li class="chapter" data-level="4.2" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#the-phenocam-network-mission-design"><i class="fa fa-check"></i><b>4.2</b> The PhenoCam Network Mission &amp; Design</a><ul>
<li class="chapter" data-level="4.2.1" data-path="introduction-to-usa-npn-its-data.html"><a href="introduction-to-usa-npn-its-data.html#relevant-documents-background-information"><i class="fa fa-check"></i><b>4.2.1</b> Relevant documents &amp; background information:</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#phenocams-spatial-design"><i class="fa fa-check"></i><b>4.3</b> PhenoCam’s Spatial design:</a><ul>
<li class="chapter" data-level="4.3.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#phenocam-as-a-near-surface-remote-sensing-technique"><i class="fa fa-check"></i><b>4.3.1</b> PhenoCam as a Near Surface Remote Sensing Technique</a></li>
<li class="chapter" data-level="4.3.2" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#how-phenocams-pull-data"><i class="fa fa-check"></i><b>4.3.2</b> How PhenoCams Pull Data</a></li>
<li class="chapter" data-level="4.3.3" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#leveraging-camera-near-infrared-nir-capabilities"><i class="fa fa-check"></i><b>4.3.3</b> Leveraging camera near-infrared (NIR) capabilities</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#digital-repeat-photography-written-questions"><i class="fa fa-check"></i><b>4.4</b> Digital Repeat Photography Written Questions</a></li>
<li class="chapter" data-level="4.5" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#introduction-to-digital-repeat-photography-methods"><i class="fa fa-check"></i><b>4.5</b> Introduction to Digital Repeat Photography Methods</a></li>
<li class="chapter" data-level="4.6" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#pulling-data-via-the-phenocamapi-package"><i class="fa fa-check"></i><b>4.6</b> Pulling Data via the <em>phenocamapi</em> Package</a></li>
<li class="chapter" data-level="4.7" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#exploring-phenocam-metadata"><i class="fa fa-check"></i><b>4.7</b> Exploring PhenoCam metadata</a><ul>
<li class="chapter" data-level="4.7.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#remove-null-values"><i class="fa fa-check"></i><b>4.7.1</b> Remove null values</a></li>
<li class="chapter" data-level="4.7.2" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#filtering-using-attributes"><i class="fa fa-check"></i><b>4.7.2</b> Filtering using attributes</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#download-midday-images"><i class="fa fa-check"></i><b>4.8</b> Download midday images</a><ul>
<li class="chapter" data-level="4.8.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#download-midday-images-for-a-given-time-range"><i class="fa fa-check"></i><b>4.8.1</b> Download midday images for a given time range</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#detecting-foggy-images-using-the-hazer-r-package"><i class="fa fa-check"></i><b>4.9</b> Detecting Foggy Images using the ‘hazer’ R Package</a></li>
<li class="chapter" data-level="4.10" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#extracting-timeseries-from-images-using-the-xroi-r-package"><i class="fa fa-check"></i><b>4.10</b> Extracting Timeseries from Images using the xROI R Package</a><ul>
<li class="chapter" data-level="4.10.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#xroi-design"><i class="fa fa-check"></i><b>4.10.1</b> xROI Design</a></li>
<li class="chapter" data-level="4.10.2" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#install-xroi"><i class="fa fa-check"></i><b>4.10.2</b> Install xROI</a></li>
<li class="chapter" data-level="4.10.3" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#launch-xroi"><i class="fa fa-check"></i><b>4.10.3</b> Launch xROI</a></li>
<li class="chapter" data-level="4.10.4" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#end-xroi"><i class="fa fa-check"></i><b>4.10.4</b> End xROI</a></li>
<li class="chapter" data-level="4.10.5" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#use-xroi"><i class="fa fa-check"></i><b>4.10.5</b> Use xROI</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#documentation-and-citation"><i class="fa fa-check"></i><b>4.11</b> Documentation and Citation</a><ul>
<li class="chapter" data-level="4.11.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#challenge-use-xroi"><i class="fa fa-check"></i><b>4.11.1</b> Challenge: Use xROI</a></li>
</ul></li>
<li class="chapter" data-level="4.12" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#hands-on-digital-repeat-photography-computational"><i class="fa fa-check"></i><b>4.12</b> Hands on: Digital Repeat Photography Computational</a><ul>
<li class="chapter" data-level="4.12.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#phenocam-time-series"><i class="fa fa-check"></i><b>4.12.1</b> PhenoCam time series</a></li>
<li class="chapter" data-level="4.12.2" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#obtain-rois"><i class="fa fa-check"></i><b>4.12.2</b> Obtain ROIs</a></li>
<li class="chapter" data-level="4.12.3" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#download-time-series"><i class="fa fa-check"></i><b>4.12.3</b> Download time series</a></li>
<li class="chapter" data-level="4.12.4" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#threshold-values"><i class="fa fa-check"></i><b>4.12.4</b> Threshold values</a></li>
<li class="chapter" data-level="4.12.5" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#comparing-phenology-across-vegetation-types"><i class="fa fa-check"></i><b>4.12.5</b> Comparing phenology across vegetation types</a></li>
<li class="chapter" data-level="4.12.6" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#in-class-hands-on-coding-comparing-phenology-of-the-same-plant-function-type-pft-across-climate-space"><i class="fa fa-check"></i><b>4.12.6</b> In Class Hands-on Coding: Comparing phenology of the same plant function type (PFT) across climate space</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#digital-repeat-photography-coding-lab"><i class="fa fa-check"></i><b>4.13</b> Digital Repeat Photography Coding Lab</a><ul>
<li class="chapter" data-level="4.13.1" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#quantifying-haze-and-redness-to-evaluate-california-wildfires"><i class="fa fa-check"></i><b>4.13.1</b> Quantifying haze and redness to evaluate California wildfires</a></li>
</ul></li>
<li class="chapter" data-level="4.14" data-path="phenocam-digital-repeat-photography-networks-methods.html"><a href="phenocam-digital-repeat-photography-networks-methods.html#intro-to-phenocam-culmination-activity"><i class="fa fa-check"></i><b>4.14</b> <strong>Intro to PhenoCam Culmination Activity</strong></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html"><i class="fa fa-check"></i><b>5</b> Flux Measurements &amp; Inter-Operability</a><ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#learning-objectives"><i class="fa fa-check"></i><b>5.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#eddy-co_variance-data-what-does-it-actually-measure"><i class="fa fa-check"></i><b>5.2</b> Eddy Co_variance Data: What does it actually measure?</a><ul>
<li class="chapter" data-level="5.2.1" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#example-eddy-site"><i class="fa fa-check"></i><b>5.2.1</b> Example Eddy Site</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#qaqc-flags"><i class="fa fa-check"></i><b>5.3</b> QA/QC Flags</a></li>
<li class="chapter" data-level="5.4" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#examples-of-other-flux-networks-ameriflux-fluxnet"><i class="fa fa-check"></i><b>5.4</b> Examples of Other Flux Networks: AMERIFLUX &amp; FLUXNET</a></li>
<li class="chapter" data-level="5.5" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#the-power-of-networked-ecology-bridging-to-ameriflux-and-beyond"><i class="fa fa-check"></i><b>5.5</b> The Power of Networked Ecology: Bridging to AMERIFLUX and Beyond</a></li>
<li class="chapter" data-level="5.6" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#hands-on-introduction-to-working-with-neon-eddy-flux-data"><i class="fa fa-check"></i><b>5.6</b> Hands On: Introduction to working with NEON eddy flux data</a><ul>
<li class="chapter" data-level="5.6.1" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#setup"><i class="fa fa-check"></i><b>5.6.1</b> Setup</a></li>
<li class="chapter" data-level="5.6.2" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#data-levels"><i class="fa fa-check"></i><b>5.6.2</b> Data Levels</a></li>
<li class="chapter" data-level="5.6.3" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#extract-level-4-data-fluxes"><i class="fa fa-check"></i><b>5.6.3</b> Extract Level 4 data (Fluxes!)</a></li>
<li class="chapter" data-level="5.6.4" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#time-stamps"><i class="fa fa-check"></i><b>5.6.4</b> Time stamps</a></li>
<li class="chapter" data-level="5.6.5" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#merge-flux-data-with-other-sensor-data"><i class="fa fa-check"></i><b>5.6.5</b> Merge flux data with other sensor data</a></li>
<li class="chapter" data-level="5.6.6" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#vertical-profile-data-level-3"><i class="fa fa-check"></i><b>5.6.6</b> Vertical profile data (Level 3)</a></li>
<li class="chapter" data-level="5.6.7" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#un-interpolated-vertical-profile-data-level-2"><i class="fa fa-check"></i><b>5.6.7</b> Un-interpolated vertical profile data (Level 2)</a></li>
<li class="chapter" data-level="5.6.8" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#calibrated-raw-data-level-1"><i class="fa fa-check"></i><b>5.6.8</b> Calibrated raw data (Level 1)</a></li>
<li class="chapter" data-level="5.6.9" data-path="flux-measurements-inter-operability.html"><a href="flux-measurements-inter-operability.html#convert-neon-flux-data-variables-to-ameriflux-fp-standard"><i class="fa fa-check"></i><b>5.6.9</b> Convert NEON flux data variables to AmeriFlux FP standard</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="pre-course-setup-ecoinformatics-tools.html"><a href="pre-course-setup-ecoinformatics-tools.html#exercises"><i class="fa fa-check"></i><b>5.7</b> Exercises</a><ul>
<li class="chapter" data-level="5.7.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#computational"><i class="fa fa-check"></i><b>5.7.1</b> Computational</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="neon-aop.html"><a href="neon-aop.html"><i class="fa fa-check"></i><b>6</b> NEON AOP</a><ul>
<li class="chapter" data-level="6.1" data-path="neon-aop.html"><a href="neon-aop.html#hyperspectral-remote-sensing"><i class="fa fa-check"></i><b>6.1</b> Hyperspectral Remote Sensing</a><ul>
<li class="chapter" data-level="6.1.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#learning-objectives"><i class="fa fa-check"></i><b>6.1.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="6.1.2" data-path="neon-aop.html"><a href="neon-aop.html#about-hyperspectral-remote-sensing-data"><i class="fa fa-check"></i><b>6.1.2</b> About Hyperspectral Remote Sensing Data</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="neon-aop.html"><a href="neon-aop.html#key-metadata-for-hyperspectral-data"><i class="fa fa-check"></i><b>6.2</b> Key Metadata for Hyperspectral Data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="neon-aop.html"><a href="neon-aop.html#bands-and-wavelengths"><i class="fa fa-check"></i><b>6.2.1</b> Bands and Wavelengths</a></li>
<li class="chapter" data-level="6.2.2" data-path="neon-aop.html"><a href="neon-aop.html#spectral-resolution"><i class="fa fa-check"></i><b>6.2.2</b> Spectral Resolution</a></li>
<li class="chapter" data-level="6.2.3" data-path="neon-aop.html"><a href="neon-aop.html#full-width-half-max-fwhm"><i class="fa fa-check"></i><b>6.2.3</b> Full Width Half Max (FWHM)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="neon-aop.html"><a href="neon-aop.html#intro-to-working-with-hyperspectral-remote-sensing-data-in-hdf5-format"><i class="fa fa-check"></i><b>6.3</b> Intro to Working with Hyperspectral Remote Sensing Data in HDF5 Format</a></li>
<li class="chapter" data-level="6.4" data-path="neon-aop.html"><a href="neon-aop.html#light-detection-and-ranging-lidar-data"><i class="fa fa-check"></i><b>6.4</b> Light Detection And Ranging (LiDAR) Data</a></li>
<li class="chapter" data-level="6.5" data-path="neon-aop.html"><a href="neon-aop.html#calculating-forest-structural-diversity-metrics-from-neon-lidar-data"><i class="fa fa-check"></i><b>6.5</b> Calculating Forest Structural Diversity Metrics from NEON LiDAR Data</a><ul>
<li class="chapter" data-level="6.5.1" data-path="neon-aop.html"><a href="neon-aop.html#learning-objectives-2"><i class="fa fa-check"></i><b>6.5.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="6.5.2" data-path="neon-aop.html"><a href="neon-aop.html#r-libraries-to-install-1"><i class="fa fa-check"></i><b>6.5.2</b> R Libraries to Install:</a></li>
<li class="chapter" data-level="6.5.3" data-path="neon-aop.html"><a href="neon-aop.html#data-to-download-1"><i class="fa fa-check"></i><b>6.5.3</b> Data to Download</a></li>
<li class="chapter" data-level="6.5.4" data-path="neon-aop.html"><a href="neon-aop.html#recommended-skills"><i class="fa fa-check"></i><b>6.5.4</b> Recommended Skills</a></li>
<li class="chapter" data-level="6.5.5" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#additional-resources"><i class="fa fa-check"></i><b>6.5.5</b> Additional Resources</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="neon-aop.html"><a href="neon-aop.html#introduction-to-structural-diversity-metrics"><i class="fa fa-check"></i><b>6.6</b> Introduction to Structural Diversity Metrics</a></li>
<li class="chapter" data-level="6.7" data-path="neon-aop.html"><a href="neon-aop.html#neon-aop-discrete-return-lidar"><i class="fa fa-check"></i><b>6.7</b> NEON AOP Discrete Return LIDAR</a><ul>
<li class="chapter" data-level="6.7.1" data-path="neon-aop.html"><a href="neon-aop.html#loading-the-lidar-products"><i class="fa fa-check"></i><b>6.7.1</b> Loading the LIDAR Products</a></li>
<li class="chapter" data-level="6.7.2" data-path="neon-aop.html"><a href="neon-aop.html#normalizing-tree-height-to-ground"><i class="fa fa-check"></i><b>6.7.2</b> Normalizing Tree Height to Ground</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="neon-aop.html"><a href="neon-aop.html#calculating-structural-diversity-metrics"><i class="fa fa-check"></i><b>6.8</b> Calculating Structural Diversity Metrics</a><ul>
<li class="chapter" data-level="6.8.1" data-path="neon-aop.html"><a href="neon-aop.html#generate-canopy-height-model-chm"><i class="fa fa-check"></i><b>6.8.1</b> GENERATE CANOPY HEIGHT MODEL (CHM)</a></li>
<li class="chapter" data-level="6.8.2" data-path="neon-aop.html"><a href="neon-aop.html#combining-everything-into-one-function"><i class="fa fa-check"></i><b>6.8.2</b> Combining Everything Into One Function</a></li>
<li class="chapter" data-level="6.8.3" data-path="neon-aop.html"><a href="neon-aop.html#comparing-metrics-between-forests"><i class="fa fa-check"></i><b>6.8.3</b> Comparing Metrics Between Forests</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="neon-aop.html"><a href="neon-aop.html#matching-gedi-waveforms-with-neon-aop-lidar-pointclouds"><i class="fa fa-check"></i><b>6.9</b> Matching GEDI waveforms with NEON AOP LiDAR pointclouds</a><ul>
<li class="chapter" data-level="6.9.1" data-path="neon-aop.html"><a href="neon-aop.html#learning-objectives-3"><i class="fa fa-check"></i><b>6.9.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="6.9.2" data-path="neon-aop.html"><a href="neon-aop.html#things-youll-need-to-complete-this-gedi-section"><i class="fa fa-check"></i><b>6.9.2</b> Things You’ll Need To Complete This GEDI Section</a></li>
<li class="chapter" data-level="6.9.3" data-path="neon-aop.html"><a href="neon-aop.html#r-packages-to-install"><i class="fa fa-check"></i><b>6.9.3</b> R Packages to Install</a></li>
<li class="chapter" data-level="6.9.4" data-path="neon-aop.html"><a href="neon-aop.html#example-data-set"><i class="fa fa-check"></i><b>6.9.4</b> Example Data Set</a></li>
<li class="chapter" data-level="6.9.5" data-path="neon-aop.html"><a href="neon-aop.html#getting-started"><i class="fa fa-check"></i><b>6.9.5</b> Getting Started</a></li>
<li class="chapter" data-level="6.9.6" data-path="neon-aop.html"><a href="neon-aop.html#downloading-gedi-data"><i class="fa fa-check"></i><b>6.9.6</b> Downloading GEDI data</a></li>
<li class="chapter" data-level="6.9.7" data-path="neon-aop.html"><a href="neon-aop.html#plot-gedi-footprints-on-chm"><i class="fa fa-check"></i><b>6.9.7</b> Plot GEDI footprints on CHM</a></li>
<li class="chapter" data-level="6.9.8" data-path="neon-aop.html"><a href="neon-aop.html#extract-waveform-for-a-single-shot"><i class="fa fa-check"></i><b>6.9.8</b> Extract Waveform for a single Shot</a></li>
<li class="chapter" data-level="6.9.9" data-path="neon-aop.html"><a href="neon-aop.html#download-and-plot-neon-aop-lidar-pointcloud-data"><i class="fa fa-check"></i><b>6.9.9</b> Download and Plot NEON AOP LiDAR pointcloud data</a></li>
<li class="chapter" data-level="6.9.10" data-path="neon-aop.html"><a href="neon-aop.html#clip-aop-lidar-pointcloud-to-gedi-footprints"><i class="fa fa-check"></i><b>6.9.10</b> Clip AOP LiDAR Pointcloud to GEDI footprints</a></li>
<li class="chapter" data-level="6.9.11" data-path="neon-aop.html"><a href="neon-aop.html#plot-gedi-waveform-with-aop-pointcloud-in-3d-space"><i class="fa fa-check"></i><b>6.9.11</b> Plot GEDI Waveform with AOP Pointcloud in 3D space</a></li>
<li class="chapter" data-level="6.9.12" data-path="neon-aop.html"><a href="neon-aop.html#datum-geoid-and-how-to-best-measure-the-earth"><i class="fa fa-check"></i><b>6.9.12</b> Datum, Geoid, and how to best measure the Earth</a></li>
<li class="chapter" data-level="6.9.13" data-path="neon-aop.html"><a href="neon-aop.html#aligning-the-vertical-datum"><i class="fa fa-check"></i><b>6.9.13</b> Aligning the Vertical Datum</a></li>
<li class="chapter" data-level="6.9.14" data-path="neon-aop.html"><a href="neon-aop.html#geoid12a-height-model"><i class="fa fa-check"></i><b>6.9.14</b> GEOID12A Height Model</a></li>
<li class="chapter" data-level="6.9.15" data-path="neon-aop.html"><a href="neon-aop.html#extract-vertical-offset-for-gedi-shots"><i class="fa fa-check"></i><b>6.9.15</b> Extract vertical offset for GEDI shots</a></li>
<li class="chapter" data-level="6.9.16" data-path="neon-aop.html"><a href="neon-aop.html#plot-vertically-corrected-gedi-waveform-in-3d"><i class="fa fa-check"></i><b>6.9.16</b> Plot vertically corrected GEDI waveform in 3D</a></li>
<li class="chapter" data-level="6.9.17" data-path="neon-aop.html"><a href="neon-aop.html#optional---neon-base-plots"><i class="fa fa-check"></i><b>6.9.17</b> Optional - NEON base plots</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="neon-aop.html"><a href="neon-aop.html#neon-aop-written-questions"><i class="fa fa-check"></i><b>6.10</b> NEON AOP Written Questions:</a></li>
<li class="chapter" data-level="6.11" data-path="neon-aop.html"><a href="neon-aop.html#neon-aop-coding-lab"><i class="fa fa-check"></i><b>6.11</b> NEON AOP Coding Lab</a></li>
<li class="chapter" data-level="6.12" data-path="neon-aop.html"><a href="neon-aop.html#neon-aop-culmination-write-up"><i class="fa fa-check"></i><b>6.12</b> NEON AOP Culmination Write Up</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html"><i class="fa fa-check"></i><b>7</b> NASA’s Earth Observing System (EOS)</a><ul>
<li class="chapter" data-level="7.1" data-path="introduction-to-neon-its-data.html"><a href="introduction-to-neon-its-data.html#learning-objectives"><i class="fa fa-check"></i><b>7.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="7.2" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#nasa-eos-project-mission-design"><i class="fa fa-check"></i><b>7.2</b> NASA EOS Project Mission &amp; Design</a></li>
<li class="chapter" data-level="7.3" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#nasa-eos-earth-data-account"><i class="fa fa-check"></i><b>7.3</b> NASA EOS Earth Data Account:</a></li>
<li class="chapter" data-level="7.4" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#nasa-eos-coding-assignment-1"><i class="fa fa-check"></i><b>7.4</b> <strong>NASA EOS Coding Assignment 1</strong></a></li>
<li class="chapter" data-level="7.5" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#distributed-active-archive-centers"><i class="fa fa-check"></i><b>7.5</b> Distributed Active Archive Centers</a><ul>
<li class="chapter" data-level="7.5.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#lp-daac"><i class="fa fa-check"></i><b>7.5.1</b> LP DAAC</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#the-lpdaac-mission-process-archive-distribute-apply"><i class="fa fa-check"></i><b>7.6</b> The LPDAAC Mission: Process, Archive, Distribute, Apply</a><ul>
<li class="chapter" data-level="7.6.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#how-you-can-use-lp-daacs-data"><i class="fa fa-check"></i><b>7.6.1</b> How you can use LP DAAC’s data</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#appeears"><i class="fa fa-check"></i><b>7.7</b> AppEEARS</a></li>
<li class="chapter" data-level="7.8" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#hands-on-pulling-appeears-data-via-the-api"><i class="fa fa-check"></i><b>7.8</b> Hands on: Pulling AppEEARS Data via the API</a></li>
<li class="chapter" data-level="7.9" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#getting-started-with-the-appeears-api-point-request"><i class="fa fa-check"></i><b>7.9</b> Getting Started with the AppEEARS API (Point Request)</a><ul>
<li class="chapter" data-level="7.9.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#example-submit-a-point-request-for-multiple-neon-sites-to-extract-vegetation-and-land-surface-temperature-data"><i class="fa fa-check"></i><b>7.9.1</b> Example: Submit a point request for multiple NEON sites to extract vegetation and land surface temperature data</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#topics-covered-in-this-section"><i class="fa fa-check"></i><b>7.10</b> Topics Covered in this section:</a><ul>
<li class="chapter" data-level="7.10.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#prerequisites"><i class="fa fa-check"></i><b>7.10.1</b> Prerequisites:</a></li>
<li class="chapter" data-level="7.10.2" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#appeears-information"><i class="fa fa-check"></i><b>7.10.2</b> AppEEARS Information:</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#getting-started-with-the-appeears-api"><i class="fa fa-check"></i><b>7.11</b> Getting Started with the AppEEARS API</a><ul>
<li class="chapter" data-level="7.11.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#load-packages"><i class="fa fa-check"></i><b>7.11.1</b> Load Packages</a></li>
<li class="chapter" data-level="7.11.2" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#set-up-the-output-directory"><i class="fa fa-check"></i><b>7.11.2</b> Set Up the Output Directory</a></li>
<li class="chapter" data-level="7.11.3" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#login-to-earth-data"><i class="fa fa-check"></i><b>7.11.3</b> Login to Earth Data</a></li>
</ul></li>
<li class="chapter" data-level="7.12" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#query-available-products"><i class="fa fa-check"></i><b>7.12</b> Query Available Products</a></li>
<li class="chapter" data-level="7.13" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#search-and-explore-available-products"><i class="fa fa-check"></i><b>7.13</b> Search and Explore Available Products</a></li>
<li class="chapter" data-level="7.14" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#search-and-explore-available-layers"><i class="fa fa-check"></i><b>7.14</b> Search and Explore Available Layers</a></li>
<li class="chapter" data-level="7.15" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#submit-a-point-request"><i class="fa fa-check"></i><b>7.15</b> Submit a Point Request</a><ul>
<li class="chapter" data-level="7.15.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#compile-a-json-object"><i class="fa fa-check"></i><b>7.15.1</b> Compile a JSON Object</a></li>
<li class="chapter" data-level="7.15.2" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#submit-a-task-request"><i class="fa fa-check"></i><b>7.15.2</b> Submit a Task Request</a></li>
<li class="chapter" data-level="7.15.3" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#retrieve-task-status"><i class="fa fa-check"></i><b>7.15.3</b> Retrieve Task Status</a></li>
</ul></li>
<li class="chapter" data-level="7.16" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#download-a-request"><i class="fa fa-check"></i><b>7.16</b> Download a Request</a><ul>
<li class="chapter" data-level="7.16.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#explore-files-in-request-output"><i class="fa fa-check"></i><b>7.16.1</b> Explore Files in Request Output</a></li>
</ul></li>
<li class="chapter" data-level="7.17" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#download-files-in-a-request-automation"><i class="fa fa-check"></i><b>7.17</b> Download Files in a Request (Automation)</a></li>
<li class="chapter" data-level="7.18" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#explore-appeears-quality-service"><i class="fa fa-check"></i><b>7.18</b> Explore AppEEARS Quality Service</a><ul>
<li class="chapter" data-level="7.18.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#list-quality-layers"><i class="fa fa-check"></i><b>7.18.1</b> List Quality Layers</a></li>
<li class="chapter" data-level="7.18.2" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#inspect-quality-values"><i class="fa fa-check"></i><b>7.18.2</b> Inspect Quality Values</a></li>
</ul></li>
<li class="chapter" data-level="7.19" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#decode-quality-values"><i class="fa fa-check"></i><b>7.19</b> Decode Quality Values</a></li>
<li class="chapter" data-level="7.20" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#load-request-output-and-visualize"><i class="fa fa-check"></i><b>7.20</b> Load Request Output and Visualize</a></li>
<li class="chapter" data-level="7.21" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#load-a-csv"><i class="fa fa-check"></i><b>7.21</b> Load a CSV</a></li>
<li class="chapter" data-level="7.22" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#plot-results-linescatter-plots"><i class="fa fa-check"></i><b>7.22</b> Plot Results (Line/Scatter Plots)</a></li>
<li class="chapter" data-level="7.23" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#submit-an-area-request"><i class="fa fa-check"></i><b>7.23</b> Submit an Area Request</a></li>
<li class="chapter" data-level="7.24" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#submit-an-area-request-using-a-neon-site-boundary-as-the-region-of-interest-for-extracting-elevation-vegetation-and-land-surface-temperature-data"><i class="fa fa-check"></i><b>7.24</b> Submit an area request using a NEON site boundary as the region of interest for extracting elevation, vegetation and land surface temperature data</a><ul>
<li class="chapter" data-level="7.24.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#topics-covered-in-this-tutorial"><i class="fa fa-check"></i><b>7.24.1</b> Topics Covered in this Tutorial</a></li>
<li class="chapter" data-level="7.24.2" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#prerequisites-1"><i class="fa fa-check"></i><b>7.24.2</b> Prerequisites:</a></li>
<li class="chapter" data-level="7.24.3" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#procedures"><i class="fa fa-check"></i><b>7.24.3</b> Procedures:</a></li>
<li class="chapter" data-level="7.24.4" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#appeears-information-1"><i class="fa fa-check"></i><b>7.24.4</b> AppEEARS Information:</a></li>
</ul></li>
<li class="chapter" data-level="7.25" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#getting-started-with-an-area-request"><i class="fa fa-check"></i><b>7.25</b> Getting Started with an Area Request</a><ul>
<li class="chapter" data-level="7.25.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#load-packages-for-an-area-request"><i class="fa fa-check"></i><b>7.25.1</b> Load Packages for an Area Request</a></li>
</ul></li>
<li class="chapter" data-level="7.26" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#set-up-the-output-directory-1"><i class="fa fa-check"></i><b>7.26</b> Set Up the Output Directory</a></li>
<li class="chapter" data-level="7.27" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#load-your-earth-data-token"><i class="fa fa-check"></i><b>7.27</b> Load your Earth Data Token</a></li>
<li class="chapter" data-level="7.28" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#query-available-products-1"><i class="fa fa-check"></i><b>7.28</b> Query Available Products</a></li>
<li class="chapter" data-level="7.29" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#search-and-explore-available-products-1"><i class="fa fa-check"></i><b>7.29</b> Search and Explore Available Products</a></li>
<li class="chapter" data-level="7.30" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#search-and-explore-available-layers-1"><i class="fa fa-check"></i><b>7.30</b> Search and Explore Available Layers</a></li>
<li class="chapter" data-level="7.31" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#submit-an-area-request-1"><i class="fa fa-check"></i><b>7.31</b> Submit an Area Request</a><ul>
<li class="chapter" data-level="7.31.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#load-a-shapefile"><i class="fa fa-check"></i><b>7.31.1</b> Load a Shapefile</a></li>
</ul></li>
<li class="chapter" data-level="7.32" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#search-and-explore-available-projections"><i class="fa fa-check"></i><b>7.32</b> Search and Explore Available Projections</a></li>
<li class="chapter" data-level="7.33" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#compile-a-json-object-1"><i class="fa fa-check"></i><b>7.33</b> Compile a JSON Object</a></li>
<li class="chapter" data-level="7.34" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#submit-a-task-request-1"><i class="fa fa-check"></i><b>7.34</b> Submit a Task Request</a></li>
<li class="chapter" data-level="7.35" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#retrieve-task-status-1"><i class="fa fa-check"></i><b>7.35</b> Retrieve Task Status</a></li>
<li class="chapter" data-level="7.36" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#download-a-request-1"><i class="fa fa-check"></i><b>7.36</b> Download a Request</a><ul>
<li class="chapter" data-level="7.36.1" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#explore-files-in-request-output-1"><i class="fa fa-check"></i><b>7.36.1</b> Explore Files in Request Output</a></li>
</ul></li>
<li class="chapter" data-level="7.37" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#download-files-in-a-request-automation-1"><i class="fa fa-check"></i><b>7.37</b> Download Files in a Request (Automation)</a></li>
<li class="chapter" data-level="7.38" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#explore-appeears-quality-service-1"><i class="fa fa-check"></i><b>7.38</b> Explore AppEEARS Quality Service</a></li>
<li class="chapter" data-level="7.39" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#list-quality-layers-1"><i class="fa fa-check"></i><b>7.39</b> List Quality Layers</a></li>
<li class="chapter" data-level="7.40" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#show-quality-values"><i class="fa fa-check"></i><b>7.40</b> Show Quality Values</a></li>
<li class="chapter" data-level="7.41" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#decode-quality-values-1"><i class="fa fa-check"></i><b>7.41</b> Decode Quality Values</a></li>
<li class="chapter" data-level="7.42" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#bonus-load-request-output-and-visualize"><i class="fa fa-check"></i><b>7.42</b> BONUS: Load Request Output and Visualize</a></li>
<li class="chapter" data-level="7.43" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#load-a-geotiff"><i class="fa fa-check"></i><b>7.43</b> Load a GeoTIFF</a></li>
<li class="chapter" data-level="7.44" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#plot-a-geotiff"><i class="fa fa-check"></i><b>7.44</b> Plot a GeoTIFF</a></li>
<li class="chapter" data-level="7.45" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#nasa-eos-coding-lab-2"><i class="fa fa-check"></i><b>7.45</b> NASA EOS Coding Lab #2</a></li>
<li class="chapter" data-level="7.46" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#nasa-eos-written-questions"><i class="fa fa-check"></i><b>7.46</b> NASA EOS Written Questions</a></li>
<li class="chapter" data-level="7.47" data-path="nasas-earth-observing-system-eos.html"><a href="nasas-earth-observing-system-eos.html#nasa-eos-culmination-write-up"><i class="fa fa-check"></i><b>7.47</b> NASA EOS Culmination Write Up</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html"><i class="fa fa-check"></i><b>8</b> USGS National Water Information System (NWIS)</a><ul>
<li class="chapter" data-level="8.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#usgs-mission"><i class="fa fa-check"></i><b>8.1</b> USGS Mission:</a></li>
<li class="chapter" data-level="8.2" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#usgs-water-resources-mission"><i class="fa fa-check"></i><b>8.2</b> USGS Water Resources Mission:</a></li>
<li class="chapter" data-level="8.3" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#types-of-usgs-nwis-data"><i class="fa fa-check"></i><b>8.3</b> Types of USGS NWIS Data</a></li>
<li class="chapter" data-level="8.4" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#usgs-r-packages-collaborative-and-reproducible-data-analysis-using-r"><i class="fa fa-check"></i><b>8.4</b> USGS R Packages: Collaborative and reproducible data analysis using R</a><ul>
<li class="chapter" data-level="8.4.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#suggested-prerequisite-knowledge"><i class="fa fa-check"></i><b>8.4.1</b> Suggested prerequisite knowledge</a></li>
<li class="chapter" data-level="8.4.2" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#course-outline"><i class="fa fa-check"></i><b>8.4.2</b> Course outline</a></li>
<li class="chapter" data-level="8.4.3" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#software-requirements"><i class="fa fa-check"></i><b>8.4.3</b> Software requirements</a></li>
<li class="chapter" data-level="8.4.4" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#lesson-summary"><i class="fa fa-check"></i><b>8.4.4</b> Lesson Summary</a></li>
<li class="chapter" data-level="8.4.5" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#lesson-objectives"><i class="fa fa-check"></i><b>8.4.5</b> Lesson Objectives</a></li>
<li class="chapter" data-level="8.4.6" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#lesson-resources"><i class="fa fa-check"></i><b>8.4.6</b> Lesson Resources</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#introduction-to-usgs-r-packages"><i class="fa fa-check"></i><b>8.5</b> Introduction to USGS R Packages</a></li>
<li class="chapter" data-level="8.6" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#data-available"><i class="fa fa-check"></i><b>8.6</b> Data available</a></li>
<li class="chapter" data-level="8.7" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#common-nwis-function-arguments"><i class="fa fa-check"></i><b>8.7</b> Common NWIS function arguments</a></li>
<li class="chapter" data-level="8.8" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#discovering-nwis-data"><i class="fa fa-check"></i><b>8.8</b> Discovering NWIS data</a><ul>
<li class="chapter" data-level="8.8.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#whatnwisdata"><i class="fa fa-check"></i><b>8.8.1</b> whatNWISdata</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#common-wqp-function-arguments"><i class="fa fa-check"></i><b>8.9</b> Common WQP function arguments</a></li>
<li class="chapter" data-level="8.10" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#discovering-wqp-data"><i class="fa fa-check"></i><b>8.10</b> Discovering WQP data</a><ul>
<li class="chapter" data-level="8.10.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readwqpdata-querysummary"><i class="fa fa-check"></i><b>8.10.1</b> readWQPdata + querySummary</a></li>
<li class="chapter" data-level="8.10.2" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#whatwqpsites"><i class="fa fa-check"></i><b>8.10.2</b> whatWQPsites</a></li>
</ul></li>
<li class="chapter" data-level="8.11" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwis-functions"><i class="fa fa-check"></i><b>8.11</b> readNWIS functions</a><ul>
<li class="chapter" data-level="8.11.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwisdata"><i class="fa fa-check"></i><b>8.11.1</b> readNWISdata</a></li>
<li class="chapter" data-level="8.11.2" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwisdv"><i class="fa fa-check"></i><b>8.11.2</b> readNWISdv</a></li>
<li class="chapter" data-level="8.11.3" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwisgwl"><i class="fa fa-check"></i><b>8.11.3</b> readNWISgwl</a></li>
<li class="chapter" data-level="8.11.4" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwismeas"><i class="fa fa-check"></i><b>8.11.4</b> readNWISmeas</a></li>
<li class="chapter" data-level="8.11.5" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwispcode"><i class="fa fa-check"></i><b>8.11.5</b> readNWISpCode</a></li>
<li class="chapter" data-level="8.11.6" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwispeak"><i class="fa fa-check"></i><b>8.11.6</b> readNWISpeak</a></li>
<li class="chapter" data-level="8.11.7" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwisqw"><i class="fa fa-check"></i><b>8.11.7</b> readNWISqw</a></li>
<li class="chapter" data-level="8.11.8" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwisrating"><i class="fa fa-check"></i><b>8.11.8</b> readNWISrating</a></li>
<li class="chapter" data-level="8.11.9" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwissite"><i class="fa fa-check"></i><b>8.11.9</b> readNWISsite</a></li>
<li class="chapter" data-level="8.11.10" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwisstat"><i class="fa fa-check"></i><b>8.11.10</b> readNWISstat</a></li>
<li class="chapter" data-level="8.11.11" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwisuse"><i class="fa fa-check"></i><b>8.11.11</b> readNWISuse</a></li>
<li class="chapter" data-level="8.11.12" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readnwisuv"><i class="fa fa-check"></i><b>8.11.12</b> readNWISuv</a></li>
</ul></li>
<li class="chapter" data-level="8.12" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#additional-features"><i class="fa fa-check"></i><b>8.12</b> Additional Features</a><ul>
<li class="chapter" data-level="8.12.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#accessing-attributes"><i class="fa fa-check"></i><b>8.12.1</b> Accessing attributes</a></li>
<li class="chapter" data-level="8.12.2" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#using-lists-as-input"><i class="fa fa-check"></i><b>8.12.2</b> Using lists as input</a></li>
<li class="chapter" data-level="8.12.3" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#helper-functions"><i class="fa fa-check"></i><b>8.12.3</b> Helper functions</a></li>
</ul></li>
<li class="chapter" data-level="8.13" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readwqp-functions"><i class="fa fa-check"></i><b>8.13</b> readWQP functions</a><ul>
<li class="chapter" data-level="8.13.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readwqpdata"><i class="fa fa-check"></i><b>8.13.1</b> readWQPdata</a></li>
<li class="chapter" data-level="8.13.2" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#readwqpqw"><i class="fa fa-check"></i><b>8.13.2</b> readWQPqw</a></li>
</ul></li>
<li class="chapter" data-level="8.14" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#attributes-and-metadata"><i class="fa fa-check"></i><b>8.14</b> Attributes and metadata</a></li>
<li class="chapter" data-level="8.15" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#usgs-coding-lab-exercises"><i class="fa fa-check"></i><b>8.15</b> USGS COding Lab Exercises</a></li>
<li class="chapter" data-level="8.16" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#geoknife---introduction"><i class="fa fa-check"></i><b>8.16</b> geoKnife - Introduction</a></li>
<li class="chapter" data-level="8.17" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#lesson-summary-1"><i class="fa fa-check"></i><b>8.17</b> Lesson Summary</a></li>
<li class="chapter" data-level="8.18" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#lesson-objectives-1"><i class="fa fa-check"></i><b>8.18</b> Lesson Objectives</a></li>
<li class="chapter" data-level="8.19" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#lesson-resources-1"><i class="fa fa-check"></i><b>8.19</b> Lesson Resources</a></li>
<li class="chapter" data-level="8.20" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#remote-processing"><i class="fa fa-check"></i><b>8.20</b> Remote processing</a></li>
<li class="chapter" data-level="8.21" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#geoknife-components-fabric-stencil-knife"><i class="fa fa-check"></i><b>8.21</b> geoknife components: fabric, stencil, knife</a></li>
<li class="chapter" data-level="8.22" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#available-webdata"><i class="fa fa-check"></i><b>8.22</b> Available webdata</a><ul>
<li class="chapter" data-level="8.22.1" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#gdp-datasets"><i class="fa fa-check"></i><b>8.22.1</b> GDP datasets</a></li>
<li class="chapter" data-level="8.22.2" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#datasets-not-in-gdp"><i class="fa fa-check"></i><b>8.22.2</b> Datasets not in GDP</a></li>
</ul></li>
<li class="chapter" data-level="8.23" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#available-webgeoms"><i class="fa fa-check"></i><b>8.23</b> Available webgeoms</a></li>
<li class="chapter" data-level="8.24" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#available-webprocesses"><i class="fa fa-check"></i><b>8.24</b> Available webprocesses</a></li>
<li class="chapter" data-level="8.25" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#setting-up-a-geojob"><i class="fa fa-check"></i><b>8.25</b> Setting up a geojob</a></li>
<li class="chapter" data-level="8.26" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#checking-the-geojob-status"><i class="fa fa-check"></i><b>8.26</b> Checking the geojob status</a></li>
<li class="chapter" data-level="8.27" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#getting-geojob-data"><i class="fa fa-check"></i><b>8.27</b> Getting geojob data</a></li>
<li class="chapter" data-level="8.28" data-path="usgs-national-water-information-system-nwis.html"><a href="usgs-national-water-information-system-nwis.html#wait-and-email"><i class="fa fa-check"></i><b>8.28</b> <code>wait</code> and <code>email</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html"><i class="fa fa-check"></i>Frequently Asked Questions:</a><ul>
<li class="chapter" data-level="8.29" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#where-can-i-find-due-dates-for-assignments"><i class="fa fa-check"></i><b>8.29</b> Where can I find due dates for assignments?</a></li>
<li class="chapter" data-level="8.30" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#how-do-i-submit-assignments"><i class="fa fa-check"></i><b>8.30</b> How do I submit assignments?</a></li>
<li class="chapter" data-level="8.31" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#do-i-still-have-to-submit-written-exercises-as-.rmd-and-.pdf"><i class="fa fa-check"></i><b>8.31</b> Do I still have to submit written exercises as .Rmd and .pdf?</a></li>
<li class="chapter" data-level="8.32" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#whats-better-for-code-conciseness-or-readability"><i class="fa fa-check"></i><b>8.32</b> What’s better for code, conciseness or readability?</a></li>
<li class="chapter" data-level="8.33" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#how-find-i-find-resources-to-navigate-the-neon-data-portal"><i class="fa fa-check"></i><b>8.33</b> How find I find resources to navigate the NEON Data Portal?</a></li>
<li class="chapter" data-level="8.34" data-path="frequently-asked-questions.html"><a href="frequently-asked-questions.html#how-can-i-best-prepare-for-class-and-succeed"><i class="fa fa-check"></i><b>8.34</b> How can I best prepare for class and succeed?</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/katharynduffy/katharynduffy.github.io" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Environmental Informatics Using Research Infrastructures and their Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="usgs-national-water-information-system-nwis" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> USGS National Water Information System (NWIS)</h1>
<p><strong>United States Geological Survey’s National Water Information System (NWIS)</strong></p>
<div id="usgs-mission" class="section level2">
<h2><span class="header-section-number">8.1</span> USGS Mission:</h2>
<blockquote>
<p>Changes to the natural world combined with growing human demands put our health and safety, national security, and economy at risk. We are focused on some of the most significant issues society faces, and our science is making a substantial contribution to the well-being of the Nation and the world.</p>
</blockquote>
<p>You can explore <a href="https://www.usgs.gov/science/mission-areas">USGS Missions and programs here.</a></p>
<p><img src="images/usgs_missions.png" width="738" /></p>
</div>
<div id="usgs-water-resources-mission" class="section level2">
<h2><span class="header-section-number">8.2</span> USGS Water Resources Mission:</h2>
<blockquote>
<p>Water information is fundamental to national and local economic well-being, protection of life and property, and effective management of the Nation’s water resources. The USGS works with partners to monitor, assess, conduct targeted research, and deliver information on a wide range of water resources and conditions including streamflow, groundwater, water quality, and water use and availability.</p>
</blockquote>
<p>The United States Geological Survey (USGS) has collected water-resources data at approximately 1.5 million sites in <strong>all 50 States, the District of Columbia, Puerto Rico, the Virgin Islands, Guam, American Samoa and the Commonwealth of the Northern Mariana Islands</strong>.</p>
<p><img src="images/NWIS_sites.png" width="1913" /></p>
<p>A map of collection sites <a href="https://maps.waterdata.usgs.gov/mapper/index.html">can be found here</a></p>
</div>
<div id="types-of-usgs-nwis-data" class="section level2">
<h2><span class="header-section-number">8.3</span> Types of USGS NWIS Data</h2>
<p>The types of data collected are varied, but generally fit into the broad categories of surface water and groundwater.</p>
<p><strong>Surface-water data</strong>, such as gage height (stage) and streamflow (discharge), are collected at major rivers, lakes, and reservoirs.</p>
<p><strong>Groundwater data</strong>, such as water level, are collected at wells and springs.</p>
<p><strong>Water-quality data</strong> are available for both surface water and groundwater. Examples of water-quality data collected are temperature, specific conductance, pH, nutrients, pesticides, and volatile organic compounds.</p>
<p>The <a href="https://waterdata.usgs.gov/nwis">NWIS web site</a> serves current and historical data. Data are retrieved by category of data, such as surface water, groundwater, or water quality, and by geographic area.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Tv3tzbv5OBs" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</div>
<div id="usgs-r-packages-collaborative-and-reproducible-data-analysis-using-r" class="section level2">
<h2><span class="header-section-number">8.4</span> USGS R Packages: Collaborative and reproducible data analysis using R</h2>
<blockquote>
<p>Contributors: Jordan Read, Lindsay Carr
Adapted from USGS <a href="https://owi.usgs.gov/R/training-curriculum/usgs-packages/GettingStartedUSGS/">‘Getting Started with USGS R Packages’ course materials</a></p>
</blockquote>
<p>Recently, the USGS has built a suite of software packages and tutorials for R users to to interact with their data and streamline workflows. Here we have adapted course materials from thier USGS R packages course materials written and developed by Lindsay R. Carr.</p>
<p>The common workflow for completing the data processing pipeline is subject to human error at every step: accessing data, analyzing data, and producing final figures. Multi-site analyses are especially error-prone because the same workflow needs to be repeated many times. This course teaches a modular approach to the common data analysis workflow by building on basic R data analysis skills and leveraging existing USGS R packages that can create advanced, reproducible workflows, such as for accessing gridded climate data, analyzing high frequency water observations, and for taking full advantage of the USGS ScienceBase repository. The USGS packages covered in this course span a variety of applications: accessing web data, accessing personally stored data, and releasing data for publication.</p>
<p>The modular workflows taught in this section will prepare researchers to create automated, robust data processing workflows through more efficient code development. Following the course, students will be capable of integrating these packages into their own scientific workflows.</p>
<div id="suggested-prerequisite-knowledge" class="section level3">
<h3><span class="header-section-number">8.4.1</span> Suggested prerequisite knowledge</h3>
<p>This course assumes a moderate to advanced knowledge of the statistical programming language R. If you’re interested in using USGS packages for data analysis but have no R experience, please visit the <a href="/intro-curriculum">Introduction to R curriculum</a> available at this site.</p>
<ol style="list-style-type: decimal">
<li>Experience using R to import, view, and summarize data</li>
<li>Recommended: experience creating simple plots in R</li>
<li>Recommended: familiarity with RStudio</li>
</ol>
</div>
<div id="course-outline" class="section level3">
<h3><span class="header-section-number">8.4.2</span> Course outline</h3>
<pre><code>## Warning: package &#39;htmlTable&#39; was built under R version 3.6.2</code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<td colspan="3" style="text-align: left;">
<caption>
Summary of Modules
</caption>
</td>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Module
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Description
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Duration
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
dataRetrieval
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Accessing time series data.
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
2 hours
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
geoknife
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Accessing gridded data.
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
1 hour
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; border-bottom: 2px solid grey; text-align: left;">
Application
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; border-bottom: 2px solid grey; text-align: left;">
Use the packages introduced in previous modules to create and use a robust modular workflow.
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; border-bottom: 2px solid grey; text-align: left;">
1.5 hour
</td>
</tr>
</tbody>
</table>
</div>
<div id="software-requirements" class="section level3">
<h3><span class="header-section-number">8.4.3</span> Software requirements</h3>
<p>See the <a href="/installr">R installation instructions page</a> for how to install/upgrade R and RStudio, add GRAN to your settings, and install some basic packages. Then, execute these lines so that you have the most up-to-date version of the packages used in this course.</p>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb668-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&#39;dataRetrieval&#39;</span>, <span class="st">&#39;geoknife&#39;</span>))</a></code></pre></div>
</div>
<div id="lesson-summary" class="section level3">
<h3><span class="header-section-number">8.4.4</span> Lesson Summary</h3>
<p>This lesson will focus on finding and retrieving hydrologic time series data using the USGS R package, <code>dataRetrieval</code>. The package was created to make querying and downloading hydrologic data from the web easier, less error-prone, and reproducible. The package allows users to easily access data stored in the USGS National Water Information System (NWIS) and the multi-agency database, Water Quality Portal (WQP). NWIS only contains data collected by or for the USGS. Conversely, WQP is a database that aggregates water quality data from multiple agencies, including USGS, Environmental Protection Agency (EPA), US Department of Agriculture (USDA), and many state, tribal, and local agencies.</p>
<p><code>dataRetrieval</code> functions take user-defined arguments and construct web service calls. The web service returns the data as XML (a standard data structure), and <code>dataRetrieval</code> takes care of parsing that into a useable R data.frame, complete with metadata. When web services change, <code>dataRetrieval</code> users aren’t affected because the package maintainers will update the functions to handle these modifications. This is what makes <code>dataRetrieval</code> so user-friendly.</p>
<p>Neither NWIS nor WQP are static databases. Users should be aware that data is constantly being added, so a query one week might return differing amounts of data from the next. For more information about NWIS, please visit <a href="waterdata.usgs.gov/nwis">waterdata.usgs.gov/nwis</a>. For more information about WQP, visit their site www.waterqualitydata.us or read about WQP for aquatic research applications in the publication, <em><a href="http://onlinelibrary.wiley.com/doi/10.1002/2016WR019993/abstract">Water quality data for national-scale aquatic research: The Water Quality Portal</a></em>.</p>
</div>
<div id="lesson-objectives" class="section level3">
<h3><span class="header-section-number">8.4.5</span> Lesson Objectives</h3>
<p>Learn about data available in the National Water Information System (NWIS) and Water Quality Portal (WQP). Discover how to construct your retrieval calls to get exactly what you are looking for, and access information stored as metadata in the R object.</p>
<p>By the end of this lesson, the learner will be able to:</p>
<ol style="list-style-type: decimal">
<li>Investigate what data are available in National Water Information System (NWIS) and Water Quality Portal (WQP) through package functions.</li>
<li>Construct function calls to pull a variety of NWIS and WQP data.</li>
<li>Access metadata information from retrieval call output.</li>
</ol>
</div>
<div id="lesson-resources" class="section level3">
<h3><span class="header-section-number">8.4.6</span> Lesson Resources</h3>
<ul>
<li>USGS publication: <a href="https://pubs.usgs.gov/tm/04/a10/pdf/tm4A10_appendix_1.pdf">The dataRetrieval R package</a></li>
<li>Source code: <a href="https://github.com/USGS-R/dataRetrieval">dataRetrieval on GitHub</a></li>
<li>Report a bug or suggest a feature: <a href="https://github.com/USGS-R/dataRetrieval/issues">dataRetrieval issues on GitHub</a></li>
<li>USGS Presentation: <a href="https://owi.usgs.gov/R/dataRetrieval.html#1">dataRetrieval Tutorial</a></li>
</ul>
</div>
</div>
<div id="introduction-to-usgs-r-packages" class="section level2">
<h2><span class="header-section-number">8.5</span> Introduction to USGS R Packages</h2>
<p>Before continuing with this lesson, you should make sure that the <code>dataRetrieval</code> package is installed and loaded. If you haven’t recently updated, you could reinstall the package by running <code>install.packages('dataRetrieval')</code> or go to the “Update” button in the “Packages” tab in RStudio.</p>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb669-1" data-line-number="1"><span class="co"># load the dataRetrival package</span></a>
<a class="sourceLine" id="cb669-2" data-line-number="2"><span class="kw">library</span>(dataRetrieval)</a></code></pre></div>
<p>There is an overwhelming amount of data and information stored in the National Water Information System (NWIS). This lesson will attempt to give an overview of what you can access. If you need more detail on a subject or have a question that is not answered here, please visit the <a href="https://help.waterdata.usgs.gov/">NWIS help system</a>.</p>
</div>
<div id="data-available" class="section level2">
<h2><span class="header-section-number">8.6</span> Data available</h2>
<p><strong>Data types:</strong> NWIS and WQP store a lot of water information. NWIS contains streamflow, peak flow, rating curves, groundwater, and water quality data. As can be assumed from the name, WQP only contains water quality data.</p>
<p><strong>Time series types:</strong> the databases store water data at various reporting frequencies, and have different language to describe these. There are 3 main types: unit value, daily value, and discrete. WQP only contains discrete data.</p>
<ol style="list-style-type: decimal">
<li><em>instantaneous value</em> (sometimes called <em>unit value</em>) data is reported at the frequency in which it was collected, and includes real-time data. It is generally available from 2007-present.</li>
<li><em>daily value</em> data aggregated to a daily statistic (e.g. mean daily, minimum daily, or maximum daily).
This is available for streamflow, groundwater levels, and water quality sensors.</li>
<li><em>discrete</em> data collected at a specific point in time, and is not a continuous time series. This includes most water quality data, groundwater levels, rating curves, surface water measurements, and peak flow.</li>
</ol>
<p><strong>Metadata types:</strong> both NWIS and WQP contain metadata describing the site at which the data was collected (e.g. latitude, longitude, elevation, etc), and include information about the type of data being used (e.g. units, dissolved or not, collection method, etc).</p>
</div>
<div id="common-nwis-function-arguments" class="section level2">
<h2><span class="header-section-number">8.7</span> Common NWIS function arguments</h2>
<p><em><em><code>siteNumber</code></em></em> All NWIS data are stored based on the geographic location of the equipment used to collected the data. These are known as streamgages and they take continuous timeseries measurements for a number of water quality and quantity parameters. Streamgages are identified based on an 8-digit (surface water) or 15-digit (groundwater) code. In <code>dataRetrieval</code>, we refer to this as the <code>siteNumber</code>. Any time you use a <code>siteNumber</code> in <code>dataRetrieval</code>, make sure it is a string and not numeric. Oftentimes, NWIS sites have leading zeroes which are dropped when treated as a numeric value.</p>
<p><em><em><code>parameterCd</code></em></em> NWIS uses 5-digit codes to refer to specific data of interest called parameter codes, <code>parameterCd</code> in <code>dataRetrieval</code>. For example, you use the code ‘00060’ to specify discharge data. If you’d like to explore the full list, see the <a href="https://help.waterdata.usgs.gov/code/parameter_cd_query?fmt=rdb&amp;inline=true&amp;group_cd=%">Parameter Groups Table</a>. The package also has a built in parameter code table that you can use by executing <code>parameterCdFile</code> in your console.</p>
<p><em><em><code>service</code></em></em> Identifier referring to the time series frequencies explained above, or the type of data that should be returned. For more information, visit the <a href="https://waterservices.usgs.gov/rest/Site-Service.html#outputDataTypeCd">Water Services website</a>.</p>
<ul>
<li>instaneous = “iv”</li>
<li>daily values = “dv”</li>
<li>groundwater levels = “gwlevels”</li>
<li>water quality = “qw”</li>
<li>statistics = “stat”</li>
<li>site = “site”</li>
</ul>
<p><em><em><code>startDate</code></em></em> and <em><em><code>endDate</code></em></em> Strings in the format “YYYY-MM-DDTHH:SS:MM”, either as a date or character class. The start and end date-times are inclusive.</p>
<p><em><em><code>stateCd</code></em></em> Two character abbreviation for a US state or territory. Execute <code>state.abb</code> in the console to get a vector of US state abbreviations. Territories include:</p>
<ul>
<li>AS (American Samoa)</li>
<li>GU (Guam)</li>
<li>MP (Northern Mariana Islands)</li>
<li>PR (Puerto Rico)</li>
<li>VI (U.S. Virgin Islands)</li>
</ul>
<p>For more query parameters, visit <a href="https://waterservices.usgs.gov/rest/Site-Service.html#Service">NWIS service documentation</a>.</p>
</div>
<div id="discovering-nwis-data" class="section level2">
<h2><span class="header-section-number">8.8</span> Discovering NWIS data</h2>
<p>In some cases, users might have specific sites and data that they are pulling with <code>dataRetrieval</code> but what if you wanted to know what data exists in the database before trying to download it? You can use the function <code>whatNWISdata</code>, described below. Another option is to download the data using <code>readNWISdata</code>, and see the first and last available dates of that data with the arguments <code>seriesCatalogOutput=TRUE</code> and <code>service=&quot;site&quot;</code>. Downloading data will be covered in the next section, <a href="/usgs-packages/dataRetrieval-readNWIS">readNWIS</a>.</p>
<div id="whatnwisdata" class="section level3">
<h3><span class="header-section-number">8.8.1</span> whatNWISdata</h3>
<p><code>whatNWISdata</code> will return a data.frame specifying the types of data available for a specified major filter that fits your querying criteria. You can add queries by the data service, USGS parameter code, or statistics code. You need at least one “major filter” in order for the query to work. “Major filters” include <code>siteNumber</code>, <code>stateCd</code>, <code>huc</code>, <code>bBox</code>, or <code>countyCd</code>.</p>
<p>In this example, let’s find South Carolina stream temperature data. We specify the state, South Carolina, using the <code>stateCd</code> argument and South Carolina’s two letter abbreviation, SC.</p>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb670-1" data-line-number="1">data_sc &lt;-<span class="st"> </span><span class="kw">whatNWISdata</span>(<span class="dt">stateCd=</span><span class="st">&quot;SC&quot;</span>)</a>
<a class="sourceLine" id="cb670-2" data-line-number="2"><span class="kw">nrow</span>(data_sc)</a></code></pre></div>
<pre><code>## [1] 186041</code></pre>
<p>Let’s look at the dataframe returned from <code>whatNWISdata</code>:</p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb672-1" data-line-number="1"><span class="kw">head</span>(data_sc)</a></code></pre></div>
<pre><code>##   agency_cd  site_no                station_nm site_tp_cd dec_lat_va
## 1      USGS 02110400 BUCK CREEK NEAR LONGS, SC         ST    33.9535
## 2      USGS 02110400 BUCK CREEK NEAR LONGS, SC         ST    33.9535
## 3      USGS 02110400 BUCK CREEK NEAR LONGS, SC         ST    33.9535
## 4      USGS 02110400 BUCK CREEK NEAR LONGS, SC         ST    33.9535
## 5      USGS 02110400 BUCK CREEK NEAR LONGS, SC         ST    33.9535
## 6      USGS 02110400 BUCK CREEK NEAR LONGS, SC         ST    33.9535
##   dec_long_va coord_acy_cd dec_coord_datum_cd alt_va alt_acy_va alt_datum_cd
## 1   -78.71974            S              NAD83   5.30        .01       NAVD88
## 2   -78.71974            S              NAD83   5.30        .01       NAVD88
## 3   -78.71974            S              NAD83   5.30        .01       NAVD88
## 4   -78.71974            S              NAD83   5.30        .01       NAVD88
## 5   -78.71974            S              NAD83   5.30        .01       NAVD88
## 6   -78.71974            S              NAD83   5.30        .01       NAVD88
##     huc_cd data_type_cd parm_cd stat_cd  ts_id loc_web_ds medium_grp_cd
## 1 03040206           ad    &lt;NA&gt;    &lt;NA&gt;      0       &lt;NA&gt;           wat
## 2 03040206           dv   00010   00001 124327       &lt;NA&gt;           wat
## 3 03040206           dv   00010   00002 124328       &lt;NA&gt;           wat
## 4 03040206           dv   00010   00003 124329       &lt;NA&gt;           wat
## 5 03040206           dv   00045   00006 124351       &lt;NA&gt;           wat
## 6 03040206           dv   00060   00001 124348       &lt;NA&gt;           wat
##   parm_grp_cd  srs_id access_cd begin_date   end_date count_nu
## 1        &lt;NA&gt;       0         0 2006-01-01 2019-01-01       14
## 2        &lt;NA&gt; 1645597         0 2005-10-01 2020-10-12     5395
## 3        &lt;NA&gt; 1645597         0 2005-10-01 2020-10-12     5395
## 4        &lt;NA&gt; 1645597         0 2005-10-01 2020-10-12     5395
## 5        &lt;NA&gt; 1644459         0 2006-01-06 2020-10-12     5203
## 6        &lt;NA&gt; 1645423         0 2005-11-17 2019-08-17     4394</code></pre>
<p>The data returned from this query can give you information about the data available for each site including, date of first and last record (<code>begin_date</code>, <code>end_date</code>), number of records (<code>count_nu</code>), site altitude (<code>alt_va</code>), corresponding hydrologic unit code (<code>huc_cd</code>), and parameter units (<code>parameter_units</code>). These columns allow even more specification of data requirements before actually downloading the data. This function returns one row per unique combination of site number, dates, parameter, etc. In order to just get the sites, use <code>unique</code>:</p>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb674-1" data-line-number="1">sites_sc &lt;-<span class="st"> </span><span class="kw">unique</span>(data_sc<span class="op">$</span>site_no)</a>
<a class="sourceLine" id="cb674-2" data-line-number="2"><span class="kw">length</span>(sites_sc)</a></code></pre></div>
<pre><code>## [1] 10127</code></pre>
<p>To be more specific, let’s say we only want stream sites. This requires the <code>siteType</code> argument and the abbreviation “ST” for stream. See other siteTypes <a href="https://help.waterdata.usgs.gov/code/site_tp_query?fmt=html">here</a>. We also only want to use sites that have temperature data (USGS parameter code is 00010). Use the argument <code>parameterCd</code> and enter the code as a character string, otherwise leading zeroes will be dropped. Recall that you can see a table of all parameter codes by executing <code>parameterCdFile</code> in your console.</p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb676-1" data-line-number="1">data_sc_stream_temp &lt;-<span class="st"> </span><span class="kw">whatNWISdata</span>(<span class="dt">stateCd=</span><span class="st">&quot;SC&quot;</span>, <span class="dt">siteType=</span><span class="st">&quot;ST&quot;</span>, <span class="dt">parameterCd=</span><span class="st">&quot;00010&quot;</span>)</a>
<a class="sourceLine" id="cb676-2" data-line-number="2"><span class="kw">nrow</span>(data_sc_stream_temp)</a></code></pre></div>
<pre><code>## [1] 652</code></pre>
<p>We are now down to just 652 rows of data, much less than our original 186,041 rows. Downloading NWIS data will be covered in the next section, <a href="/usgs-packages/dataRetrieval-readNWIS">readNWIS</a>.</p>
<p>The <code>whatNWISdata</code> function can also be very useful for making quick maps with site locations, see the columns <code>dec_lat_va</code> and <code>dec_long_va</code> (decimal latitude and longitude value). For instance,</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb678-1" data-line-number="1"><span class="co"># SC stream temperature sites</span></a>
<a class="sourceLine" id="cb678-2" data-line-number="2"><span class="kw">library</span>(maps)</a>
<a class="sourceLine" id="cb678-3" data-line-number="3"><span class="kw">map</span>(<span class="st">&#39;state&#39;</span>, <span class="dt">regions=</span><span class="st">&#39;south carolina&#39;</span>)</a>
<a class="sourceLine" id="cb678-4" data-line-number="4"><span class="kw">title</span>(<span class="dt">main=</span><span class="st">&quot;South Carolina Stream Temp Sites&quot;</span>)</a>
<a class="sourceLine" id="cb678-5" data-line-number="5"><span class="kw">points</span>(<span class="dt">x=</span>data_sc_stream_temp<span class="op">$</span>dec_long_va, </a>
<a class="sourceLine" id="cb678-6" data-line-number="6">       <span class="dt">y=</span>data_sc_stream_temp<span class="op">$</span>dec_lat_va)</a></code></pre></div>
<div class="figure">
<img src="08-USGS_files/figure-html/sc_streamtemp_data_map-1.png" alt="Geographic locations of NWIS South Carolina stream sites with temperature data" width="672" />
<p class="caption">
(#fig:sc_streamtemp_data_map)Geographic locations of NWIS South Carolina stream sites with temperature data
</p>
</div>
<p>Continuing with the South Carolina temperature data example, let’s look for the mean daily stream temperature.</p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb679-1" data-line-number="1"><span class="co"># Average daily SC stream temperature data</span></a>
<a class="sourceLine" id="cb679-2" data-line-number="2">data_sc_stream_temp_avg &lt;-<span class="st"> </span><span class="kw">whatNWISdata</span>(</a>
<a class="sourceLine" id="cb679-3" data-line-number="3">  <span class="dt">stateCd=</span><span class="st">&quot;SC&quot;</span>, </a>
<a class="sourceLine" id="cb679-4" data-line-number="4">  <span class="dt">siteType=</span><span class="st">&quot;ST&quot;</span>,</a>
<a class="sourceLine" id="cb679-5" data-line-number="5">  <span class="dt">parameterCd=</span><span class="st">&quot;00010&quot;</span>,</a>
<a class="sourceLine" id="cb679-6" data-line-number="6">  <span class="dt">service=</span><span class="st">&quot;dv&quot;</span>,</a>
<a class="sourceLine" id="cb679-7" data-line-number="7">  <span class="dt">statCd=</span><span class="st">&quot;00003&quot;</span>)</a>
<a class="sourceLine" id="cb679-8" data-line-number="8"><span class="kw">nrow</span>(data_sc_stream_temp_avg)</a></code></pre></div>
<pre><code>## [1] 95</code></pre>
<p>Let’s apply an additional filter to these data using the <code>filter</code> function from <code>dplyr</code>. Imagine that the trend analysis you are conducting requires a minimum of 300 records and the most recent data needs to be no earlier than 1975.</p>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb681-1" data-line-number="1"><span class="co"># Useable average daily SC stream temperature data</span></a>
<a class="sourceLine" id="cb681-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb681-3" data-line-number="3">data_sc_stream_temp_avg_applicable &lt;-<span class="st"> </span>data_sc_stream_temp_avg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb681-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(count_nu <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span>, end_date <span class="op">&gt;=</span><span class="st"> &quot;1975-01-01&quot;</span>)</a>
<a class="sourceLine" id="cb681-5" data-line-number="5"><span class="kw">nrow</span>(data_sc_stream_temp_avg_applicable)</a></code></pre></div>
<pre><code>## [1] 91</code></pre>
<p>This means you would have 91 sites to work with for your study.</p>
</div>
</div>
<div id="common-wqp-function-arguments" class="section level2">
<h2><span class="header-section-number">8.9</span> Common WQP function arguments</h2>
<p><em><em><code>countrycode</code></em></em>, <em><em><code>statecode</code></em></em>, and <em><em><code>countycode</code></em></em> These geopolitical filters can be specified by a two letter abbreviation, state name, or Federal Information Processing Standard (FIPS) code. If you are using the FIPS code for a state or county, it must be preceded by the FIPS code of the larger geopolitical filter. For example, the FIPS code for the United States is <code>US</code>, and the FIPS code for South Carolina is <code>45</code>. When querying with the statecode, you can enter <code>statecode=&quot;US:45&quot;</code>. The same rule extends to county FIPS; for example, you can use <code>countycode=&quot;45:001&quot;</code> to query Abbeville County, South Carolina. You can find all state and county codes and abbreviations by executing <code>stateCd</code> or <code>countyCd</code> in your console.</p>
<p><em><em><code>siteType</code></em></em> Specify the hydrologic location the sample was taken, e.g. streams, lakes, groundwater sources. These should be listed as a string. Available types can be found <a href="https://www.waterqualitydata.us/Codes/Sitetype?mimeType=xml">here</a>.</p>
<p><em><em><code>organization</code></em></em> The ID of the reporting organization. All USGS science centers are written “USGS-” and then the two-letter state abbrevation. For example, the Wisconsin Water Science Center would be written “USGS-WI”. For all available organization IDs, please see <a href="https://www.waterqualitydata.us/Codes/Organization?mimeType=xml">this list of org ids</a>. The id is listed in the “value” field, but they are accompanied by the organization name in the “desc” (description) field.
<em><em><code>siteid</code></em></em> This is the unique identification number associated with a data collection station. Site IDs for the same location may differ depending on the reporting organization. The site ID string is written as the agency code then the site number separated by a hyphen. For example, the USGS site 01594440 would be written as “USGS-01594440”.</p>
<p><em><em><code>characteristicName</code></em></em> and <em><em><code>characteristicType</code></em></em> Unlike NWIS, WQP does not have codes for each parameter. Instead, you need to search based on the name of the water quality constituent (referred to as <code>characteristicName</code> in <code>dataRetrieval</code>) or a group of parameters (<code>characteristicType</code> in <code>dataRetrieval</code>). For example, “Nitrate” is a <code>characteristicName</code> and “Nutrient” is the <code>characteristicType</code> that it fits into. For a complete list of water quality types and names, see <a href="https://www.waterqualitydata.us/Codes/Characteristictype?mimeType=xml">characteristicType list</a> and <a href="https://www.waterqualitydata.us/Codes/Characteristicname?mimeType=xml">characteristicName list</a>.</p>
<p><em><em><code>startDate</code></em></em> and <em><em><code>endDate</code></em></em> Arguments specifying the beginning and ending of the period of record you are interested in. For the <code>dataRetrieval</code> functions, these can be a date or character class in the form YYYY-MM-DD. For example, <code>startDate = as.Date(&quot;2010-01-01&quot;)</code> or <code>startDate = &quot;2010-01-01&quot;</code> could both be your input arguments.</p>
</div>
<div id="discovering-wqp-data" class="section level2">
<h2><span class="header-section-number">8.10</span> Discovering WQP data</h2>
<p>WQP has millions of records, and if you aren’t careful, your query could take hours because of the amount of data that met your criteria. To avoid this, you can query just for the number of records and number of sites that meet your criteria using the argument <code>querySummary=TRUE</code> in the function, <code>readWQPdata</code>. See the <a href="/usgs-packages/readWQP">lesson on downloading WQP data</a> to learn more about getting data. You can also use <code>whatWQPsites</code> to get the site information that matches your criteria.</p>
<p>Let’s follow a similar pattern to NWIS data discovery sections and explore available stream temperature data in South Carolina.</p>
<div id="readwqpdata-querysummary" class="section level3">
<h3><span class="header-section-number">8.10.1</span> readWQPdata + querySummary</h3>
<p><code>readWQPdata</code> is the function used to actually download WQP data. In this application, we are just querying for a count of sites and results that match our criteria. Since WQP expect state and county codes as their FIPS code, you will need to use the string “US:45” for South Carolina.</p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb683-1" data-line-number="1">wqpcounts_sc &lt;-<span class="st"> </span><span class="kw">readWQPdata</span>(<span class="dt">statecode=</span><span class="st">&quot;US:45&quot;</span>, <span class="dt">querySummary =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb683-2" data-line-number="2"><span class="kw">names</span>(wqpcounts_sc)</a></code></pre></div>
<pre><code>##  [1] &quot;content-type&quot;              &quot;content-length&quot;           
##  [3] &quot;server&quot;                    &quot;date&quot;                     
##  [5] &quot;content-disposition&quot;       &quot;total-site-count&quot;         
##  [7] &quot;nwis-site-count&quot;           &quot;storet-site-count&quot;        
##  [9] &quot;total-activity-count&quot;      &quot;nwis-activity-count&quot;      
## [11] &quot;storet-activity-count&quot;     &quot;total-result-count&quot;       
## [13] &quot;nwis-result-count&quot;         &quot;storet-result-count&quot;      
## [15] &quot;x-frame-options&quot;           &quot;x-content-type-options&quot;   
## [17] &quot;x-xss-protection&quot;          &quot;strict-transport-security&quot;
## [19] &quot;x-cache&quot;                   &quot;via&quot;                      
## [21] &quot;x-amz-cf-pop&quot;              &quot;x-amz-cf-id&quot;</code></pre>
<p>This returns a list with 22 different items, including total number of sites, breakdown of the number of sites by source (BioData, NWIS, STORET), total number of records, and breakdown of records count by source. Let’s just look at total number of sites and total number of records.</p>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb685-1" data-line-number="1">wqpcounts_sc[[<span class="st">&#39;total-site-count&#39;</span>]]</a></code></pre></div>
<pre><code>## [1] 7032</code></pre>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb687-1" data-line-number="1">wqpcounts_sc[[<span class="st">&#39;total-result-count&#39;</span>]]</a></code></pre></div>
<pre><code>## [1] 3613490</code></pre>
<p>This doesn’t provide any information about the sites, just the total number. I know that with 3,613,490 results, I will want to add more criteria before trying to download. Let’s continue to add query parameters before moving to <code>whatWQPsites</code>.</p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb689-1" data-line-number="1"><span class="co"># specify that you only want data from streams</span></a>
<a class="sourceLine" id="cb689-2" data-line-number="2">wqpcounts_sc_stream &lt;-<span class="st"> </span><span class="kw">readWQPdata</span>(<span class="dt">statecode=</span><span class="st">&quot;US:45&quot;</span>, <span class="dt">siteType=</span><span class="st">&quot;Stream&quot;</span>,</a>
<a class="sourceLine" id="cb689-3" data-line-number="3">                                  <span class="dt">querySummary =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb689-4" data-line-number="4">wqpcounts_sc_stream[[<span class="st">&#39;total-site-count&#39;</span>]]</a></code></pre></div>
<pre><code>## [1] 1994</code></pre>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb691-1" data-line-number="1">wqpcounts_sc_stream[[<span class="st">&#39;total-result-count&#39;</span>]]</a></code></pre></div>
<pre><code>## [1] 1851383</code></pre>
<p>1,851,383 results are still a lot to download. Let’s add more levels of criteria:</p>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb693-1" data-line-number="1"><span class="co"># specify that you want water temperature data and it should be from 1975 or later</span></a>
<a class="sourceLine" id="cb693-2" data-line-number="2">wqpcounts_sc_stream_temp &lt;-<span class="st"> </span><span class="kw">readWQPdata</span>(<span class="dt">statecode=</span><span class="st">&quot;US:45&quot;</span>, <span class="dt">siteType=</span><span class="st">&quot;Stream&quot;</span>,</a>
<a class="sourceLine" id="cb693-3" data-line-number="3">                                       <span class="dt">characteristicName=</span><span class="st">&quot;Temperature, water&quot;</span>,</a>
<a class="sourceLine" id="cb693-4" data-line-number="4">                                       <span class="dt">startDate=</span><span class="st">&quot;1975-01-01&quot;</span>,</a>
<a class="sourceLine" id="cb693-5" data-line-number="5">                                       <span class="dt">querySummary =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb693-6" data-line-number="6">wqpcounts_sc_stream_temp[[<span class="st">&#39;total-site-count&#39;</span>]]</a></code></pre></div>
<pre><code>## [1] 1462</code></pre>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb695-1" data-line-number="1">wqpcounts_sc_stream_temp[[<span class="st">&#39;total-result-count&#39;</span>]]</a></code></pre></div>
<pre><code>## [1] 140404</code></pre>
<p>140,404 is little more manageble. We can also easily compare avilable stream temperature and lake temperature data.</p>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb697-1" data-line-number="1">wqpcounts_sc_lake_temp &lt;-<span class="st"> </span><span class="kw">readWQPdata</span>(<span class="dt">statecode=</span><span class="st">&quot;US:45&quot;</span>, </a>
<a class="sourceLine" id="cb697-2" data-line-number="2">                                      <span class="dt">siteType=</span><span class="st">&quot;Lake, Reservoir, Impoundment&quot;</span>,</a>
<a class="sourceLine" id="cb697-3" data-line-number="3">                                      <span class="dt">characteristicName=</span><span class="st">&quot;Temperature, water&quot;</span>,</a>
<a class="sourceLine" id="cb697-4" data-line-number="4">                                      <span class="dt">startDate=</span><span class="st">&quot;1975-01-01&quot;</span>,</a>
<a class="sourceLine" id="cb697-5" data-line-number="5">                                      <span class="dt">querySummary =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb697-6" data-line-number="6"><span class="co"># comparing site counts</span></a>
<a class="sourceLine" id="cb697-7" data-line-number="7">wqpcounts_sc_stream_temp[[<span class="st">&#39;total-site-count&#39;</span>]]</a></code></pre></div>
<pre><code>## [1] 1462</code></pre>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb699-1" data-line-number="1">wqpcounts_sc_lake_temp[[<span class="st">&#39;total-site-count&#39;</span>]]</a></code></pre></div>
<pre><code>## [1] 626</code></pre>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb701-1" data-line-number="1"><span class="co"># comparing result counts</span></a>
<a class="sourceLine" id="cb701-2" data-line-number="2">wqpcounts_sc_stream_temp[[<span class="st">&#39;total-result-count&#39;</span>]]</a></code></pre></div>
<pre><code>## [1] 140404</code></pre>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb703-1" data-line-number="1">wqpcounts_sc_lake_temp[[<span class="st">&#39;total-result-count&#39;</span>]]</a></code></pre></div>
<pre><code>## [1] 51878</code></pre>
<p>From these query results, it looks like South Carolina has much more stream data than it does lake data.</p>
<p>Now, let’s try our South Carolina stream temperature query with <code>whatWQPsites</code> and see if we can narrow the results at all.</p>
</div>
<div id="whatwqpsites" class="section level3">
<h3><span class="header-section-number">8.10.2</span> whatWQPsites</h3>
<p><code>whatWQPsites</code> gives back site information that matches your search criteria. You can use any of the regular WQP web service arguments here. We are going to use <code>whatWQPsites</code> with the final criteria of the last query summary call - state, site type, parameter, and the earliest start date. This should return the same amount of sites as the last <code>readWQPdata</code> query did, 1,462.</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb705-1" data-line-number="1"><span class="co"># Getting the number of sites and results for stream </span></a>
<a class="sourceLine" id="cb705-2" data-line-number="2"><span class="co"># temperature measurements in South Carolina after 1975.</span></a>
<a class="sourceLine" id="cb705-3" data-line-number="3">wqpsites_sc_stream_temp &lt;-<span class="st"> </span><span class="kw">whatWQPsites</span>(<span class="dt">statecode=</span><span class="st">&quot;US:45&quot;</span>, <span class="dt">siteType=</span><span class="st">&quot;Stream&quot;</span>,</a>
<a class="sourceLine" id="cb705-4" data-line-number="4">                                       <span class="dt">characteristicName=</span><span class="st">&quot;Temperature, water&quot;</span>,</a>
<a class="sourceLine" id="cb705-5" data-line-number="5">                                       <span class="dt">startDate=</span><span class="st">&quot;1975-01-01&quot;</span>)</a>
<a class="sourceLine" id="cb705-6" data-line-number="6"><span class="co"># number of sites</span></a>
<a class="sourceLine" id="cb705-7" data-line-number="7"><span class="kw">nrow</span>(wqpsites_sc_stream_temp)</a></code></pre></div>
<pre><code>## [1] 1462</code></pre>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb707-1" data-line-number="1"><span class="co"># names of available columns</span></a>
<a class="sourceLine" id="cb707-2" data-line-number="2"><span class="kw">names</span>(wqpsites_sc_stream_temp)</a></code></pre></div>
<pre><code>##  [1] &quot;OrganizationIdentifier&quot;                         
##  [2] &quot;OrganizationFormalName&quot;                         
##  [3] &quot;MonitoringLocationIdentifier&quot;                   
##  [4] &quot;MonitoringLocationName&quot;                         
##  [5] &quot;MonitoringLocationTypeName&quot;                     
##  [6] &quot;MonitoringLocationDescriptionText&quot;              
##  [7] &quot;HUCEightDigitCode&quot;                              
##  [8] &quot;DrainageAreaMeasure.MeasureValue&quot;               
##  [9] &quot;DrainageAreaMeasure.MeasureUnitCode&quot;            
## [10] &quot;ContributingDrainageAreaMeasure.MeasureValue&quot;   
## [11] &quot;ContributingDrainageAreaMeasure.MeasureUnitCode&quot;
## [12] &quot;LatitudeMeasure&quot;                                
## [13] &quot;LongitudeMeasure&quot;                               
## [14] &quot;SourceMapScaleNumeric&quot;                          
## [15] &quot;HorizontalAccuracyMeasure.MeasureValue&quot;         
## [16] &quot;HorizontalAccuracyMeasure.MeasureUnitCode&quot;      
## [17] &quot;HorizontalCollectionMethodName&quot;                 
## [18] &quot;HorizontalCoordinateReferenceSystemDatumName&quot;   
## [19] &quot;VerticalMeasure.MeasureValue&quot;                   
## [20] &quot;VerticalMeasure.MeasureUnitCode&quot;                
## [21] &quot;VerticalAccuracyMeasure.MeasureValue&quot;           
## [22] &quot;VerticalAccuracyMeasure.MeasureUnitCode&quot;        
## [23] &quot;VerticalCollectionMethodName&quot;                   
## [24] &quot;VerticalCoordinateReferenceSystemDatumName&quot;     
## [25] &quot;CountryCode&quot;                                    
## [26] &quot;StateCode&quot;                                      
## [27] &quot;CountyCode&quot;                                     
## [28] &quot;AquiferName&quot;                                    
## [29] &quot;FormationTypeText&quot;                              
## [30] &quot;AquiferTypeName&quot;                                
## [31] &quot;ConstructionDateText&quot;                           
## [32] &quot;WellDepthMeasure.MeasureValue&quot;                  
## [33] &quot;WellDepthMeasure.MeasureUnitCode&quot;               
## [34] &quot;WellHoleDepthMeasure.MeasureValue&quot;              
## [35] &quot;WellHoleDepthMeasure.MeasureUnitCode&quot;           
## [36] &quot;ProviderName&quot;</code></pre>
<p>Similar to what we did with the NWIS functions, we can filter the sites further using the available metadata in <code>wqpsites_sc_stream_temp</code>. We are going to imagine that for our study the sites must have an associated drainage area and cannot be below sea level. Using <code>dplyr::filter</code>:</p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb709-1" data-line-number="1"><span class="co"># Filtering the number of sites and results for stream temperature </span></a>
<a class="sourceLine" id="cb709-2" data-line-number="2"><span class="co"># measurements in South Carolina after 1975 to also have an</span></a>
<a class="sourceLine" id="cb709-3" data-line-number="3"><span class="co"># associated drainage area and collected above sea level.</span></a>
<a class="sourceLine" id="cb709-4" data-line-number="4">wqpsites_sc_stream_temp_applicable &lt;-<span class="st"> </span>wqpsites_sc_stream_temp <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb709-5" data-line-number="5"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(DrainageAreaMeasure.MeasureValue),</a>
<a class="sourceLine" id="cb709-6" data-line-number="6">         VerticalMeasure.MeasureValue <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb709-7" data-line-number="7"></a>
<a class="sourceLine" id="cb709-8" data-line-number="8"><span class="kw">nrow</span>(wqpsites_sc_stream_temp_applicable)</a></code></pre></div>
<pre><code>## [1] 74</code></pre>
<p>This brings the count down to a much more manageable 74 sites. Now we are ready to download this data.</p>
</div>
</div>
<div id="readnwis-functions" class="section level2">
<h2><span class="header-section-number">8.11</span> readNWIS functions</h2>
<p>We have learned how to discover data available in NWIS, but now we will look at how to retrieve data. There are many functions to do this, see the table below for a description of each. Each variation of <code>readNWIS</code> is accessing a different web service. For a definition and more information on each of these services, please see <a href="https://waterservices.usgs.gov/rest/" class="uri">https://waterservices.usgs.gov/rest/</a>. Also, refer to the previous lesson for a description of the major arguments to <code>readNWIS</code> functions.</p>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<td colspan="3" style="text-align: left;">
<caption>
Table 1. readNWIS function definitions
</caption>
</td>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Function
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Description
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Arguments
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
<a href="usgs-national-water-information-system-nwis.html#readnwisdata">readNWISdata</a>
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Most general NWIS data import function. User must explicitly define the service parameter. More flexible than the other functions.
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
…, asDateTime, convertType, tz
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
<a href="usgs-national-water-information-system-nwis.html#readnwisdv">readNWISdv</a>
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Returns time-series data summarized to a day. Default is mean daily.
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
siteNumbers, parameterCd, startDate, endDate, statCd
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
<a href="usgs-national-water-information-system-nwis.html#readnwisgwl">readNWISgwl</a>
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Groundwater levels.
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
siteNumbers, startDate, endDate, convertType, tz
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
<a href="usgs-national-water-information-system-nwis.html#readnwismeas">readNWISmeas</a>
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Surface water measurements.
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
siteNumbers, startDate, endDate, tz, expanded, convertType
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
<a href="usgs-national-water-information-system-nwis.html#readnwispcode">readNWISpCode</a>
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Metadata information for one or many parameter codes.
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
parameterCd
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
<a href="usgs-national-water-information-system-nwis.html#readnwispeak">readNWISpeak</a>
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Annual maximum instantaneous streamflows and gage heights.
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
siteNumbers, startDate, endDate, asDateTime, convertType
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
<a href="usgs-national-water-information-system-nwis.html#readnwisqw">readNWISqw</a>
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Discrete water quality data.
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
siteNumbers, parameterCd, startDate, endDate, expanded, reshape, tz
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
<a href="usgs-national-water-information-system-nwis.html#readnwisrating">readNWISrating</a>
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Rating table information for active stream gages
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
siteNumber, type, convertType
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
<a href="usgs-national-water-information-system-nwis.html#readnwissite">readNWISsite</a>
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Site metadata information
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
siteNumbers
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
<a href="usgs-national-water-information-system-nwis.html#readnwisstat">readNWISstat</a>
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Daily, monthly, or annual statistics for time-series data. Default is mean daily.
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
siteNumbers, parameterCd, startDate, endDate, convertType, statReportType, statType
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
<a href="usgs-national-water-information-system-nwis.html#readnwisuse">readNWISuse</a>
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Data from the USGS National Water Use Program.
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
stateCd, countyCd, years, categories, convertType, transform
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: left;">
<a href="usgs-national-water-information-system-nwis.html#readnwisuv">readNWISuv</a>
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: left;">
Returns time-series data reported from the USGS Instantaneous Values Web Service.
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: left;">
siteNumbers, parameterCd, startDate, endDate, tz
</td>
</tr>
</tbody>
</table>

<p>Each service-specific function is a wrapper for the more flexible <code>readNWISdata</code>. They set a default for the service argument and have limited user defined arguments. All <code>readNWIS</code> functions require a “major filter” as an argument, but <code>readNWISdata</code> can accept any major filter while others are limited to site numbers or state/county codes (see Table 1 for more info).</p>
<p>Other major filters that can be used in <code>readNWISdata</code> include hydrologic unit codes (<code>huc</code>) and bounding boxes (<code>bBox</code>). More information about major filters can be found in the <a href="https://waterservices.usgs.gov/rest/Site-Service.html#Major_Filters">NWIS web services documentation</a>.</p>
<p>The following are examples of how to use each of the readNWIS family of functions. Don’t forget to load the <code>dataRetrieval</code> library if you are in a new session.</p>
<ol style="list-style-type: decimal">
<li><a href="#readnwisdata-county">readNWISdata, county major filter</a></li>
<li><a href="#readnwisdata-huc">readNWISdata, huc major filter</a></li>
<li><a href="#readnwisdata-bbox">readNWISdata, bbox major filter</a></li>
<li><a href="usgs-national-water-information-system-nwis.html#readnwisdv">readNWISdv</a></li>
<li><a href="usgs-national-water-information-system-nwis.html#readnwisgwl">readNWISgwl</a></li>
<li><a href="usgs-national-water-information-system-nwis.html#readnwismeas">readNWISmeas</a></li>
<li><a href="usgs-national-water-information-system-nwis.html#readnwispcode">readNWISpCode</a></li>
<li><a href="usgs-national-water-information-system-nwis.html#readnwispeak">readNWISpeak</a></li>
<li><a href="#readnwisqw-multsite">readNWISqw, multiple sites</a></li>
<li><a href="#readnwisqw-multparm">readNWISqw, multiple parameters</a></li>
<li><a href="usgs-national-water-information-system-nwis.html#readnwisrating">readNWISrating, using base table</a></li>
<li><a href="usgs-national-water-information-system-nwis.html#readnwisrating">readNWISrating, corrected table</a></li>
<li><a href="usgs-national-water-information-system-nwis.html#readnwisrating">readNWISrating, shift table</a></li>
<li><a href="usgs-national-water-information-system-nwis.html#readnwissite">readNWISsite</a></li>
<li><a href="usgs-national-water-information-system-nwis.html#readnwisstat">readNWISstat</a></li>
<li><a href="usgs-national-water-information-system-nwis.html#readnwisuse">readNWISuse</a></li>
<li><a href="usgs-national-water-information-system-nwis.html#readnwisuv">readNWISuv</a></li>
</ol>
<div id="readnwisdata" class="section level3">
<h3><span class="header-section-number">8.11.1</span> readNWISdata</h3>
<p>This function is the generic, catch-all for pulling down NWIS data. It can accept a number of arguments, but the argument name must be included. To use this function, you need to specify at list one major filter (state, county, site number, huc, or bounding box) and the NWIS service (daily value, instantaneous, groundwater, etc). The rest are optional query parameters. Follow along with the three examples below or see <code>?readNWISdata</code> for more information.</p>
<p><a name="readnwisdata-county"></a></p>
<p><strong>Historic mean daily streamflow for sites in Maui County, Hawaii.</strong></p>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb711-1" data-line-number="1"><span class="co"># Major filter: Maui County </span></a>
<a class="sourceLine" id="cb711-2" data-line-number="2"><span class="co">## need to also include the state when using counties as the major filter</span></a>
<a class="sourceLine" id="cb711-3" data-line-number="3"><span class="co"># Service: daily value, dv</span></a>
<a class="sourceLine" id="cb711-4" data-line-number="4"><span class="co"># Parameter code: streamflow in cfs, 00060</span></a>
<a class="sourceLine" id="cb711-5" data-line-number="5"></a>
<a class="sourceLine" id="cb711-6" data-line-number="6">MauiCo_avgdailyQ &lt;-<span class="st"> </span><span class="kw">readNWISdata</span>(<span class="dt">stateCd=</span><span class="st">&quot;Hawaii&quot;</span>, <span class="dt">countyCd=</span><span class="st">&quot;Maui&quot;</span>, <span class="dt">service=</span><span class="st">&quot;dv&quot;</span>, <span class="dt">parameterCd=</span><span class="st">&quot;00060&quot;</span>)</a>
<a class="sourceLine" id="cb711-7" data-line-number="7"><span class="kw">head</span>(MauiCo_avgdailyQ)</a></code></pre></div>
<pre><code>##   agency_cd  site_no   dateTime X_00060_00003 X_00060_00003_cd tz_cd
## 1      USGS 16400000 2020-10-18          7.94                P   UTC
## 2      USGS 16401000 1929-08-31         18.00                A   UTC
## 3      USGS 16402000 1957-07-31         51.00                A   UTC
## 4      USGS 16403000 1957-06-30          5.50                A   UTC
## 5      USGS 16403600 1970-09-29          2.40                A   UTC
## 6      USGS 16403900 1996-09-30          1.30                A   UTC</code></pre>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb713-1" data-line-number="1"><span class="co"># How many sites are returned?</span></a>
<a class="sourceLine" id="cb713-2" data-line-number="2"><span class="kw">length</span>(<span class="kw">unique</span>(MauiCo_avgdailyQ<span class="op">$</span>site_no))</a></code></pre></div>
<pre><code>## [1] 132</code></pre>
<p><a name="readnwisdata-huc"></a></p>
<p><strong>Historic minimum water temperatures for the HUC8 corresponding to the island of Maui, Hawaii.</strong></p>
<p>To see all HUCs available, visit <a href="https://water.usgs.gov/GIS/huc_name.html" class="uri">https://water.usgs.gov/GIS/huc_name.html</a>. The default statistic for daily values in <code>readNWISdata</code> is to return the max (00001), min (00002), and mean (00003). We will specify the minimum only for this example. You will need to use the statistic code, not the name. For all the available statistic codes, see the <a href="https://waterservices.usgs.gov/rest/Statistics-Service.html#statType">statType web service documentation</a> and <a href="https://help.waterdata.usgs.gov/stat_code">NWIS table mapping statistic names to codes</a>. Caution! In <code>readNWISdata</code> and <code>readNWISdv</code> the argument is called <code>statCd</code>, but in <code>readNWISstat</code> the argument is <code>statType</code>.</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb715-1" data-line-number="1"><span class="co"># Major filter: HUC 8 for Maui, 20020000</span></a>
<a class="sourceLine" id="cb715-2" data-line-number="2"><span class="co"># Service: daily value, dv</span></a>
<a class="sourceLine" id="cb715-3" data-line-number="3"><span class="co"># Statistic: minimum, 00002</span></a>
<a class="sourceLine" id="cb715-4" data-line-number="4"><span class="co"># Parameter code: water temperature in deg C, 00010</span></a>
<a class="sourceLine" id="cb715-5" data-line-number="5"></a>
<a class="sourceLine" id="cb715-6" data-line-number="6">MauiHUC8_mindailyT &lt;-<span class="st"> </span><span class="kw">readNWISdata</span>(<span class="dt">huc=</span><span class="st">&quot;20020000&quot;</span>, <span class="dt">service=</span><span class="st">&quot;dv&quot;</span>, <span class="dt">statCd=</span><span class="st">&quot;00002&quot;</span>, <span class="dt">parameterCd=</span><span class="st">&quot;00010&quot;</span>)</a>
<a class="sourceLine" id="cb715-7" data-line-number="7"><span class="kw">head</span>(MauiHUC8_mindailyT)</a></code></pre></div>
<pre><code>##   agency_cd  site_no   dateTime X_00010_00002 X_00010_00002_cd tz_cd
## 1      USGS 16508000 2003-11-24          17.4                A   UTC
## 2      USGS 16516000 2003-11-24          16.3                A   UTC
## 3      USGS 16520000 2004-04-14          17.5                A   UTC
## 4      USGS 16527000 2004-01-13          15.4                A   UTC
## 5      USGS 16555000 2004-01-13          16.4                A   UTC
## 6      USGS 16618000 2020-10-18          20.5                P   UTC</code></pre>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb717-1" data-line-number="1"><span class="co"># How many sites are returned?</span></a>
<a class="sourceLine" id="cb717-2" data-line-number="2"><span class="kw">length</span>(<span class="kw">unique</span>(MauiHUC8_mindailyT<span class="op">$</span>site_no))</a></code></pre></div>
<pre><code>## [1] 47</code></pre>
<p><a name="readnwisdata-bbox"></a></p>
<p><strong>Total nitrogen in mg/L for last 30 days around Great Salt Lake in Utah.</strong></p>
<p>This example uses <code>Sys.Date</code> to get the most recent date, so your dates will differ. To get any data around Great Salt Lake, we will use a bounding box as the major filter. The bounding box must be a vector of decimal numbers indicating the western longitude, southern latitude, eastern longitude, and northern latitude. The vector must be in that order.</p>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb719-1" data-line-number="1"><span class="co"># Major filter: bounding box around Great Salt Lake </span></a>
<a class="sourceLine" id="cb719-2" data-line-number="2"><span class="co"># Service: water quality, qw</span></a>
<a class="sourceLine" id="cb719-3" data-line-number="3"><span class="co"># Parameter code: total nitrogen in mg/L, 00600</span></a>
<a class="sourceLine" id="cb719-4" data-line-number="4"><span class="co"># Beginning: this past 30 days, use Sys.Date()</span></a>
<a class="sourceLine" id="cb719-5" data-line-number="5"></a>
<a class="sourceLine" id="cb719-6" data-line-number="6">prev30days &lt;-<span class="st"> </span><span class="kw">Sys.Date</span>() <span class="op">-</span><span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb719-7" data-line-number="7">SaltLake_totalN &lt;-<span class="st"> </span><span class="kw">readNWISdata</span>(<span class="dt">bBox=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">113.0428</span>, <span class="fl">40.6474</span>, <span class="fl">-112.0265</span>, <span class="fl">41.7018</span>), <span class="dt">service=</span><span class="st">&quot;qw&quot;</span>, </a>
<a class="sourceLine" id="cb719-8" data-line-number="8">                           <span class="dt">parameterCd=</span><span class="st">&quot;00600&quot;</span>, <span class="dt">startDate=</span>prev30days)</a>
<a class="sourceLine" id="cb719-9" data-line-number="9"><span class="co"># This service returns a lot of columns:</span></a>
<a class="sourceLine" id="cb719-10" data-line-number="10"><span class="kw">names</span>(SaltLake_totalN)</a></code></pre></div>
<pre><code>##  [1] &quot;agency_cd&quot;                  &quot;site_no&quot;                   
##  [3] &quot;sample_dt&quot;                  &quot;sample_tm&quot;                 
##  [5] &quot;sample_end_dt&quot;              &quot;sample_end_tm&quot;             
##  [7] &quot;sample_start_time_datum_cd&quot; &quot;tm_datum_rlbty_cd&quot;         
##  [9] &quot;coll_ent_cd&quot;                &quot;medium_cd&quot;                 
## [11] &quot;tu_id&quot;                      &quot;body_part_id&quot;              
## [13] &quot;p00003&quot;                     &quot;p00004&quot;                    
## [15] &quot;p00009&quot;                     &quot;p00010&quot;                    
## [17] &quot;p00020&quot;                     &quot;p00025&quot;                    
## [19] &quot;p00061&quot;                     &quot;p00063&quot;                    
## [21] &quot;p00065&quot;                     &quot;p00095&quot;                    
## [23] &quot;p00098&quot;                     &quot;p00191&quot;                    
## [25] &quot;p00300&quot;                     &quot;p00301&quot;                    
## [27] &quot;p00400&quot;                     &quot;p00480&quot;                    
## [29] &quot;p30207&quot;                     &quot;p30209&quot;                    
## [31] &quot;p30211&quot;                     &quot;p50015&quot;                    
## [33] &quot;p50280&quot;                     &quot;p70305&quot;                    
## [35] &quot;p71820&quot;                     &quot;p71999&quot;                    
## [37] &quot;p72012&quot;                     &quot;p72013&quot;                    
## [39] &quot;p72020&quot;                     &quot;p72219&quot;                    
## [41] &quot;p72220&quot;                     &quot;p72263&quot;                    
## [43] &quot;p81904&quot;                     &quot;p82398&quot;                    
## [45] &quot;p84164&quot;                     &quot;p84171&quot;                    
## [47] &quot;p84182&quot;                     &quot;p99111&quot;                    
## [49] &quot;p99156&quot;                     &quot;p99159&quot;                    
## [51] &quot;p99171&quot;                     &quot;p99173&quot;                    
## [53] &quot;p99206&quot;                     &quot;startDateTime&quot;</code></pre>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb721-1" data-line-number="1"><span class="co"># How many sites are returned?</span></a>
<a class="sourceLine" id="cb721-2" data-line-number="2"><span class="kw">length</span>(<span class="kw">unique</span>(SaltLake_totalN<span class="op">$</span>site_no))</a></code></pre></div>
<pre><code>## [1] 10</code></pre>
</div>
<div id="readnwisdv" class="section level3">
<h3><span class="header-section-number">8.11.2</span> readNWISdv</h3>
<p>This function is the daily value service function. It has a limited number of arguments and requires a site number and parameter code. Follow along with the example below or see <code>?readNWISdv</code> for more information.</p>
<p><a name="readnwisdv"></a></p>
<p><strong>Minimum and maximum pH daily data for a site on the Missouri River near Townsend, MT.</strong></p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb723-1" data-line-number="1"><span class="co"># Remember, you can always use whatNWISdata to see what is available at the site before querying</span></a>
<a class="sourceLine" id="cb723-2" data-line-number="2">mt_available &lt;-<span class="st"> </span><span class="kw">whatNWISdata</span>(<span class="dt">siteNumber=</span><span class="st">&quot;462107111312301&quot;</span>, <span class="dt">service=</span><span class="st">&quot;dv&quot;</span>, <span class="dt">parameterCd=</span><span class="st">&quot;00400&quot;</span>)</a>
<a class="sourceLine" id="cb723-3" data-line-number="3"><span class="kw">head</span>(mt_available)</a></code></pre></div>
<pre><code>##   agency_cd         site_no                                 station_nm
## 4      USGS 462107111312301 Missouri River ab Canyon Ferry nr Townsend
## 5      USGS 462107111312301 Missouri River ab Canyon Ferry nr Townsend
## 6      USGS 462107111312301 Missouri River ab Canyon Ferry nr Townsend
##   site_tp_cd dec_lat_va dec_long_va coord_acy_cd dec_coord_datum_cd alt_va
## 4         ST   46.35188   -111.5239            S              NAD83   3790
## 5         ST   46.35188   -111.5239            S              NAD83   3790
## 6         ST   46.35188   -111.5239            S              NAD83   3790
##   alt_acy_va alt_datum_cd   huc_cd data_type_cd parm_cd stat_cd ts_id
## 4         20       NGVD29 10030101           dv   00400   00001 82218
## 5         20       NGVD29 10030101           dv   00400   00002 82219
## 6         20       NGVD29 10030101           dv   00400   00008 82220
##   loc_web_ds medium_grp_cd parm_grp_cd   srs_id access_cd begin_date   end_date
## 4         NA           wat        &lt;NA&gt; 17028275         0 2010-08-18 2011-09-21
## 5         NA           wat        &lt;NA&gt; 17028275         0 2010-08-18 2011-09-21
## 6         NA           wat        &lt;NA&gt; 17028275         0 2010-08-18 2011-09-21
##   count_nu
## 4       72
## 5       72
## 6       72</code></pre>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb725-1" data-line-number="1"><span class="co"># Major filter: site number, 462107111312301</span></a>
<a class="sourceLine" id="cb725-2" data-line-number="2"><span class="co"># Statistic: minimum and maximum, 00001 and 00002</span></a>
<a class="sourceLine" id="cb725-3" data-line-number="3"><span class="co"># Parameter: pH, 00400</span></a>
<a class="sourceLine" id="cb725-4" data-line-number="4">mt_site_pH &lt;-<span class="st"> </span><span class="kw">readNWISdv</span>(<span class="dt">siteNumber=</span><span class="st">&quot;462107111312301&quot;</span>, <span class="dt">parameterCd=</span><span class="st">&quot;00400&quot;</span>, </a>
<a class="sourceLine" id="cb725-5" data-line-number="5">                         <span class="dt">statCd=</span><span class="kw">c</span>(<span class="st">&quot;00001&quot;</span>, <span class="st">&quot;00002&quot;</span>))</a>
<a class="sourceLine" id="cb725-6" data-line-number="6"><span class="kw">head</span>(mt_site_pH)</a></code></pre></div>
<pre><code>##   agency_cd         site_no       Date X_00400_00001 X_00400_00001_cd
## 1      USGS 462107111312301 2010-08-18           8.9                A
## 2      USGS 462107111312301 2010-08-19           8.9                A
## 3      USGS 462107111312301 2010-08-20           8.9                A
## 4      USGS 462107111312301 2010-08-21           8.9                A
## 5      USGS 462107111312301 2010-08-22           8.8                A
## 6      USGS 462107111312301 2010-08-23           8.9                A
##   X_00400_00002 X_00400_00002_cd
## 1           8.3                A
## 2           8.3                A
## 3           8.4                A
## 4           8.4                A
## 5           8.4                A
## 6           8.4                A</code></pre>
</div>
<div id="readnwisgwl" class="section level3">
<h3><span class="header-section-number">8.11.3</span> readNWISgwl</h3>
<p>This function is the groundwater level service function. It has a limited number of arguments and requires a site number. Follow along with the example below or see <code>?readNWISgwl</code> for more information.</p>
<p><a name="readnwisgwl"></a></p>
<p><strong>Historic groundwater levels for a site near Portland, Oregon.</strong></p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb727-1" data-line-number="1"><span class="co"># Major filter: site number, 452840122302202</span></a>
<a class="sourceLine" id="cb727-2" data-line-number="2">or_site_gwl &lt;-<span class="st"> </span><span class="kw">readNWISgwl</span>(<span class="dt">siteNumbers=</span><span class="st">&quot;452840122302202&quot;</span>)</a>
<a class="sourceLine" id="cb727-3" data-line-number="3"><span class="kw">head</span>(or_site_gwl)</a></code></pre></div>
<pre><code>##   agency_cd         site_no site_tp_cd     lev_dt lev_tm lev_tz_cd_reported
## 1      USGS 452840122302202         GW 1988-03-14   &lt;NA&gt;                UTC
## 2      USGS 452840122302202         GW 1988-04-05  10:50                PDT
## 3      USGS 452840122302202         GW 1988-06-16  15:00                PDT
## 4      USGS 452840122302202         GW 1988-07-19  15:33                PDT
## 5      USGS 452840122302202         GW 1988-08-30  15:20                PDT
## 6      USGS 452840122302202         GW 1988-10-03  14:39                PDT
##   lev_va sl_lev_va sl_datum_cd lev_status_cd lev_agency_cd lev_dt_acy_cd
## 1   9.78        NA        &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;             D
## 2   8.77        NA        &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;             m
## 3  10.59        NA        &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;             m
## 4  11.62        NA        &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;             m
## 5  12.13        NA        &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;             m
## 6  12.25        NA        &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;             m
##   lev_acy_cd lev_src_cd lev_meth_cd lev_age_cd        lev_dateTime lev_tz_cd
## 1          2          U           U          A                &lt;NA&gt;       UTC
## 2          2          U           S          A 1988-04-05 17:50:00       UTC
## 3          2          U           S          A 1988-06-16 22:00:00       UTC
## 4          2          U           S          A 1988-07-19 22:33:00       UTC
## 5          2          U           S          A 1988-08-30 22:20:00       UTC
## 6          2          U           S          A 1988-10-03 21:39:00       UTC</code></pre>
</div>
<div id="readnwismeas" class="section level3">
<h3><span class="header-section-number">8.11.4</span> readNWISmeas</h3>
<p>This function is the field measurement service function which pulls manual measurements for streamflow and gage height. It has a limited number of arguments and requires a site number. Follow along with the example below or see <code>?readNWISmeas</code> for more information.</p>
<p><a name="readnwismeas"></a></p>
<p><strong>Historic surface water measurements for a site near Dade City, Florida.</strong></p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb729-1" data-line-number="1"><span class="co"># Major filter: site number, 02311500</span></a>
<a class="sourceLine" id="cb729-2" data-line-number="2">fl_site_meas &lt;-<span class="st"> </span><span class="kw">readNWISmeas</span>(<span class="dt">siteNumbers=</span><span class="st">&quot;02311500&quot;</span>)</a>
<a class="sourceLine" id="cb729-3" data-line-number="3"><span class="co"># Names of columns returned:</span></a>
<a class="sourceLine" id="cb729-4" data-line-number="4"><span class="kw">names</span>(fl_site_meas)</a></code></pre></div>
<pre><code>##  [1] &quot;agency_cd&quot;                 &quot;site_no&quot;                  
##  [3] &quot;measurement_nu&quot;            &quot;measurement_dt&quot;           
##  [5] &quot;measurement_tm&quot;            &quot;tz_cd_reported&quot;           
##  [7] &quot;q_meas_used_fg&quot;            &quot;party_nm&quot;                 
##  [9] &quot;site_visit_coll_agency_cd&quot; &quot;gage_height_va&quot;           
## [11] &quot;discharge_va&quot;              &quot;measured_rating_diff&quot;     
## [13] &quot;gage_va_change&quot;            &quot;gage_va_time&quot;             
## [15] &quot;control_type_cd&quot;           &quot;discharge_cd&quot;             
## [17] &quot;measurement_dateTime&quot;      &quot;tz_cd&quot;</code></pre>
</div>
<div id="readnwispcode" class="section level3">
<h3><span class="header-section-number">8.11.5</span> readNWISpCode</h3>
<p>This function returns the parameter information associated with a parameter code. It only has one argument - the parameter code. See the example below or <code>?readNWISpCode</code> for more information.</p>
<p><a name="readnwispcode"></a></p>
<p><strong>Get information about the parameters gage height, specific conductance, and total phosphorus.</strong></p>
<p>This function only has one argument, the parameter code. You can supply one or multiple and you will get a dataframe with information about each parameter.</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb731-1" data-line-number="1"><span class="co"># gage height, 00065</span></a>
<a class="sourceLine" id="cb731-2" data-line-number="2"><span class="kw">readNWISpCode</span>(<span class="st">&quot;00065&quot;</span>)</a></code></pre></div>
<pre><code>##      parameter_cd parameter_group_nm      parameter_nm casrn      srsname
## 1521        00065           Physical Gage height, feet  &lt;NA&gt; Height, gage
##      parameter_units
## 1521              ft</code></pre>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb733-1" data-line-number="1"><span class="co"># specific conductance and total phosphorus, 00095 and 00665</span></a>
<a class="sourceLine" id="cb733-2" data-line-number="2"><span class="kw">readNWISpCode</span>(<span class="kw">c</span>(<span class="st">&quot;00095&quot;</span>, <span class="st">&quot;00665&quot;</span>))</a></code></pre></div>
<pre><code>##      parameter_cd parameter_group_nm
## 1536        00095           Physical
## 2740        00665           Nutrient
##                                                                                    parameter_nm
## 1536 Specific conductance, water, unfiltered, microsiemens per centimeter at 25 degrees Celsius
## 2740                          Phosphorus, water, unfiltered, milligrams per liter as phosphorus
##          casrn              srsname parameter_units
## 1536      &lt;NA&gt; Specific conductance      uS/cm @25C
## 2740 7723-14-0           Phosphorus       mg/l as P</code></pre>
</div>
<div id="readnwispeak" class="section level3">
<h3><span class="header-section-number">8.11.6</span> readNWISpeak</h3>
<p>This function is the peak flow service function. It has a limited number of arguments and requires a site number. Follow along with the example below or see <code>?readNWISpeak</code> for more information.</p>
<p>The default settings will return data where the date of the peak flow is known. To see peak flows with incomplete dates, change <code>convertType</code> to <code>FALSE</code>. This allows the date column to come through as character, keeping any incomplete or incorrect dates.</p>
<p><a name="readnwispeak"></a></p>
<p><strong>Peak flow values for a site near Cassia, Florida.</strong></p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb735-1" data-line-number="1"><span class="co"># Major filter: site number, 02235200</span></a>
<a class="sourceLine" id="cb735-2" data-line-number="2">fl_site_peak &lt;-<span class="st"> </span><span class="kw">readNWISpeak</span>(<span class="dt">siteNumbers=</span><span class="st">&quot;02235200&quot;</span>)</a>
<a class="sourceLine" id="cb735-3" data-line-number="3">fl_site_peak<span class="op">$</span>peak_dt</a></code></pre></div>
<pre><code>##  [1] &quot;1962-10-06&quot; &quot;1964-09-13&quot; &quot;1965-08-11&quot; &quot;1966-08-15&quot; &quot;1967-08-30&quot;
##  [6] &quot;1968-09-01&quot; &quot;1968-10-22&quot; &quot;1969-10-05&quot; &quot;1971-02-10&quot; &quot;1972-04-02&quot;
## [11] &quot;1973-09-16&quot; &quot;1974-09-07&quot; &quot;1975-09-01&quot; &quot;1976-06-06&quot; NA          
## [16] &quot;1978-08-08&quot; &quot;1979-09-29&quot; &quot;1980-04-04&quot; &quot;1981-09-18&quot; &quot;1982-04-12&quot;
## [21] &quot;1983-04-24&quot; &quot;1984-04-11&quot; &quot;1985-09-21&quot; &quot;1986-01-14&quot; &quot;1987-04-01&quot;
## [26] &quot;1988-09-11&quot; &quot;1989-01-24&quot; &quot;1990-02-27&quot; &quot;1991-06-02&quot; &quot;1991-10-08&quot;
## [31] &quot;1993-03-27&quot; &quot;1994-09-12&quot; &quot;1994-11-18&quot; &quot;1995-10-12&quot; &quot;1996-10-12&quot;
## [36] &quot;1998-02-21&quot; &quot;1998-10-05&quot; &quot;1999-10-08&quot; &quot;2001-09-17&quot; &quot;2002-08-16&quot;
## [41] &quot;2003-03-10&quot; &quot;2004-09-13&quot; &quot;2004-10-01&quot; &quot;2005-10-25&quot; &quot;2007-07-21&quot;
## [46] &quot;2008-08-26&quot; &quot;2009-05-26&quot; &quot;2010-03-16&quot; &quot;2011-04-07&quot; &quot;2012-08-30&quot;
## [51] &quot;2012-10-08&quot; &quot;2014-07-31&quot; &quot;2015-09-20&quot; &quot;2016-02-06&quot; &quot;2017-09-12&quot;
## [56] &quot;2018-07-06&quot; &quot;2019-08-17&quot;</code></pre>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb737-1" data-line-number="1"><span class="co"># Compare complete with incomplete/incorrect dates</span></a>
<a class="sourceLine" id="cb737-2" data-line-number="2">fl_site_peak_incomp &lt;-<span class="st"> </span><span class="kw">readNWISpeak</span>(<span class="dt">siteNumbers=</span><span class="st">&quot;02235200&quot;</span>, <span class="dt">convertType =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb737-3" data-line-number="3">fl_site_peak_incomp<span class="op">$</span>peak_dt[<span class="kw">is.na</span>(fl_site_peak<span class="op">$</span>peak_dt)]</a></code></pre></div>
<pre><code>## [1] &quot;1977-00-00&quot;</code></pre>
</div>
<div id="readnwisqw" class="section level3">
<h3><span class="header-section-number">8.11.7</span> readNWISqw</h3>
<p>This function is the water quality service function. It has a limited number of arguments and requires a site number and a parameter code. Follow along with the two examples below or see <code>?readNWISqw</code> for more information.</p>
<p><a name="readnwisqw-multsite"></a></p>
<p><strong>Dissolved oxygen for two sites near the Columbia River in Oregon for water year 2016</strong></p>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb739-1" data-line-number="1"><span class="co"># Major filter: site numbers, 455415119314601 and 454554119121801</span></a>
<a class="sourceLine" id="cb739-2" data-line-number="2"><span class="co"># Parameter: dissolved oxygen in mg/L, 00300</span></a>
<a class="sourceLine" id="cb739-3" data-line-number="3"><span class="co"># Begin date: October 1, 2015</span></a>
<a class="sourceLine" id="cb739-4" data-line-number="4"><span class="co"># End date: September 30, 2016</span></a>
<a class="sourceLine" id="cb739-5" data-line-number="5"></a>
<a class="sourceLine" id="cb739-6" data-line-number="6">or_site_do &lt;-<span class="st"> </span><span class="kw">readNWISqw</span>(<span class="dt">siteNumbers=</span><span class="kw">c</span>(<span class="st">&quot;455415119314601&quot;</span>, <span class="st">&quot;454554119121801&quot;</span>), <span class="dt">parameterCd=</span><span class="st">&quot;00300&quot;</span>,</a>
<a class="sourceLine" id="cb739-7" data-line-number="7">                        <span class="dt">startDate=</span><span class="st">&quot;2015-10-01&quot;</span>, <span class="dt">endDate=</span><span class="st">&quot;2016-09-30&quot;</span>)</a>
<a class="sourceLine" id="cb739-8" data-line-number="8"><span class="kw">ncol</span>(or_site_do)</a></code></pre></div>
<pre><code>## [1] 34</code></pre>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb741-1" data-line-number="1"><span class="kw">head</span>(or_site_do[,<span class="kw">c</span>(<span class="st">&quot;site_no&quot;</span>,<span class="st">&quot;sample_dt&quot;</span>,<span class="st">&quot;result_va&quot;</span>)])</a></code></pre></div>
<pre><code>##           site_no  sample_dt result_va
## 1 455415119314601 2015-10-28       0.7
## 2 455415119314601 2016-01-20       0.1
## 3 455415119314601 2016-03-18       0.1
## 4 455415119314601 2016-04-21       0.4
## 5 455415119314601 2016-06-22       0.5
## 6 455415119314601 2016-07-28       0.0</code></pre>
<p><a name="readnwisqw-multparm"></a></p>
<p><strong>Post Clean Water Act lead and mercury levels in McGaw, Ohio.</strong></p>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb743-1" data-line-number="1"><span class="co"># Major filter: site number, 03237280</span></a>
<a class="sourceLine" id="cb743-2" data-line-number="2"><span class="co"># Parameter: mercury and lead in micrograms/liter, 71890 and 01049</span></a>
<a class="sourceLine" id="cb743-3" data-line-number="3"><span class="co"># Begin date: January 1, 1972</span></a>
<a class="sourceLine" id="cb743-4" data-line-number="4"></a>
<a class="sourceLine" id="cb743-5" data-line-number="5">oh_site_cwa &lt;-<span class="st"> </span><span class="kw">readNWISqw</span>(<span class="dt">siteNumbers=</span><span class="st">&quot;03237280&quot;</span>, </a>
<a class="sourceLine" id="cb743-6" data-line-number="6">                          <span class="dt">parameterCd=</span><span class="kw">c</span>(<span class="st">&quot;71890&quot;</span>, <span class="st">&quot;01049&quot;</span>),</a>
<a class="sourceLine" id="cb743-7" data-line-number="7">                          <span class="dt">startDate=</span><span class="st">&quot;1972-01-01&quot;</span>)</a>
<a class="sourceLine" id="cb743-8" data-line-number="8"><span class="kw">nrow</span>(oh_site_cwa)</a></code></pre></div>
<pre><code>## [1] 76</code></pre>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb745-1" data-line-number="1"><span class="kw">ncol</span>(oh_site_cwa)</a></code></pre></div>
<pre><code>## [1] 34</code></pre>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb747-1" data-line-number="1"><span class="kw">head</span>(oh_site_cwa[,<span class="kw">c</span>(<span class="st">&quot;parm_cd&quot;</span>,<span class="st">&quot;sample_dt&quot;</span>,<span class="st">&quot;result_va&quot;</span>)])</a></code></pre></div>
<pre><code>##   parm_cd  sample_dt result_va
## 1   01049 1972-06-20       0.0
## 2   01049 1973-06-21        NA
## 3   71890 1973-06-21       0.5
## 4   01049 1973-10-31        NA
## 5   71890 1973-10-31       0.5
## 6   01049 1980-03-04      10.0</code></pre>
</div>
<div id="readnwisrating" class="section level3">
<h3><span class="header-section-number">8.11.8</span> readNWISrating</h3>
<p>This function is the rating curve service function. It has a limited number of arguments and requires a site number. Follow along with the three examples below or see <code>?readNWISrating</code> for more information.</p>
<p>There are three different types of rating tables that can be accessed using the argument <code>type</code>. They are <code>base</code>, <code>corr</code> (corrected), and <code>exsa</code> (shifts). For <code>type==&quot;base&quot;</code> (the default), the result is a data frame with 3 columns: <code>INDEP</code>, <code>DEP</code>, and <code>STOR</code>. For <code>type==&quot;corr&quot;</code>, the resulting data frame will have 3 columns: <code>INDEP</code>, <code>CORR</code>, and <code>CORRINDEP</code>. For <code>type==&quot;exsa&quot;</code>, the data frame will have 4 columns: <code>INDEP</code>, <code>DEP</code>, <code>STOR</code>, and <code>SHIFT</code>. See below for definitions of each column.</p>
<ul>
<li><code>INDEP</code> is the gage height in feet</li>
<li><code>DEP</code> is the streamflow in cubic feet per second</li>
<li><code>STOR</code> &quot;*&quot; indicates a fixed point of the rating curve, <code>NA</code> for non-fixed points</li>
<li><code>SHIFT</code> indicates shifting in rating for the corresponding <code>INDEP</code> value</li>
<li><code>CORR</code> are the corrected values of <code>INDEP</code></li>
<li><code>CORRINDEP</code> are the corrected values of <code>CORR</code></li>
</ul>
<p>There are also a number of attributes associated with the data.frame returned - <code>url</code>, <code>queryTime</code>, <code>comment</code>, <code>siteInfo</code>, and <code>RATING</code>. <code>RATING</code> will only be included when <code>type</code> is <code>base</code>. See <a href="usgs-national-water-information-system-nwis.html#accessing-attributes">this section</a> for how to access attributes of <code>dataRetrieval</code> data frames.</p>
<p><a name="readnwisrating"></a></p>
<p><strong>Rating tables for Mississippi River at St. Louis, MO</strong></p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb749-1" data-line-number="1"><span class="co"># Major filter: site number, 07010000</span></a>
<a class="sourceLine" id="cb749-2" data-line-number="2"><span class="co"># Type: default, base </span></a>
<a class="sourceLine" id="cb749-3" data-line-number="3"></a>
<a class="sourceLine" id="cb749-4" data-line-number="4">miss_rating_base &lt;-<span class="st"> </span><span class="kw">readNWISrating</span>(<span class="dt">siteNumber=</span><span class="st">&quot;07010000&quot;</span>)</a>
<a class="sourceLine" id="cb749-5" data-line-number="5"><span class="kw">head</span>(miss_rating_base)</a></code></pre></div>
<pre><code>##    INDEP        DEP STOR
## 1 -10.01   31961.29    *
## 2  11.75  200384.50    *
## 3  25.00  400400.00    *
## 4  34.34  600000.00    *
## 5  45.18  919697.20    *
## 6  50.00 1100000.00    *</code></pre>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb751-1" data-line-number="1"><span class="co"># Major filter: site number, 07010000</span></a>
<a class="sourceLine" id="cb751-2" data-line-number="2"><span class="co"># Type: corr </span></a>
<a class="sourceLine" id="cb751-3" data-line-number="3"></a>
<a class="sourceLine" id="cb751-4" data-line-number="4">miss_rating_corr &lt;-<span class="st"> </span><span class="kw">readNWISrating</span>(<span class="dt">siteNumber=</span><span class="st">&quot;07010000&quot;</span>, <span class="dt">type=</span><span class="st">&quot;corr&quot;</span>)</a>
<a class="sourceLine" id="cb751-5" data-line-number="5"><span class="kw">head</span>(miss_rating_corr)</a></code></pre></div>
<pre><code>##    INDEP CORR CORRINDEP
## 1 -10.23    0    -10.23
## 2 -10.22    0    -10.22
## 3 -10.21    0    -10.21
## 4 -10.20    0    -10.20
## 5 -10.19    0    -10.19
## 6 -10.18    0    -10.18</code></pre>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb753-1" data-line-number="1"><span class="co"># Major filter: site number, 07010000</span></a>
<a class="sourceLine" id="cb753-2" data-line-number="2"><span class="co"># Type: exsa </span></a>
<a class="sourceLine" id="cb753-3" data-line-number="3"></a>
<a class="sourceLine" id="cb753-4" data-line-number="4">miss_rating_exsa &lt;-<span class="st"> </span><span class="kw">readNWISrating</span>(<span class="dt">siteNumber=</span><span class="st">&quot;07010000&quot;</span>, <span class="dt">type=</span><span class="st">&quot;exsa&quot;</span>)</a>
<a class="sourceLine" id="cb753-5" data-line-number="5"><span class="kw">head</span>(miss_rating_exsa)</a></code></pre></div>
<pre><code>##    INDEP SHIFT      DEP STOR
## 1 -10.23  0.22 31961.29 &lt;NA&gt;
## 2 -10.22  0.22 32002.44 &lt;NA&gt;
## 3 -10.21  0.22 32043.63 &lt;NA&gt;
## 4 -10.20  0.22 32084.84 &lt;NA&gt;
## 5 -10.19  0.22 32126.08 &lt;NA&gt;
## 6 -10.18  0.22 32167.35 &lt;NA&gt;</code></pre>
</div>
<div id="readnwissite" class="section level3">
<h3><span class="header-section-number">8.11.9</span> readNWISsite</h3>
<p>This function is pulls data from a USGS site file. It only has one argument - the site number. Follow along with the example below or see <code>?readNWISsite</code> for more information.</p>
<p><a name="readnwissite"></a></p>
<p><strong>Get metadata information for a site in Bronx, NY</strong></p>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb755-1" data-line-number="1"><span class="co"># site number, 01302020</span></a>
<a class="sourceLine" id="cb755-2" data-line-number="2"></a>
<a class="sourceLine" id="cb755-3" data-line-number="3"><span class="kw">readNWISsite</span>(<span class="dt">siteNumbers=</span><span class="st">&quot;01302020&quot;</span>)</a></code></pre></div>
<pre><code>##   agency_cd  site_no                                     station_nm site_tp_cd
## 1      USGS 01302020 BRONX RIVER AT NY BOTANICAL GARDEN AT BRONX NY         ST
##     lat_va  long_va dec_lat_va dec_long_va coord_meth_cd coord_acy_cd
## 1 405144.3 735227.8   40.86231   -73.87439             N            1
##   coord_datum_cd dec_coord_datum_cd district_cd state_cd county_cd country_cd
## 1          NAD83              NAD83          36       36       005         US
##   land_net_ds       map_nm map_scale_fc alt_va alt_meth_cd alt_acy_va
## 1          NA FLUSHING, NY        24000     50           M         10
##   alt_datum_cd   huc_cd basin_cd topo_cd                 instruments_cd
## 1       NAVD88 02030102     &lt;NA&gt;    &lt;NA&gt; YNNNYNNNNYNNNNNNNNNNNNNNNNNNNN
##   construction_dt inventory_dt drain_area_va contrib_drain_area_va tz_cd
## 1              NA           NA          38.4                    NA   EST
##   local_time_fg reliability_cd gw_file_cd nat_aqfr_cd aqfr_cd aqfr_type_cd
## 1             N           &lt;NA&gt;       &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;         &lt;NA&gt;
##   well_depth_va hole_depth_va depth_src_cd project_no
## 1            NA            NA         &lt;NA&gt;         NA</code></pre>
</div>
<div id="readnwisstat" class="section level3">
<h3><span class="header-section-number">8.11.10</span> readNWISstat</h3>
<p>This function is the statistics service function. It has a limited number of arguments and requires a site number and parameter code. Follow along with the example below or see <code>?readNWISstat</code> for more information.</p>
<p>The <a href="https://waterservices.usgs.gov/rest/Statistics-Service.html">NWIS Statistics web service</a> is currently in Beta mode, so use at your own discretion. Additionally, “mean” is the only <code>statType</code> that can be used for annual or monthly report types at this time.</p>
<p><a name="readnwisstat"></a></p>
<p><strong>Historic annual average discharge near Mississippi River outlet</strong></p>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb757-1" data-line-number="1"><span class="co"># Major filter: site number, 07374525</span></a>
<a class="sourceLine" id="cb757-2" data-line-number="2"><span class="co"># Parameter: discharge in cfs, 00060</span></a>
<a class="sourceLine" id="cb757-3" data-line-number="3"><span class="co"># Time division: annual</span></a>
<a class="sourceLine" id="cb757-4" data-line-number="4"><span class="co"># Statistic: average, &quot;mean&quot;</span></a>
<a class="sourceLine" id="cb757-5" data-line-number="5"></a>
<a class="sourceLine" id="cb757-6" data-line-number="6">mississippi_avgQ &lt;-<span class="st"> </span><span class="kw">readNWISstat</span>(<span class="dt">siteNumbers=</span><span class="st">&quot;07374525&quot;</span>, <span class="dt">parameterCd=</span><span class="st">&quot;00060&quot;</span>, </a>
<a class="sourceLine" id="cb757-7" data-line-number="7">                                 <span class="dt">statReportType=</span><span class="st">&quot;annual&quot;</span>, <span class="dt">statType=</span><span class="st">&quot;mean&quot;</span>)</a>
<a class="sourceLine" id="cb757-8" data-line-number="8"><span class="kw">head</span>(mississippi_avgQ)</a></code></pre></div>
<pre><code>##   agency_cd  site_no parameter_cd ts_id loc_web_ds year_nu mean_va
## 1      USGS 07374525        00060 61182         NA    2009  618800
## 2      USGS 07374525        00060 61182         NA    2010  563700
## 3      USGS 07374525        00060 61182         NA    2012  362100
## 4      USGS 07374525        00060 61182         NA    2014  489000
## 5      USGS 07374525        00060 61182         NA    2015  625800</code></pre>
</div>
<div id="readnwisuse" class="section level3">
<h3><span class="header-section-number">8.11.11</span> readNWISuse</h3>
<p>This function is the water use service function. The water use data web service requires a state and/or county as the major filter. The default will return all years and all categories available. The following table shows the water-use categories and their corresponding abbreviation for county and state data. Note that categories have changed over time, and vary by data sets requested. National and site-specific data sets exist, but only county/state data are available through this service. Please visit the <a href="https://water.usgs.gov/watuse/">USGS National Water Use Information Program website</a> for more information.</p>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<td colspan="2" style="text-align: left;">
<caption>
Table 2. Water-use category names and abbreviations.
</caption>
</td>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Name
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Abbreviation
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Aquaculture
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
AQ
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Commercial
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
CO
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Domestic
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
DO
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Hydroelectric Power
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
HY
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Irrigation, Crop
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
IC
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Irrigation, Golf Courses
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
IG
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Industrial
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
IN
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Total Irrigation
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
IT
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Livestock (Animal Specialties)
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
LA
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Livestock
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
LI
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Livestock (Stock)
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
LS
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Mining
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
MI
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Other Industrial
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
OI
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Thermoelectric Power (Closed-loop cooling)
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
PC
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Fossil-fuel Thermoelectric Power
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
PF
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Geothermal Thermoelectric Power
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
PG
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Nuclear Thermoelectric Power
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
PN
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Thermoelectric Power (Once-through cooling)
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
PO
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Public Supply
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
PS
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Total Power
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
PT
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Total Thermoelectric Power
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
PT
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
Reservoir Evaporation
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; text-align: left;">
RE
</td>
</tr>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Total Population
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
TP
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: left;">
Wastewater Treatment
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: left;">
WW
</td>
</tr>
</tbody>
</table>
<p>Follow along with the example below or see <code>?readNWISuse</code> for more information.</p>
<p><a name="readnwisuse"></a></p>
<p><strong>Las Vegas historic water use</strong></p>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb759-1" data-line-number="1"><span class="co"># Major filter: Clark County, NV</span></a>
<a class="sourceLine" id="cb759-2" data-line-number="2"><span class="co"># Water-use category: public supply, PS</span></a>
<a class="sourceLine" id="cb759-3" data-line-number="3">vegas_wu &lt;-<span class="st"> </span><span class="kw">readNWISuse</span>(<span class="dt">stateCd=</span><span class="st">&quot;NV&quot;</span>, <span class="dt">countyCd=</span><span class="st">&quot;Clark&quot;</span>, <span class="dt">categories=</span><span class="st">&quot;PS&quot;</span>)</a>
<a class="sourceLine" id="cb759-4" data-line-number="4"><span class="kw">ncol</span>(vegas_wu)</a></code></pre></div>
<pre><code>## [1] 26</code></pre>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb761-1" data-line-number="1"><span class="kw">names</span>(vegas_wu)</a></code></pre></div>
<pre><code>##  [1] &quot;state_cd&quot;                                                                
##  [2] &quot;state_name&quot;                                                              
##  [3] &quot;county_cd&quot;                                                               
##  [4] &quot;county_nm&quot;                                                               
##  [5] &quot;year&quot;                                                                    
##  [6] &quot;Public.Supply.population.served.by.groundwater..in.thousands&quot;            
##  [7] &quot;Public.Supply.population.served.by.surface.water..in.thousands&quot;          
##  [8] &quot;Public.Supply.total.population.served..in.thousands&quot;                     
##  [9] &quot;Public.Supply.self.supplied.groundwater.withdrawals..fresh..in.Mgal.d&quot;   
## [10] &quot;Public.Supply.self.supplied.groundwater.withdrawals..saline..in.Mgal.d&quot;  
## [11] &quot;Public.Supply.total.self.supplied.withdrawals..groundwater..in.Mgal.d&quot;   
## [12] &quot;Public.Supply.self.supplied.surface.water.withdrawals..fresh..in.Mgal.d&quot; 
## [13] &quot;Public.Supply.self.supplied.surface.water.withdrawals..saline..in.Mgal.d&quot;
## [14] &quot;Public.Supply.total.self.supplied.withdrawals..surface.water..in.Mgal.d&quot; 
## [15] &quot;Public.Supply.total.self.supplied.withdrawals..fresh..in.Mgal.d&quot;         
## [16] &quot;Public.Supply.total.self.supplied.withdrawals..saline..in.Mgal.d&quot;        
## [17] &quot;Public.Supply.total.self.supplied.withdrawals..total..in.Mgal.d&quot;         
## [18] &quot;Public.Supply.deliveries.to.domestic..in.Mgal.d&quot;                         
## [19] &quot;Public.Supply.deliveries.to.commercial..in.Mgal.d&quot;                       
## [20] &quot;Public.Supply.deliveries.to.industrial..in.Mgal.d&quot;                       
## [21] &quot;Public.Supply.deliveries.to.thermoelectric..in.Mgal.d&quot;                   
## [22] &quot;Public.Supply.total.deliveries..in.Mgal.d&quot;                               
## [23] &quot;Public.Supply.public.use.and.losses..in.Mgal.d&quot;                          
## [24] &quot;Public.Supply.per.capita.use..in.gallons.person.day&quot;                     
## [25] &quot;Public.Supply.reclaimed.wastewater..in.Mgal.d&quot;                           
## [26] &quot;Public.Supply.number.of.facilities&quot;</code></pre>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb763-1" data-line-number="1"><span class="kw">head</span>(vegas_wu[,<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>])</a></code></pre></div>
<pre><code>##   state_cd state_name county_cd    county_nm year
## 1       32     Nevada       003 Clark County 1985
## 2       32     Nevada       003 Clark County 1990
## 3       32     Nevada       003 Clark County 1995
## 4       32     Nevada       003 Clark County 2000
## 5       32     Nevada       003 Clark County 2005
## 6       32     Nevada       003 Clark County 2010
##   Public.Supply.population.served.by.groundwater..in.thousands
## 1                                                      149.770
## 2                                                      108.140
## 3                                                      128.010
## 4                                                      176.850
## 5                                                            -
## 6                                                            -
##   Public.Supply.population.served.by.surface.water..in.thousands
## 1                                                        402.210
## 2                                                        618.000
## 3                                                        844.060
## 4                                                       1169.600
## 5                                                              -
## 6                                                              -</code></pre>
</div>
<div id="readnwisuv" class="section level3">
<h3><span class="header-section-number">8.11.12</span> readNWISuv</h3>
<p>This function is the unit value (or instantaneous) service function. It has a limited number of arguments and requires a site number and parameter code. Follow along with the example below or see <code>?readNWISuv</code> for more information.</p>
<p><a name="readnwisuv"></a></p>
<p><strong>Turbidity and discharge for April 2016 near Lake Tahoe in California.</strong></p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb765-1" data-line-number="1"><span class="co"># Major filter: site number, 10336676</span></a>
<a class="sourceLine" id="cb765-2" data-line-number="2"><span class="co"># Parameter: discharge in cfs and turbidity in FNU, 00060 and 63680</span></a>
<a class="sourceLine" id="cb765-3" data-line-number="3"><span class="co"># Begin date: April 1, 2016</span></a>
<a class="sourceLine" id="cb765-4" data-line-number="4"><span class="co"># End date: April 30, 2016</span></a>
<a class="sourceLine" id="cb765-5" data-line-number="5"></a>
<a class="sourceLine" id="cb765-6" data-line-number="6">ca_site_do &lt;-<span class="st"> </span><span class="kw">readNWISuv</span>(<span class="dt">siteNumbers=</span><span class="st">&quot;10336676&quot;</span>, <span class="dt">parameterCd=</span><span class="kw">c</span>(<span class="st">&quot;00060&quot;</span>, <span class="st">&quot;63680&quot;</span>),</a>
<a class="sourceLine" id="cb765-7" data-line-number="7">                         <span class="dt">startDate=</span><span class="st">&quot;2016-04-01&quot;</span>, <span class="dt">endDate=</span><span class="st">&quot;2016-04-30&quot;</span>)</a>
<a class="sourceLine" id="cb765-8" data-line-number="8"><span class="kw">nrow</span>(ca_site_do)</a></code></pre></div>
<pre><code>## [1] 2880</code></pre>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb767-1" data-line-number="1"><span class="kw">head</span>(ca_site_do)</a></code></pre></div>
<pre><code>##   agency_cd  site_no            dateTime X_00060_00000 X_00060_00000_cd
## 1      USGS 10336676 2016-04-01 07:00:00          28.9                A
## 2      USGS 10336676 2016-04-01 07:15:00          28.2                A
## 3      USGS 10336676 2016-04-01 07:30:00          28.2                A
## 4      USGS 10336676 2016-04-01 07:45:00          28.9                A
## 5      USGS 10336676 2016-04-01 08:00:00          28.9                A
## 6      USGS 10336676 2016-04-01 08:15:00          28.2                A
##   X_63680_00000 X_63680_00000_cd tz_cd
## 1           1.2                A   UTC
## 2           1.3                A   UTC
## 3           1.2                A   UTC
## 4           1.1                A   UTC
## 5           1.2                A   UTC
## 6           1.3                A   UTC</code></pre>
</div>
</div>
<div id="additional-features" class="section level2">
<h2><span class="header-section-number">8.12</span> Additional Features</h2>
<div id="accessing-attributes" class="section level3">
<h3><span class="header-section-number">8.12.1</span> Accessing attributes</h3>
<p><code>dataRetrieval</code> returns a lot of useful information as “attributes” to the data returned. This includes site metadata information, the NWIS url used, date and time the query was performed, and more. First, you want to use <code>attributes()</code> to see what information is available. It returns a list of all the metadata information. Then you can use <code>attr()</code> to actually get that information. Let’s use the base rating table example from before to illustrate this. It has a special attribute called “RATING”.</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb769-1" data-line-number="1"><span class="co"># Major filter: site number, 07010000</span></a>
<a class="sourceLine" id="cb769-2" data-line-number="2"><span class="co"># Type: default, base </span></a>
<a class="sourceLine" id="cb769-3" data-line-number="3">miss_rating_base &lt;-<span class="st"> </span><span class="kw">readNWISrating</span>(<span class="dt">siteNumber=</span><span class="st">&quot;07010000&quot;</span>)</a>
<a class="sourceLine" id="cb769-4" data-line-number="4"></a>
<a class="sourceLine" id="cb769-5" data-line-number="5"><span class="co"># how many attributes are there and what are they?</span></a>
<a class="sourceLine" id="cb769-6" data-line-number="6"><span class="kw">length</span>(<span class="kw">attributes</span>(miss_rating_base))</a></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb771-1" data-line-number="1"><span class="kw">names</span>(<span class="kw">attributes</span>(miss_rating_base))</a></code></pre></div>
<pre><code>## [1] &quot;names&quot;     &quot;class&quot;     &quot;row.names&quot; &quot;comment&quot;   &quot;queryTime&quot; &quot;url&quot;      
## [7] &quot;header&quot;    &quot;RATING&quot;    &quot;siteInfo&quot;</code></pre>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb773-1" data-line-number="1"><span class="co"># look at the site info</span></a>
<a class="sourceLine" id="cb773-2" data-line-number="2"><span class="kw">attr</span>(miss_rating_base, <span class="st">&quot;siteInfo&quot;</span>)</a></code></pre></div>
<pre><code>##   agency_cd  site_no                         station_nm site_tp_cd   lat_va
## 1      USGS 07010000 Mississippi River at St. Louis, MO         ST 383744.4
##    long_va dec_lat_va dec_long_va coord_meth_cd coord_acy_cd coord_datum_cd
## 1 901047.2     38.629   -90.17978             N            5          NAD83
##   dec_coord_datum_cd district_cd state_cd county_cd country_cd
## 1              NAD83          29       29       510         US
##               land_net_ds       map_nm map_scale_fc alt_va alt_meth_cd
## 1       S   T45N  R07E  5 GRANITE CITY        24000 379.58           L
##   alt_acy_va alt_datum_cd   huc_cd basin_cd topo_cd
## 1       0.05       NAVD88 07140101     &lt;NA&gt;    &lt;NA&gt;
##                   instruments_cd construction_dt inventory_dt drain_area_va
## 1 NNNNYNNNNNNNNNNNNNNNNNNNNNNNNN              NA     19891229        697000
##   contrib_drain_area_va tz_cd local_time_fg reliability_cd gw_file_cd
## 1                    NA   CST             Y              C   NNNNNNNN
##   nat_aqfr_cd aqfr_cd aqfr_type_cd well_depth_va hole_depth_va depth_src_cd
## 1        &lt;NA&gt;    &lt;NA&gt;         &lt;NA&gt;            NA            NA         &lt;NA&gt;
##   project_no
## 1         NA</code></pre>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb775-1" data-line-number="1"><span class="co"># now look at the special RATING attribute</span></a>
<a class="sourceLine" id="cb775-2" data-line-number="2"><span class="kw">attr</span>(miss_rating_base, <span class="st">&quot;RATING&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;ID=18.0&quot;                                                    
## [2] &quot;TYPE=STGQ&quot;                                                  
## [3] &quot;NAME=stage-discharge&quot;                                       
## [4] &quot;AGING=Working&quot;                                              
## [5] &quot;REMARKS= developed for trend left of rating in the 35&#39;range&quot;
## [6] &quot;EXPANSION=logarithmic&quot;                                      
## [7] &quot;OFFSET1=-2.800000E+01&quot;</code></pre>
<p>All attributes are an R object once you extract them. They can be lists, data.frames, vectors, etc. If we want to use information from one of the attributes, index it just like you would any other object of that type. For example, we want the drainage area for this Mississippi site:</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb777-1" data-line-number="1"><span class="co"># save site info metadata as its own object</span></a>
<a class="sourceLine" id="cb777-2" data-line-number="2">miss_site_info &lt;-<span class="st"> </span><span class="kw">attr</span>(miss_rating_base, <span class="st">&quot;siteInfo&quot;</span>)</a>
<a class="sourceLine" id="cb777-3" data-line-number="3"><span class="kw">class</span>(miss_site_info)</a></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb779-1" data-line-number="1"><span class="co"># extract the drainage area</span></a>
<a class="sourceLine" id="cb779-2" data-line-number="2">miss_site_info<span class="op">$</span>drain_area_va</a></code></pre></div>
<pre><code>## [1] 697000</code></pre>
</div>
<div id="using-lists-as-input" class="section level3">
<h3><span class="header-section-number">8.12.2</span> Using lists as input</h3>
<p><code>readNWISdata</code> allows users to give a list of named arguments as the input to the call. This is especially handy if you would like to build up a list of arguments and use it in multiple calls. This only works in <code>readNWISdata</code>, none of the other <code>readNWIS...</code> functions have this ability.</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb781-1" data-line-number="1">chicago_q_args &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">siteNumbers=</span><span class="kw">c</span>(<span class="st">&quot;05537500&quot;</span>, <span class="st">&quot;05536358&quot;</span>, <span class="st">&quot;05531045&quot;</span>),</a>
<a class="sourceLine" id="cb781-2" data-line-number="2">                       <span class="dt">startDate=</span><span class="st">&quot;2015-10-01&quot;</span>,</a>
<a class="sourceLine" id="cb781-3" data-line-number="3">                       <span class="dt">endDate=</span><span class="st">&quot;2015-12-31&quot;</span>,</a>
<a class="sourceLine" id="cb781-4" data-line-number="4">                       <span class="dt">parameterCd=</span><span class="st">&quot;00060&quot;</span>)</a>
<a class="sourceLine" id="cb781-5" data-line-number="5"></a>
<a class="sourceLine" id="cb781-6" data-line-number="6"><span class="co"># query for unit value data with those arguments</span></a>
<a class="sourceLine" id="cb781-7" data-line-number="7">chicago_q_uv &lt;-<span class="st"> </span><span class="kw">readNWISdata</span>(chicago_q_args, <span class="dt">service=</span><span class="st">&quot;uv&quot;</span>)</a>
<a class="sourceLine" id="cb781-8" data-line-number="8"><span class="kw">nrow</span>(chicago_q_uv)</a></code></pre></div>
<pre><code>## [1] 14488</code></pre>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb783-1" data-line-number="1"><span class="co"># same query but for daily values</span></a>
<a class="sourceLine" id="cb783-2" data-line-number="2">chicago_q_dv &lt;-<span class="st"> </span><span class="kw">readNWISdata</span>(chicago_q_args, <span class="dt">service=</span><span class="st">&quot;dv&quot;</span>)</a>
<a class="sourceLine" id="cb783-3" data-line-number="3"><span class="kw">nrow</span>(chicago_q_dv)</a></code></pre></div>
<pre><code>## [1] 151</code></pre>
</div>
<div id="helper-functions" class="section level3">
<h3><span class="header-section-number">8.12.3</span> Helper functions</h3>
<p>There are currently 3 helper functions: renameNWIScolumns, addWaterYear, and zeroPad. <code>renameNWIScolumns</code> takes some of the default column names and makes them more human-readable (e.g. “X_00060_00000” becomes “Flow_Inst”). <code>addWaterYear</code> adds an additional column of integers indicating the water year. <code>zeroPad</code> is used to add leading zeros to any string that is missing them, and is not restricted to <code>dataRetrieval</code> output.</p>
<p><strong>renameNWIScolumns</strong></p>
<p><code>renameNWIScolumns</code> can be used in two ways: it can be a standalone function following the <code>dataRetrieval</code> call or it can be piped (as long as <code>magrittr</code> or <code>dplyr</code> are loaded). Both examples are shown below. Note that <code>renameNWIScolumns</code> is intended for use with columns named using pcodes. It does not work with all possible data returned.</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb785-1" data-line-number="1"><span class="co"># get discharge and temperature data for July 2016 in Ft Worth, TX</span></a>
<a class="sourceLine" id="cb785-2" data-line-number="2">ftworth_qt_july &lt;-<span class="st"> </span><span class="kw">readNWISuv</span>(<span class="dt">siteNumbers=</span><span class="st">&quot;08048000&quot;</span>, <span class="dt">parameterCd=</span><span class="kw">c</span>(<span class="st">&quot;00060&quot;</span>, <span class="st">&quot;00010&quot;</span>), </a>
<a class="sourceLine" id="cb785-3" data-line-number="3">                              <span class="dt">startDate=</span><span class="st">&quot;2016-07-01&quot;</span>, <span class="dt">endDate=</span><span class="st">&quot;2016-07-31&quot;</span>)</a>
<a class="sourceLine" id="cb785-4" data-line-number="4"><span class="kw">names</span>(ftworth_qt_july)</a></code></pre></div>
<pre><code>## [1] &quot;agency_cd&quot;        &quot;site_no&quot;          &quot;dateTime&quot;         &quot;X_00010_00000&quot;   
## [5] &quot;X_00010_00000_cd&quot; &quot;X_00060_00000&quot;    &quot;X_00060_00000_cd&quot; &quot;tz_cd&quot;</code></pre>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb787-1" data-line-number="1"><span class="co"># now rename columns</span></a>
<a class="sourceLine" id="cb787-2" data-line-number="2">ftworth_qt_july_renamed &lt;-<span class="st"> </span><span class="kw">renameNWISColumns</span>(ftworth_qt_july)</a>
<a class="sourceLine" id="cb787-3" data-line-number="3"><span class="kw">names</span>(ftworth_qt_july_renamed)</a></code></pre></div>
<pre><code>## [1] &quot;agency_cd&quot;     &quot;site_no&quot;       &quot;dateTime&quot;      &quot;Wtemp_Inst&quot;   
## [5] &quot;Wtemp_Inst_cd&quot; &quot;Flow_Inst&quot;     &quot;Flow_Inst_cd&quot;  &quot;tz_cd&quot;</code></pre>
<p>Now try with a pipe. Remember to load a packge that uses <code>%&gt;%</code>.</p>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb789-1" data-line-number="1"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb789-2" data-line-number="2"></a>
<a class="sourceLine" id="cb789-3" data-line-number="3"><span class="co"># get discharge and temperature data for July 2016 in Ft Worth, TX</span></a>
<a class="sourceLine" id="cb789-4" data-line-number="4"><span class="co"># pipe straight into rename function</span></a>
<a class="sourceLine" id="cb789-5" data-line-number="5">ftworth_qt_july_pipe &lt;-<span class="st"> </span><span class="kw">readNWISuv</span>(<span class="dt">siteNumbers=</span><span class="st">&quot;08048000&quot;</span>, <span class="dt">parameterCd=</span><span class="kw">c</span>(<span class="st">&quot;00060&quot;</span>, <span class="st">&quot;00010&quot;</span>), </a>
<a class="sourceLine" id="cb789-6" data-line-number="6">                                   <span class="dt">startDate=</span><span class="st">&quot;2016-07-01&quot;</span>, <span class="dt">endDate=</span><span class="st">&quot;2016-07-31&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb789-7" data-line-number="7"><span class="st">  </span><span class="kw">renameNWISColumns</span>()</a>
<a class="sourceLine" id="cb789-8" data-line-number="8"></a>
<a class="sourceLine" id="cb789-9" data-line-number="9"><span class="kw">names</span>(ftworth_qt_july_pipe)</a></code></pre></div>
<pre><code>## [1] &quot;agency_cd&quot;     &quot;site_no&quot;       &quot;dateTime&quot;      &quot;Wtemp_Inst&quot;   
## [5] &quot;Wtemp_Inst_cd&quot; &quot;Flow_Inst&quot;     &quot;Flow_Inst_cd&quot;  &quot;tz_cd&quot;</code></pre>
<p><strong>addWaterYear</strong></p>
<p>Similar to <code>renameNWIScolumns</code>, <code>addWaterYear</code> can be used as a standalone function or with a pipe. This function defines a water year as October 1 of the previous year to September 30 of the current year. Additionally, <code>addWaterYear</code> is limited to data.frames with date columns titled “dateTime”, “Date”, “ActivityStartDate”, and “ActivityEndDate”.</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb791-1" data-line-number="1"><span class="co"># mean daily discharge on the Colorado River in Grand Canyon National Park for fall of 2014</span></a>
<a class="sourceLine" id="cb791-2" data-line-number="2"><span class="co"># The dates in Sept should be water year 2014, but the dates in Oct and Nov are water year 2015</span></a>
<a class="sourceLine" id="cb791-3" data-line-number="3">co_river_q_fall &lt;-<span class="st"> </span><span class="kw">readNWISdv</span>(<span class="dt">siteNumber=</span><span class="st">&quot;09403850&quot;</span>, <span class="dt">parameterCd=</span><span class="st">&quot;00060&quot;</span>, </a>
<a class="sourceLine" id="cb791-4" data-line-number="4">                              <span class="dt">startDate=</span><span class="st">&quot;2014-09-28&quot;</span>, <span class="dt">endDate=</span><span class="st">&quot;2014-11-30&quot;</span>)</a>
<a class="sourceLine" id="cb791-5" data-line-number="5"><span class="kw">head</span>(co_river_q_fall)</a></code></pre></div>
<pre><code>##   agency_cd  site_no       Date X_00060_00003 X_00060_00003_cd
## 1      USGS 09403850 2014-09-28        319.00                A
## 2      USGS 09403850 2014-09-29        411.00                A
## 3      USGS 09403850 2014-09-30        375.00                A
## 4      USGS 09403850 2014-10-01         26.40                A
## 5      USGS 09403850 2014-10-02         10.80                A
## 6      USGS 09403850 2014-10-03          5.98                A</code></pre>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb793-1" data-line-number="1"><span class="co"># now add the water year column</span></a>
<a class="sourceLine" id="cb793-2" data-line-number="2">co_river_q_fall_wy &lt;-<span class="st"> </span><span class="kw">addWaterYear</span>(co_river_q_fall)</a>
<a class="sourceLine" id="cb793-3" data-line-number="3"><span class="kw">head</span>(co_river_q_fall_wy)</a></code></pre></div>
<pre><code>##   agency_cd  site_no       Date waterYear X_00060_00003 X_00060_00003_cd
## 1      USGS 09403850 2014-09-28      2014        319.00                A
## 2      USGS 09403850 2014-09-29      2014        411.00                A
## 3      USGS 09403850 2014-09-30      2014        375.00                A
## 4      USGS 09403850 2014-10-01      2015         26.40                A
## 5      USGS 09403850 2014-10-02      2015         10.80                A
## 6      USGS 09403850 2014-10-03      2015          5.98                A</code></pre>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb795-1" data-line-number="1"><span class="kw">unique</span>(co_river_q_fall_wy<span class="op">$</span>waterYear)</a></code></pre></div>
<pre><code>## [1] 2014 2015</code></pre>
<p>Now try with a pipe.</p>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb797-1" data-line-number="1"><span class="co"># mean daily discharge on the Colorado River in Grand Canyon National Park for fall of 2014</span></a>
<a class="sourceLine" id="cb797-2" data-line-number="2"><span class="co"># pipe straight into rename function</span></a>
<a class="sourceLine" id="cb797-3" data-line-number="3">co_river_q_fall_pipe &lt;-<span class="st"> </span><span class="kw">readNWISdv</span>(<span class="dt">siteNumber=</span><span class="st">&quot;09403850&quot;</span>, <span class="dt">parameterCd=</span><span class="st">&quot;00060&quot;</span>, </a>
<a class="sourceLine" id="cb797-4" data-line-number="4">                              <span class="dt">startDate=</span><span class="st">&quot;2014-09-01&quot;</span>, <span class="dt">endDate=</span><span class="st">&quot;2014-11-30&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb797-5" data-line-number="5"><span class="st">  </span><span class="kw">addWaterYear</span>()</a>
<a class="sourceLine" id="cb797-6" data-line-number="6"></a>
<a class="sourceLine" id="cb797-7" data-line-number="7"><span class="kw">names</span>(co_river_q_fall_pipe)</a></code></pre></div>
<pre><code>## [1] &quot;agency_cd&quot;        &quot;site_no&quot;          &quot;Date&quot;             &quot;waterYear&quot;       
## [5] &quot;X_00060_00003&quot;    &quot;X_00060_00003_cd&quot;</code></pre>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb799-1" data-line-number="1"><span class="kw">head</span>(co_river_q_fall_pipe)</a></code></pre></div>
<pre><code>##   agency_cd  site_no       Date waterYear X_00060_00003 X_00060_00003_cd
## 1      USGS 09403850 2014-09-01      2014          3.79              A e
## 2      USGS 09403850 2014-09-02      2014          3.50              A e
## 3      USGS 09403850 2014-09-03      2014          3.54              A e
## 4      USGS 09403850 2014-09-04      2014          3.63              A e
## 5      USGS 09403850 2014-09-05      2014          3.85              A e
## 6      USGS 09403850 2014-09-06      2014          3.76              A e</code></pre>
<p><strong>zeroPad</strong></p>
<p><code>zeroPad</code> is designed to work on any string, so it is not specific to <code>dataRetrieval</code> data.frame output like the previous helper functions. Oftentimes, when reading in Excel or other local data, leading zeros are dropped from site numbers. This function allows you to put them back in. <code>x</code> is the string you would like to pad, and <code>padTo</code> is the total number of characters the string should have. For instance if an 8-digit site number was read in as numeric, we could pad that by:</p>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb801-1" data-line-number="1">siteNum &lt;-<span class="st"> </span><span class="dv">02121500</span></a>
<a class="sourceLine" id="cb801-2" data-line-number="2"><span class="kw">class</span>(siteNum)</a></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb803-1" data-line-number="1">siteNum</a></code></pre></div>
<pre><code>## [1] 2121500</code></pre>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb805-1" data-line-number="1">siteNum_fix &lt;-<span class="st"> </span><span class="kw">zeroPad</span>(siteNum, <span class="dv">8</span>)</a>
<a class="sourceLine" id="cb805-2" data-line-number="2"><span class="kw">class</span>(siteNum_fix)</a></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb807-1" data-line-number="1">siteNum_fix</a></code></pre></div>
<pre><code>## [1] &quot;02121500&quot;</code></pre>
<p>The next lesson looks at how to use <code>dataRetrieval</code> functions for Water Quality Portal retrievals.</p>
</div>
</div>
<div id="readwqp-functions" class="section level2">
<h2><span class="header-section-number">8.13</span> readWQP functions</h2>
<p>After discovering Water Quality Portal (WQP) data in the <a href="/dataRetrieval-discovery">data discovery section</a>, we can now read it in using the desired parameters. There are two functions to do this in <code>dataRetrieval</code>. Table 1 describes them below.</p>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<td colspan="3" style="text-align: left;">
<caption>
Table 1. readWQP function definitions
</caption>
</td>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Function
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Description
</th>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Arguments
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
<a href="usgs-national-water-information-system-nwis.html#readwqpdata">readWQPdata</a>
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
Most general WQP data import function. Users must define each parameter.
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; text-align: left;">
…, querySummary, tz, ignore_attributes
</td>
</tr>
<tr style="background-color: #f7f7f7;">
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: left;">
<a href="usgs-national-water-information-system-nwis.html#readwqpqw">readWQPqw</a>
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: left;">
Used for querying by site numbers and parameter codes only.
</td>
<td style="padding-bottom: 0.5em; padding-right: 0.5em; padding-top: 0.5em; background-color: #f7f7f7; border-bottom: 2px solid grey; text-align: left;">
siteNumbers, parameterCd, startDate, endDate, tz, querySummary
</td>
</tr>
</tbody>
</table>

<p>The main difference between these two functions is that <code>readWQPdata</code> is general and accepts any of the paremeters described in the <a href="https://www.waterqualitydata.us/webservices_documentation/#WQPWebServicesGuide-Submitting">WQP Web Services Guide</a>. In contrast, <code>readWQPqw</code> has five arguments and users can only use this if they know the site number(s) and parameter code(s) for which they want data.</p>
<p>The following are examples of how to use each of the readWQP family of functions. Don’t forget to load the <code>dataRetrieval</code> library if you are in a new session.</p>
<ol style="list-style-type: decimal">
<li><a href="#readwqpdata-state">readWQPdata, state, site type, and characteristic name</a></li>
<li><a href="#readwqpdata-county">readWQPdata, county and characteristic group</a></li>
<li><a href="#readwqpdata-bbox">readWQPdata, bbox, characteristic name, and start date</a></li>
<li><a href="usgs-national-water-information-system-nwis.html#readwqpqw">readWQPqw</a></li>
</ol>
<div id="readwqpdata" class="section level3">
<h3><span class="header-section-number">8.13.1</span> readWQPdata</h3>
<p>The generic function used to pull Water Quality Portal data. This function is very flexible. You can specify any of the parameters from the <a href="https://www.waterqualitydata.us/webservices_documentation/#WQPWebServicesGuide-Submitting">WQP Web Service Guide</a>. To learn what the possible values for each, see the <a href="https://www.waterqualitydata.us/webservices_documentation/#WQPWebServicesGuide-Domain">table of domain values</a>. Follow along with the three examples below or see <code>?readWQPdata</code> for more information.</p>
<p><a name="readwqpdata-state"></a></p>
<p><strong>Phosphorus data in Wisconsin lakes for water year 2010</strong></p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb809-1" data-line-number="1"><span class="co"># This takes about 3 minutes to complete.</span></a>
<a class="sourceLine" id="cb809-2" data-line-number="2">WI_lake_phosphorus_<span class="dv">2010</span> &lt;-<span class="st"> </span><span class="kw">readWQPdata</span>(<span class="dt">statecode=</span><span class="st">&quot;WI&quot;</span>, </a>
<a class="sourceLine" id="cb809-3" data-line-number="3">                                       <span class="dt">siteType=</span><span class="st">&quot;Lake, Reservoir, Impoundment&quot;</span>, </a>
<a class="sourceLine" id="cb809-4" data-line-number="4">                                       <span class="dt">characteristicName=</span><span class="st">&quot;Phosphorus&quot;</span>, </a>
<a class="sourceLine" id="cb809-5" data-line-number="5">                                       <span class="dt">startDate=</span><span class="st">&quot;2009-10-01&quot;</span>, <span class="dt">endDate=</span><span class="st">&quot;2010-09-30&quot;</span>)</a>
<a class="sourceLine" id="cb809-6" data-line-number="6"></a>
<a class="sourceLine" id="cb809-7" data-line-number="7"><span class="co"># What columns are available?</span></a>
<a class="sourceLine" id="cb809-8" data-line-number="8"><span class="kw">names</span>(WI_lake_phosphorus_<span class="dv">2010</span>)</a></code></pre></div>
<pre><code>##  [1] &quot;OrganizationIdentifier&quot;                           
##  [2] &quot;OrganizationFormalName&quot;                           
##  [3] &quot;ActivityIdentifier&quot;                               
##  [4] &quot;ActivityTypeCode&quot;                                 
##  [5] &quot;ActivityMediaName&quot;                                
##  [6] &quot;ActivityMediaSubdivisionName&quot;                     
##  [7] &quot;ActivityStartDate&quot;                                
##  [8] &quot;ActivityStartTime.Time&quot;                           
##  [9] &quot;ActivityStartTime.TimeZoneCode&quot;                   
## [10] &quot;ActivityEndDate&quot;                                  
## [11] &quot;ActivityEndTime.Time&quot;                             
## [12] &quot;ActivityEndTime.TimeZoneCode&quot;                     
## [13] &quot;ActivityDepthHeightMeasure.MeasureValue&quot;          
## [14] &quot;ActivityDepthHeightMeasure.MeasureUnitCode&quot;       
## [15] &quot;ActivityDepthAltitudeReferencePointText&quot;          
## [16] &quot;ActivityTopDepthHeightMeasure.MeasureValue&quot;       
## [17] &quot;ActivityTopDepthHeightMeasure.MeasureUnitCode&quot;    
## [18] &quot;ActivityBottomDepthHeightMeasure.MeasureValue&quot;    
## [19] &quot;ActivityBottomDepthHeightMeasure.MeasureUnitCode&quot; 
## [20] &quot;ProjectIdentifier&quot;                                
## [21] &quot;ActivityConductingOrganizationText&quot;               
## [22] &quot;MonitoringLocationIdentifier&quot;                     
## [23] &quot;ActivityCommentText&quot;                              
## [24] &quot;SampleAquifer&quot;                                    
## [25] &quot;HydrologicCondition&quot;                              
## [26] &quot;HydrologicEvent&quot;                                  
## [27] &quot;SampleCollectionMethod.MethodIdentifier&quot;          
## [28] &quot;SampleCollectionMethod.MethodIdentifierContext&quot;   
## [29] &quot;SampleCollectionMethod.MethodName&quot;                
## [30] &quot;SampleCollectionEquipmentName&quot;                    
## [31] &quot;ResultDetectionConditionText&quot;                     
## [32] &quot;CharacteristicName&quot;                               
## [33] &quot;ResultSampleFractionText&quot;                         
## [34] &quot;ResultMeasureValue&quot;                               
## [35] &quot;ResultMeasure.MeasureUnitCode&quot;                    
## [36] &quot;MeasureQualifierCode&quot;                             
## [37] &quot;ResultStatusIdentifier&quot;                           
## [38] &quot;StatisticalBaseCode&quot;                              
## [39] &quot;ResultValueTypeName&quot;                              
## [40] &quot;ResultWeightBasisText&quot;                            
## [41] &quot;ResultTimeBasisText&quot;                              
## [42] &quot;ResultTemperatureBasisText&quot;                       
## [43] &quot;ResultParticleSizeBasisText&quot;                      
## [44] &quot;PrecisionValue&quot;                                   
## [45] &quot;ResultCommentText&quot;                                
## [46] &quot;USGSPCode&quot;                                        
## [47] &quot;ResultDepthHeightMeasure.MeasureValue&quot;            
## [48] &quot;ResultDepthHeightMeasure.MeasureUnitCode&quot;         
## [49] &quot;ResultDepthAltitudeReferencePointText&quot;            
## [50] &quot;SubjectTaxonomicName&quot;                             
## [51] &quot;SampleTissueAnatomyName&quot;                          
## [52] &quot;ResultAnalyticalMethod.MethodIdentifier&quot;          
## [53] &quot;ResultAnalyticalMethod.MethodIdentifierContext&quot;   
## [54] &quot;ResultAnalyticalMethod.MethodName&quot;                
## [55] &quot;MethodDescriptionText&quot;                            
## [56] &quot;LaboratoryName&quot;                                   
## [57] &quot;AnalysisStartDate&quot;                                
## [58] &quot;ResultLaboratoryCommentText&quot;                      
## [59] &quot;DetectionQuantitationLimitTypeName&quot;               
## [60] &quot;DetectionQuantitationLimitMeasure.MeasureValue&quot;   
## [61] &quot;DetectionQuantitationLimitMeasure.MeasureUnitCode&quot;
## [62] &quot;PreparationStartDate&quot;                             
## [63] &quot;ProviderName&quot;                                     
## [64] &quot;ActivityStartDateTime&quot;                            
## [65] &quot;ActivityEndDateTime&quot;</code></pre>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb811-1" data-line-number="1"><span class="co">#How much data is returned?</span></a>
<a class="sourceLine" id="cb811-2" data-line-number="2"><span class="kw">nrow</span>(WI_lake_phosphorus_<span class="dv">2010</span>)</a></code></pre></div>
<pre><code>## [1] 3264</code></pre>
<p><a name="readwqpdata-county"></a></p>
<p><strong>All nutrient data in Napa County, California</strong></p>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb813-1" data-line-number="1"><span class="co"># Use empty character strings to specify that you want the historic record.</span></a>
<a class="sourceLine" id="cb813-2" data-line-number="2"><span class="co"># This takes about 3 minutes to run.</span></a>
<a class="sourceLine" id="cb813-3" data-line-number="3">Napa_lake_nutrients_Aug2010 &lt;-<span class="st"> </span><span class="kw">readWQPdata</span>(<span class="dt">statecode=</span><span class="st">&quot;CA&quot;</span>, <span class="dt">countycode=</span><span class="st">&quot;055&quot;</span>, </a>
<a class="sourceLine" id="cb813-4" data-line-number="4">                                           <span class="dt">characteristicType=</span><span class="st">&quot;Nutrient&quot;</span>)</a>
<a class="sourceLine" id="cb813-5" data-line-number="5"></a>
<a class="sourceLine" id="cb813-6" data-line-number="6"><span class="co">#How much data is returned?</span></a>
<a class="sourceLine" id="cb813-7" data-line-number="7"><span class="kw">nrow</span>(Napa_lake_nutrients_Aug2010)</a></code></pre></div>
<pre><code>## [1] 4835</code></pre>
<p><a name="readwqpdata-bbox"></a></p>
<p><strong>Everglades water temperature data since 2016</strong></p>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb815-1" data-line-number="1"><span class="co"># Bounding box defined by a vector of Western-most longitude, Southern-most latitude, </span></a>
<a class="sourceLine" id="cb815-2" data-line-number="2"><span class="co"># Eastern-most longitude, and Northern-most longitude.</span></a>
<a class="sourceLine" id="cb815-3" data-line-number="3"><span class="co"># This takes about 3 minutes to run.</span></a>
<a class="sourceLine" id="cb815-4" data-line-number="4">Everglades_temp_<span class="dv">2016</span>_present &lt;-<span class="st"> </span><span class="kw">readWQPdata</span>(<span class="dt">bBox=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">81.70</span>, <span class="fl">25.08</span>, <span class="fl">-80.30</span>, <span class="fl">26.51</span>),  </a>
<a class="sourceLine" id="cb815-5" data-line-number="5">                                            <span class="dt">characteristicName=</span><span class="st">&quot;Temperature, water&quot;</span>,</a>
<a class="sourceLine" id="cb815-6" data-line-number="6">                                            <span class="dt">startDate=</span><span class="st">&quot;2016-01-01&quot;</span>)</a>
<a class="sourceLine" id="cb815-7" data-line-number="7"></a>
<a class="sourceLine" id="cb815-8" data-line-number="8"><span class="co">#How much data is returned?</span></a>
<a class="sourceLine" id="cb815-9" data-line-number="9"><span class="kw">nrow</span>(Everglades_temp_<span class="dv">2016</span>_present)</a></code></pre></div>
<pre><code>## [1] 14507</code></pre>
</div>
<div id="readwqpqw" class="section level3">
<h3><span class="header-section-number">8.13.2</span> readWQPqw</h3>
<p>This function has a limited number of arguments - it can only be used for pulling WQP data by site number and parameter code. By default, dates are set to pull the entire record available. When specifying USGS sites as <code>siteNumbers</code> to <code>readWQP</code> functions, precede the number with “USGS-”. See the example below or <code>?readWQPqw</code> for more information.</p>
<p><a name="readwqpqw"></a></p>
<p><strong>Dissolved oxygen data since 2010 for 2 South Carolina USGS sites</strong></p>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb817-1" data-line-number="1"><span class="co"># Using a few USGS sites, get dissolved oxygen data</span></a>
<a class="sourceLine" id="cb817-2" data-line-number="2"><span class="co"># This takes ~ 30 seconds to complete.</span></a>
<a class="sourceLine" id="cb817-3" data-line-number="3">SC_do_data_since2010 &lt;-<span class="st"> </span><span class="kw">readWQPqw</span>(<span class="dt">siteNumbers =</span> <span class="kw">c</span>(<span class="st">&quot;USGS-02146110&quot;</span>, <span class="st">&quot;USGS-325427080014600&quot;</span>),</a>
<a class="sourceLine" id="cb817-4" data-line-number="4">                                  <span class="dt">parameterCd =</span> <span class="st">&quot;00300&quot;</span>, <span class="dt">startDate =</span> <span class="st">&quot;2010-01-01&quot;</span>)</a>
<a class="sourceLine" id="cb817-5" data-line-number="5"></a>
<a class="sourceLine" id="cb817-6" data-line-number="6"><span class="co"># How much data was returned?</span></a>
<a class="sourceLine" id="cb817-7" data-line-number="7"><span class="kw">nrow</span>(SC_do_data_since2010)</a></code></pre></div>
<pre><code>## [1] 20</code></pre>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb819-1" data-line-number="1"><span class="co"># What are the DO values and the dates the sample was collected?</span></a>
<a class="sourceLine" id="cb819-2" data-line-number="2"><span class="kw">head</span>(SC_do_data_since2010[, <span class="kw">c</span>(<span class="st">&quot;ResultMeasureValue&quot;</span>, <span class="st">&quot;ActivityStartDate&quot;</span>)])</a></code></pre></div>
<pre><code>##   ResultMeasureValue ActivityStartDate
## 1                5.0        2011-09-06
## 2                5.9        2010-04-08
## 3                6.3        2011-06-15
## 4                6.8        2014-08-13
## 5                7.2        2011-03-09
## 6                7.2        2014-05-13</code></pre>
</div>
</div>
<div id="attributes-and-metadata" class="section level2">
<h2><span class="header-section-number">8.14</span> Attributes and metadata</h2>
<p>Similar to the data frames returned from <code>readNWIS</code> functions, there are attributes (aka metadata) attached to the data. Use <code>attributes</code> to see all of them and <code>attr</code> to extract a particular attribute.</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb821-1" data-line-number="1"><span class="co"># What are the attributes available?</span></a>
<a class="sourceLine" id="cb821-2" data-line-number="2">wqp_attributes &lt;-<span class="st"> </span><span class="kw">attributes</span>(Everglades_temp_<span class="dv">2016</span>_present)</a>
<a class="sourceLine" id="cb821-3" data-line-number="3"><span class="kw">names</span>(wqp_attributes)</a></code></pre></div>
<pre><code>## [1] &quot;names&quot;        &quot;class&quot;        &quot;row.names&quot;    &quot;siteInfo&quot;     &quot;variableInfo&quot;
## [6] &quot;url&quot;          &quot;queryTime&quot;</code></pre>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb823-1" data-line-number="1"><span class="co"># Look at the variableInfo attribute</span></a>
<a class="sourceLine" id="cb823-2" data-line-number="2"><span class="kw">head</span>(<span class="kw">attr</span>(Everglades_temp_<span class="dv">2016</span>_present, <span class="st">&quot;variableInfo&quot;</span>))</a></code></pre></div>
<pre><code>##   characteristicName parameterCd param_units valueType
## 1 Temperature, water       00010       deg C      &lt;NA&gt;
## 2 Temperature, water        &lt;NA&gt;       deg C      &lt;NA&gt;
## 3 Temperature, water        &lt;NA&gt;       deg C      &lt;NA&gt;
## 4 Temperature, water        &lt;NA&gt;       deg C      &lt;NA&gt;
## 5 Temperature, water        &lt;NA&gt;       deg C      &lt;NA&gt;
## 6 Temperature, water        &lt;NA&gt;       deg C      &lt;NA&gt;</code></pre>
<p>Let’s make a quick map to look at the stations that collected the Everglades data:</p>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb825-1" data-line-number="1">siteInfo &lt;-<span class="st"> </span><span class="kw">attr</span>(Everglades_temp_<span class="dv">2016</span>_present, <span class="st">&quot;siteInfo&quot;</span>)</a>
<a class="sourceLine" id="cb825-2" data-line-number="2"></a>
<a class="sourceLine" id="cb825-3" data-line-number="3"><span class="kw">library</span>(maps)</a>
<a class="sourceLine" id="cb825-4" data-line-number="4"><span class="kw">map</span>(<span class="st">&#39;state&#39;</span>, <span class="dt">regions=</span><span class="st">&#39;florida&#39;</span>)</a>
<a class="sourceLine" id="cb825-5" data-line-number="5"><span class="kw">title</span>(<span class="dt">main=</span><span class="st">&quot;Everglade Sites&quot;</span>)</a>
<a class="sourceLine" id="cb825-6" data-line-number="6"><span class="kw">points</span>(<span class="dt">x=</span>siteInfo<span class="op">$</span>dec_lon_va, </a>
<a class="sourceLine" id="cb825-7" data-line-number="7">       <span class="dt">y=</span>siteInfo<span class="op">$</span>dec_lat_va)</a>
<a class="sourceLine" id="cb825-8" data-line-number="8"><span class="co"># Add a rectangle to see where your original query bounding box in relation to sites</span></a>
<a class="sourceLine" id="cb825-9" data-line-number="9"><span class="kw">rect</span>(<span class="op">-</span><span class="fl">81.70</span>, <span class="fl">25.08</span>, <span class="fl">-80.30</span>, <span class="fl">26.51</span>, <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">border =</span> <span class="st">&#39;red&#39;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-8"></span>
<img src="08-USGS_files/figure-html/unnamed-chunk-8-1.png" alt="A map of NWIS site locations in the Everglades" width="672" />
<p class="caption">
Figure 8.1: A map of NWIS site locations in the Everglades
</p>
</div>
<p>You can now find and download Water Quality Portal data from R!</p>
</div>
<div id="usgs-coding-lab-exercises" class="section level2">
<h2><span class="header-section-number">8.15</span> USGS COding Lab Exercises</h2>
<p><strong>1:</strong></p>
<p><em>Determine the number of sites in Arizona that have lake temperature data available in NWIS. Then find how many Arizona sites have lake temperature data available in WQP.</em></p>
<p>Helpful links: <a href="usgs-packages/dataRetrieval-discovery/#whatnwisdata"><code>whatNWISdata</code></a>, <a href="usgs-packages/dataRetrieval-discovery/#whatwqpsites"><code>whatWQPsites</code></a>, <a href="usgs-packages/dataRetrieval-discovery/#readwqpdata-querysummary"><code>readWQPdata</code></a></p>
<p><strong>2:</strong></p>
</div>
<div id="geoknife---introduction" class="section level2">
<h2><span class="header-section-number">8.16</span> geoKnife - Introduction</h2>
</div>
<div id="lesson-summary-1" class="section level2">
<h2><span class="header-section-number">8.17</span> Lesson Summary</h2>
<p>This lesson will explore how to find and download large gridded datasets via the R package <code>geoknife</code>. The package was created to allow easy access to data stored in the <a href="https://cida.usgs.gov/gdp/">Geo Data Portal (GDP)</a>, or any gridded dataset available through the <a href="https://www.opendap.org/">OPeNDAP</a> protocol DAP2. <code>geoknife</code> refers to the gridded dataset as the <code>fabric</code>, the spatial feature of interest as the <code>stencil</code>, and the subset algorithm parameters as the <code>knife</code> (see below).</p>
<div class="figure">
<img src="../static/img/geoknife_summary.png#inline-img" title="geoknife terminology figure" alt="figure illustrating definitions of fabric, stencil, and knife" />
<p class="caption">figure illustrating definitions of fabric, stencil, and knife</p>
</div>
</div>
<div id="lesson-objectives-1" class="section level2">
<h2><span class="header-section-number">8.18</span> Lesson Objectives</h2>
<p>Explore and query large gridded datasets for efficient and reproducible large-scale analyses.</p>
<p>By the end of this lesson, the learner will be able to:</p>
<ol style="list-style-type: decimal">
<li>Explain the differences between remote and local processing.</li>
<li>Differentiate the three main concepts of this package: fabric, stencil, and knife.</li>
<li>Use this package to retrieve pre-processed data from the Geo Data Portal (GDP) via geoknife.</li>
</ol>
</div>
<div id="lesson-resources-1" class="section level2">
<h2><span class="header-section-number">8.19</span> Lesson Resources</h2>
<ul>
<li>Publication: <a href="http://onlinelibrary.wiley.com/doi/10.1111/ecog.01880/abstract">geoknife: reproducible web-processing of large gridded datasets</a></li>
<li>Tutorial (vignette): <a href="https://cran.r-project.org/web/packages/geoknife/vignettes/geoknife.html">geoknife vignette</a></li>
<li>Source code: <a href="https://github.com/USGS-R/geoknife">geoknife on GitHub</a></li>
<li>Report a bug or suggest a feature: <a href="https://github.com/USGS-R/geoknife/issues">geoknife issues on GitHub</a></li>
</ul>
</div>
<div id="remote-processing" class="section level2">
<h2><span class="header-section-number">8.20</span> Remote processing</h2>
<p>The USGS Geo Data Portal is designed to perform web-service processing on large gridded datasets. <code>geoknife</code> allows R users to take advantage of these services by processing large data, such as data available in the GDP catalog or a user-defined dataset, on the web. This type of workflow has three main advantages:</p>
<ol style="list-style-type: decimal">
<li>it allows the user to avoid downloading large datasets,</li>
<li>it avoids reinventing the wheel for the creation and optimization of complex geoprocessing algorithms, and</li>
<li>computing resources are dedicated elsewhere, so geoknife operations do not have much of an impact on a local computer.</li>
</ol>
</div>
<div id="geoknife-components-fabric-stencil-knife" class="section level2">
<h2><span class="header-section-number">8.21</span> geoknife components: fabric, stencil, knife</h2>
<p>The main components of a geoknife workflow are the fabric, stencil, and knife. These three components go into the final element, the geoknife “job” (geojob), which returns the processed data. The fabric is the gridded web dataset to be processed, the stencil is the feature of interest, and the knife is the processing algorithm parameters. Each of the <code>geoknife</code> components is created using a corresponding function: fabrics are created using <code>webdata()</code>, stencils are created using <code>webgeom()</code>, and knives are created using <code>webprocess()</code>.</p>
<p>This lesson will focus on discovering what options exist for each of those components. The next lesson will teach you how to construct each component and put it together to get the processed data. Before continuing this lesson, load the geoknife library (install if necessary).</p>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb826-1" data-line-number="1"><span class="co"># load the geoknife package</span></a>
<a class="sourceLine" id="cb826-2" data-line-number="2"><span class="kw">library</span>(geoknife)</a></code></pre></div>
<pre><code>## Warning: package &#39;geoknife&#39; was built under R version 3.6.2</code></pre>
<pre><code>## 
## Attaching package: &#39;geoknife&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     id</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     start</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     title</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     url</code></pre>
</div>
<div id="available-webdata" class="section level2">
<h2><span class="header-section-number">8.22</span> Available webdata</h2>
<div id="gdp-datasets" class="section level3">
<h3><span class="header-section-number">8.22.1</span> GDP datasets</h3>
<p>To learn what data is available through GDP, you can explore the <a href="https://cida.usgs.gov/gdp/">online catalog</a> or use the function <code>query</code>. Note that the access pattern for determining available fabrics differs slightly from stencils and knives. Running <code>query(&quot;webdata&quot;)</code> will return every dataset available through GDP:</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb833-1" data-line-number="1">all_webdata &lt;-<span class="st"> </span><span class="kw">query</span>(<span class="st">&quot;webdata&quot;</span>)</a>
<a class="sourceLine" id="cb833-2" data-line-number="2"><span class="kw">head</span>(all_webdata)</a></code></pre></div>
<pre><code>## An object of class &quot;datagroup&quot;:
## [1] 4km Monthly Parameter-elevation Regressions on Independent Slopes Model Monthly Climate Data for the Continental United States. August 2018 Snapshot 
##   url: https://cida.usgs.gov/thredds/dodsC/prism_v2 
## [2] 4km Monthly Parameter-elevation Regressions on Independent Slopes Model Monthly Climate Data for the Continental United States. January 2012 Shapshot 
##   url: https://cida.usgs.gov/thredds/dodsC/prism 
## [3] ACCESS 1980-1999 
##   url: https://cida.usgs.gov/thredds/dodsC/notaro_ACCESS_1980_1999 
## [4] ACCESS 2040-2059 
##   url: https://cida.usgs.gov/thredds/dodsC/notaro_ACCESS_2040_2059 
## [5] ACCESS 2080-2099 
##   url: https://cida.usgs.gov/thredds/dodsC/notaro_ACCESS_2080_2099 
## [6] Bias Corrected Constructed Analogs V2 Daily Future CMIP5 Climate Projections 
##   url: https://cida.usgs.gov/thredds/dodsC/cmip5_bcca/future</code></pre>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb835-1" data-line-number="1"><span class="kw">length</span>(all_webdata)</a></code></pre></div>
<pre><code>## [1] 532</code></pre>
<p>Notice that the object returned is a special <code>geoknife</code> class of <code>datagroup</code>. There are specific <code>geoknife</code> functions that only operate on an object of this class, see <code>?title</code> and <code>?abstract</code>. These two functions are used to extract metadata information about each of the available GDP datasets. With 532 datasets available, it is likely that reading through each to find ones that are of interest to you would be time consuming. You can use <code>grep</code> along with the functions <code>title</code> and <code>abstract</code> to figure out which datasets you would like to use for processing.</p>
<p>Let’s say that we were interested in evapotranspiration data. To search for which GDP datasets might contain evapotranspiration data, you can use the titles and abstracts.</p>
<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb837-1" data-line-number="1"><span class="co"># notice that you cannot perform a grep on all_webdata - it is because it is a special class</span></a>
<a class="sourceLine" id="cb837-2" data-line-number="2"><span class="co"># `grep(&quot;evapotranspiration&quot;, all_webdata)` will fail</span></a>
<a class="sourceLine" id="cb837-3" data-line-number="3"><span class="co"># you need to perform pattern matching on vectors</span></a>
<a class="sourceLine" id="cb837-4" data-line-number="4"></a>
<a class="sourceLine" id="cb837-5" data-line-number="5">all_titles &lt;-<span class="st"> </span><span class="kw">title</span>(all_webdata)</a>
<a class="sourceLine" id="cb837-6" data-line-number="6">which_titles &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;evapotranspiration&quot;</span>, all_titles)</a>
<a class="sourceLine" id="cb837-7" data-line-number="7">evap_titles &lt;-<span class="st"> </span>all_titles[which_titles]</a>
<a class="sourceLine" id="cb837-8" data-line-number="8"><span class="kw">head</span>(evap_titles)</a></code></pre></div>
<pre><code>## [1] &quot;Monthly Conterminous U.S. actual evapotranspiration data&quot;
## [2] &quot;Yearly Conterminous U.S. actual evapotranspiration data&quot;</code></pre>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb839-1" data-line-number="1">all_abstracts &lt;-<span class="st"> </span><span class="kw">abstract</span>(all_webdata)</a>
<a class="sourceLine" id="cb839-2" data-line-number="2">which_abstracts &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="st">&quot;evapotranspiration&quot;</span>, all_abstracts)</a>
<a class="sourceLine" id="cb839-3" data-line-number="3">evap_abstracts &lt;-<span class="st"> </span>all_abstracts[which_abstracts]</a>
<a class="sourceLine" id="cb839-4" data-line-number="4">evap_abstracts[<span class="dv">1</span>]</a></code></pre></div>
<pre><code>## [1] &quot;Reference evapotranspiration (ET0), like potential evapotranspiration, is a measure of  atmospheric evaporative demand. It was used in the context of this study to evaluate drought  conditions that can lead to wildfire activity in Alaska using the Evaporative Demand Drought  Index (EDDI) and the Standardized Precipitation Evapotranspiration Index (SPEI). The ET0 data are  on a 20km grid with daily temporal resolution and were computed using the meteorological inputs  from the dynamically downscaled ERA-Interim reanalysis and two global climate model projections  (CCSM4 and GFDL-CM3). The model projections are from CMIP5 and use the RCP8.5 scenario. The  dynamically downscaled data are available at https://registry.opendata.aws/wrf-alaska-snap/.  The ET0 was computed following the American Society of Civil Engineers Standardized Reference  Evapotranspiration Equation based on the downscaled daily temperature, humidity and winds. The  full details of the computation of ET0, an evaluation of the underlying data, and the assessment  of the fire indices are described in Ziel et al. (2020; https://doi.org/10.3390/f11050516).&quot;</code></pre>
<p>13 possible datasets to look through is a lot more manageable than 532. Let’s say the dataset titled “Yearly Conterminous U.S. actual evapotranspiration data” interested us enough to explore more. We have now identified a fabric of interest.</p>
<p>We might want to know more about the dataset, such as what variables and time periods are available. To actually create the fabric, you will need to use <code>webdata</code> and supply the appropriate datagroup object as the input. This should result in an object with a class of <code>webdata</code>. The following functions will operate only on an object of class <code>webdata</code>.</p>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb841-1" data-line-number="1">evap_fabric &lt;-<span class="st"> </span><span class="kw">webdata</span>(all_webdata[<span class="st">&quot;Yearly Conterminous U.S. actual evapotranspiration data&quot;</span>])</a>
<a class="sourceLine" id="cb841-2" data-line-number="2"><span class="kw">class</span>(evap_fabric)</a></code></pre></div>
<pre><code>## [1] &quot;webdata&quot;
## attr(,&quot;package&quot;)
## [1] &quot;geoknife&quot;</code></pre>
<p>Now that we have a defined fabric, we can explore what variables and time period are within that data. First, we use <code>query</code> to determine what variables exist. You’ll notice that the function <code>variable</code> returns NA. This is fine when you are just exploring available data; however, exploring available times requires that the variable be defined. Thus, we need to set which variable from the dataset will be used. Then, we can explore times that are available in the data.</p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb843-1" data-line-number="1"><span class="co"># no variables defined yet</span></a>
<a class="sourceLine" id="cb843-2" data-line-number="2"><span class="kw">variables</span>(evap_fabric)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb845-1" data-line-number="1"><span class="co"># find what variables are available</span></a>
<a class="sourceLine" id="cb845-2" data-line-number="2"><span class="kw">query</span>(evap_fabric, <span class="st">&quot;variables&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;et&quot;</code></pre>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb847-1" data-line-number="1"><span class="co"># trying to find available times before setting the variable results in an error</span></a>
<a class="sourceLine" id="cb847-2" data-line-number="2"><span class="co"># `query(evap_fabric, &quot;times&quot;)` will fail</span></a>
<a class="sourceLine" id="cb847-3" data-line-number="3"></a>
<a class="sourceLine" id="cb847-4" data-line-number="4"><span class="co"># only one variable, &quot;et&quot;</span></a>
<a class="sourceLine" id="cb847-5" data-line-number="5"><span class="kw">variables</span>(evap_fabric) &lt;-<span class="st"> &quot;et&quot;</span></a>
<a class="sourceLine" id="cb847-6" data-line-number="6"><span class="kw">variables</span>(evap_fabric)</a></code></pre></div>
<pre><code>## [1] &quot;et&quot;</code></pre>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb849-1" data-line-number="1"><span class="co"># now that the variable is set, we can explore available times</span></a>
<a class="sourceLine" id="cb849-2" data-line-number="2"><span class="kw">query</span>(evap_fabric, <span class="st">&quot;times&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;2000-01-01 UTC&quot; &quot;2018-01-01 UTC&quot;</code></pre>
</div>
<div id="datasets-not-in-gdp" class="section level3">
<h3><span class="header-section-number">8.22.2</span> Datasets not in GDP</h3>
<p>Any gridded dataset available online that follows OPeNDAP protocol and some additional conventions can be used with <code>geoknife</code>. These datasets can be found through web searches or other catalogs and require finding out the OPeNDAP endpoint (URL) for the dataset. This url is used as the input to the argument <code>url</code> in <code>webdata</code>. Please see the <a href="https://my.usgs.gov/confluence/display/GeoDataPortal/Custom+Dataset+Use+Guidlines">Custom Dataset Use Guidelines documentation</a> for more information about compatibility, or contact the GDP development team (<a href="mailto:gdp@usgs.gov" class="email">gdp@usgs.gov</a>).</p>
<p>We searched <a href="https://opendap.co-ops.nos.noaa.gov/">NOAA’s OPenDAP data catalog</a> and found this data from the Center for Operational Oceanographic Products and Services THREDDS server. It includes forecasts for water levels, water currents, water temperatures, and salinity levels for Delaware Bay. Since it is forecast data, the times associated with the data will change. To create a webdata object from this dataset, just use the OPeNDAP url. Then query variables and time as we did before.</p>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb851-1" data-line-number="1">DelBay_fabric &lt;-<span class="st"> </span><span class="kw">webdata</span>(<span class="dt">url=</span><span class="st">&quot;http://opendap.co-ops.nos.noaa.gov/thredds/dodsC/DBOFS/fmrc/Aggregated_7_day_DBOFS_Fields_Forecast_best.ncd&quot;</span>)</a>
<a class="sourceLine" id="cb851-2" data-line-number="2"><span class="kw">query</span>(DelBay_fabric, <span class="st">&quot;variables&quot;</span>)</a></code></pre></div>
<pre><code>## character(0)</code></pre>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb853-1" data-line-number="1"><span class="co"># need to set the variable(s) in order to query the times</span></a>
<a class="sourceLine" id="cb853-2" data-line-number="2"><span class="kw">variables</span>(DelBay_fabric) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Vwind&quot;</span>, <span class="st">&quot;temp&quot;</span>)</a>
<a class="sourceLine" id="cb853-3" data-line-number="3"><span class="kw">query</span>(DelBay_fabric, <span class="st">&quot;times&quot;</span>)</a></code></pre></div>
<pre><code>## [1] NA NA</code></pre>
<p>Here is a second example of using a non-GDP dataset. This data was found under the <a href="http://www.unidata.ucar.edu/data/#home">data section on Unidata’s website</a>. This is aggregated satellite data from the UNIWISC (Unidata-Wisconsin) datastream for Earth’s “surface skin” temperature.</p>
<div class="sourceCode" id="cb855"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb855-1" data-line-number="1">skinT_fabric &lt;-<span class="st"> </span><span class="kw">webdata</span>(<span class="dt">url=</span><span class="st">&quot;http://thredds.ucar.edu/thredds/dodsC/satellite/SFC-T/SUPER-NATIONAL_1km&quot;</span>)</a>
<a class="sourceLine" id="cb855-2" data-line-number="2">skinT_var &lt;-<span class="st"> </span><span class="kw">query</span>(skinT_fabric, <span class="st">&quot;variables&quot;</span>)</a>
<a class="sourceLine" id="cb855-3" data-line-number="3"></a>
<a class="sourceLine" id="cb855-4" data-line-number="4"><span class="co"># need to set the variable(s) in order to query the times</span></a>
<a class="sourceLine" id="cb855-5" data-line-number="5"><span class="kw">variables</span>(skinT_fabric) &lt;-<span class="st"> </span>skinT_var</a>
<a class="sourceLine" id="cb855-6" data-line-number="6"><span class="kw">query</span>(skinT_fabric, <span class="st">&quot;times&quot;</span>) <span class="co"># your times might be different because this is forecast data</span></a></code></pre></div>
<pre><code>## [1] NA NA</code></pre>
<p>Both examples we’ve included here use aggregated data, meaning there is a single URL for all the data of this type on the server. Some data that you encounter might be non-aggregated, meaning there are multiple URLs to access the same data. In these cases, you will need to create more than one geojob and join data at the end.</p>
<p>Now that we have explored options for our webdata, let’s look at what options exist for geospatial features.</p>
</div>
</div>
<div id="available-webgeoms" class="section level2">
<h2><span class="header-section-number">8.23</span> Available webgeoms</h2>
<p>The next component to <code>geoknife</code> jobs is the spatial extent of the data, a.k.a. the stencil. The stencil is defined by using either of the functions <code>simplegeom</code> or <code>webgeom</code>. <code>simplegeom</code> is used to explicitly define an area by the user, but <code>webgeom</code> is used to specify an existing web feature service (WFS) as the geospatial extent. Defining your stencil using <code>simplegeom</code> will be covered in the next lesson. This lesson will just show you how to learn what available webgeoms exist. Users can use any WFS url to create their stencil, but there are a number of features that exist through GDP already. To determine what features exist, you can create a default webgeom object and then query its geom name, attributes, and values. This will return all available GDP default features.</p>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb857-1" data-line-number="1"><span class="co"># setup a default stencil by using webgeom and not supplying any arguments</span></a>
<a class="sourceLine" id="cb857-2" data-line-number="2">default_stencil &lt;-<span class="st"> </span><span class="kw">webgeom</span>()</a>
<a class="sourceLine" id="cb857-3" data-line-number="3"></a>
<a class="sourceLine" id="cb857-4" data-line-number="4"><span class="co"># now determine what geoms are available with the default</span></a>
<a class="sourceLine" id="cb857-5" data-line-number="5">default_geoms &lt;-<span class="st"> </span><span class="kw">query</span>(default_stencil, <span class="st">&quot;geoms&quot;</span>)</a>
<a class="sourceLine" id="cb857-6" data-line-number="6"><span class="kw">length</span>(default_geoms)</a></code></pre></div>
<pre><code>## [1] 29</code></pre>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb859-1" data-line-number="1"><span class="kw">head</span>(default_geoms)</a></code></pre></div>
<pre><code>## [1] &quot;upload:Ag_Lands_ICC&quot;                   
## [2] &quot;upload:Ag_Lands_ICC_ForOnlineProcesses&quot;
## [3] &quot;upload:Ag_Lands_Reservation&quot;           
## [4] &quot;upload:Airport_Polygon&quot;                
## [5] &quot;sample:Alaska&quot;                         
## [6] &quot;upload:BB_LPK&quot;</code></pre>
<p>You will notice a pattern with the names of the geoms: a category followed by <code>:</code>, and then a specific name. These category-name combinations are the strings you would use to define your geom. Additionally, <code>webgeom</code> can accept a URL that points directly to a WFS. The categories you should be familiar with are <code>sample</code> and <code>upload</code>. <code>sample</code> geoms are any that are available through <code>geoknife</code> by default. <code>upload</code> geoms are custom shapefiles that someone uploaded through GDP. If you would like to upload a specific shapefile to GDP, follow <a href="https://my.usgs.gov/confluence/display/GeoDataPortal/Detailed+GDP+Use+Instructions#DetailedGDPUseInstructions-UsinganUploadedShapefile">these instructions</a>. <strong>Be aware that uploaded shapefiles are wiped from the server at regular intervals (could be as often as weekly)</strong>. To use your own shapefile: upload it, execute your job and then save the output; re-upload your shapefile the next time you need it on GDP.</p>
<p>Similar to fabrics where you could not query times without setting the variables, you cannot query attributes of stencils before defining the geoms. Likewise, you cannot query for values of a stencil until you have set the attributes. Attributes give the metadata associated with the stencil and it’s geom. Values tell you the individual spatial features available in that attribute of the geom.</p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb861-1" data-line-number="1"><span class="co"># add a geom to see what values are available</span></a>
<a class="sourceLine" id="cb861-2" data-line-number="2"><span class="kw">geom</span>(default_stencil)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb863-1" data-line-number="1"><span class="kw">geom</span>(default_stencil) &lt;-<span class="st"> &quot;sample:CONUS_states&quot;</span></a>
<a class="sourceLine" id="cb863-2" data-line-number="2"></a>
<a class="sourceLine" id="cb863-3" data-line-number="3"><span class="co"># now that geom is set, you can query for available attributes</span></a>
<a class="sourceLine" id="cb863-4" data-line-number="4"><span class="kw">query</span>(default_stencil, <span class="st">&quot;attributes&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;STATE&quot; &quot;FIPS&quot;</code></pre>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb865-1" data-line-number="1"><span class="kw">attribute</span>(default_stencil) &lt;-<span class="st"> &quot;STATE&quot;</span></a>
<a class="sourceLine" id="cb865-2" data-line-number="2"></a>
<a class="sourceLine" id="cb865-3" data-line-number="3"><span class="co"># now that attribute is set, you can query for available values</span></a>
<a class="sourceLine" id="cb865-4" data-line-number="4">STATE_values &lt;-<span class="st"> </span><span class="kw">query</span>(default_stencil, <span class="st">&quot;values&quot;</span>)</a>
<a class="sourceLine" id="cb865-5" data-line-number="5"><span class="kw">head</span>(STATE_values)</a></code></pre></div>
<pre><code>## [1] &quot;Alabama&quot;     &quot;Arizona&quot;     &quot;Arkansas&quot;    &quot;California&quot;  &quot;Colorado&quot;   
## [6] &quot;Connecticut&quot;</code></pre>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb867-1" data-line-number="1"><span class="co"># switch the stencil to see the differences</span></a>
<a class="sourceLine" id="cb867-2" data-line-number="2">ecoreg_stencil &lt;-<span class="st"> </span>default_stencil</a>
<a class="sourceLine" id="cb867-3" data-line-number="3"><span class="kw">geom</span>(ecoreg_stencil) &lt;-<span class="st"> &quot;sample:Ecoregions_Level_III&quot;</span></a>
<a class="sourceLine" id="cb867-4" data-line-number="4"><span class="kw">query</span>(ecoreg_stencil, <span class="st">&quot;attributes&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;LEVEL3_NAM&quot;</code></pre>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb869-1" data-line-number="1"><span class="kw">attribute</span>(ecoreg_stencil) &lt;-<span class="st"> &quot;LEVEL3_NAM&quot;</span></a>
<a class="sourceLine" id="cb869-2" data-line-number="2">ecoreg_values &lt;-<span class="st"> </span><span class="kw">query</span>(ecoreg_stencil, <span class="st">&quot;values&quot;</span>)</a>
<a class="sourceLine" id="cb869-3" data-line-number="3"><span class="kw">head</span>(ecoreg_values)</a></code></pre></div>
<pre><code>## [1] &quot;Ahklun And Kilbuck Mountains&quot; &quot;Alaska Peninsula Mountains&quot;  
## [3] &quot;Alaska Range&quot;                 &quot;Aleutian Islands&quot;            
## [5] &quot;Arctic Coastal Plain&quot;         &quot;Arctic Foothills&quot;</code></pre>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb871-1" data-line-number="1"><span class="co"># now set the values to the Driftless Area and Blue Ridge ecoregions</span></a>
<a class="sourceLine" id="cb871-2" data-line-number="2"><span class="kw">values</span>(ecoreg_stencil) &lt;-<span class="st"> </span>ecoreg_values[<span class="kw">c</span>(<span class="dv">12</span>, <span class="dv">33</span>)]</a>
<a class="sourceLine" id="cb871-3" data-line-number="3"><span class="kw">values</span>(ecoreg_stencil)</a></code></pre></div>
<pre><code>## [1] &quot;Blue Ridge&quot;     &quot;Driftless Area&quot;</code></pre>
<p>There are some built-in templates that allow stencils to be defined more specifically. Currently, the package only supports US States, Level III Ecoregions, or HUC8s. Below are shortcuts to setting the geom, attribute, and values.</p>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb873-1" data-line-number="1"><span class="co"># creating geoms from the available templates</span></a>
<a class="sourceLine" id="cb873-2" data-line-number="2"><span class="kw">webgeom</span>(<span class="st">&#39;state::Wisconsin&#39;</span>)</a></code></pre></div>
<pre><code>## An object of class &quot;webgeom&quot;:
## url: https://cida.usgs.gov/gdp/geoserver/wfs 
## geom: sample:CONUS_states 
## attribute: STATE 
## values: Wisconsin 
## wfs version: 1.1.0</code></pre>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb875-1" data-line-number="1"><span class="kw">webgeom</span>(<span class="st">&#39;state::Wisconsin,Maine&#39;</span>) <span class="co"># multiple states separated by comma</span></a></code></pre></div>
<pre><code>## An object of class &quot;webgeom&quot;:
## url: https://cida.usgs.gov/gdp/geoserver/wfs 
## geom: sample:CONUS_states 
## attribute: STATE 
## values: Wisconsin, Maine 
## wfs version: 1.1.0</code></pre>
<div class="sourceCode" id="cb877"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb877-1" data-line-number="1"><span class="kw">webgeom</span>(<span class="st">&#39;HUC8::09020306,14060009&#39;</span>) <span class="co"># multiple HUCs separated by comma</span></a></code></pre></div>
<pre><code>## An object of class &quot;webgeom&quot;:
## url: https://cida.usgs.gov/gdp/geoserver/wfs 
## geom: sample:simplified_huc8 
## attribute: HUC_8 
## values: 09020306, 14060009 
## wfs version: 1.1.0</code></pre>
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb879-1" data-line-number="1"><span class="kw">webgeom</span>(<span class="st">&#39;ecoregion::Colorado Plateaus,Driftless Area&#39;</span>) <span class="co"># multiple ecoregions separated by comma</span></a></code></pre></div>
<pre><code>## An object of class &quot;webgeom&quot;:
## url: https://cida.usgs.gov/gdp/geoserver/wfs 
## geom: sample:Ecoregions_Level_III 
## attribute: LEVEL3_NAM 
## values: Colorado Plateaus, Driftless Area 
## wfs version: 1.1.0</code></pre>
</div>
<div id="available-webprocesses" class="section level2">
<h2><span class="header-section-number">8.24</span> Available webprocesses</h2>
<p>The final component to a geojob is the process algorithm used to aggregate the data across the defined stencil. Web process algorithms can be defined by the user, but let’s explore the defaults available through GDP.</p>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb881-1" data-line-number="1"><span class="co"># setup a default knife by using webprocess and not supplying any arguments</span></a>
<a class="sourceLine" id="cb881-2" data-line-number="2">default_knife &lt;-<span class="st"> </span><span class="kw">webprocess</span>()</a>
<a class="sourceLine" id="cb881-3" data-line-number="3"></a>
<a class="sourceLine" id="cb881-4" data-line-number="4"><span class="co"># now determine what web processing algorithms are available with the default</span></a>
<a class="sourceLine" id="cb881-5" data-line-number="5">default_algorithms &lt;-<span class="st"> </span><span class="kw">query</span>(default_knife, <span class="st">&#39;algorithms&#39;</span>)</a>
<a class="sourceLine" id="cb881-6" data-line-number="6"><span class="kw">length</span>(default_algorithms)</a></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb883-1" data-line-number="1"><span class="kw">head</span>(default_algorithms)</a></code></pre></div>
<pre><code>## $`Timeseries Service Subset`
## [1] &quot;gov.usgs.cida.gdp.wps.algorithm.FeatureTimeSeriesAlgorithm&quot;
## 
## $`Categorical Coverage Fraction`
## [1] &quot;gov.usgs.cida.gdp.wps.algorithm.FeatureCategoricalGridCoverageAlgorithm&quot;
## 
## $`OPeNDAP Subset`
## [1] &quot;gov.usgs.cida.gdp.wps.algorithm.FeatureCoverageOPeNDAPIntersectionAlgorithm&quot;
## 
## $`Area Grid Statistics (unweighted)`
## [1] &quot;gov.usgs.cida.gdp.wps.algorithm.FeatureGridStatisticsAlgorithm&quot;
## 
## $`Area Grid Statistics (weighted)`
## [1] &quot;gov.usgs.cida.gdp.wps.algorithm.FeatureWeightedGridStatisticsAlgorithm&quot;
## 
## $`WCS Subset`
## [1] &quot;gov.usgs.cida.gdp.wps.algorithm.FeatureCoverageIntersectionAlgorithm&quot;</code></pre>
<p>From this list, you can define which algorithm you would like the webprocess component to use. Definitions of each of the default algorithms can be found in the Geo Data Portal Algorithm Summaries section of the <a href="https://my.usgs.gov/confluence/display/GeoDataPortal/GDP+Home">home page for GDP documentation</a>. For example, we want to use the OPeNDAP subsetting algorithm, “OPeNDAP Subset”.</p>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb885-1" data-line-number="1"><span class="co"># algorithm actually has a default of the weighted average</span></a>
<a class="sourceLine" id="cb885-2" data-line-number="2"><span class="kw">algorithm</span>(default_knife)</a></code></pre></div>
<pre><code>## $`Area Grid Statistics (weighted)`
## [1] &quot;gov.usgs.cida.gdp.wps.algorithm.FeatureWeightedGridStatisticsAlgorithm&quot;</code></pre>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb887-1" data-line-number="1"><span class="co"># change the algorithm to OPeNDAP&#39;s subset</span></a>
<a class="sourceLine" id="cb887-2" data-line-number="2"><span class="kw">algorithm</span>(default_knife) &lt;-<span class="st"> </span>default_algorithms[<span class="st">&#39;OPeNDAP Subset&#39;</span>]</a>
<a class="sourceLine" id="cb887-3" data-line-number="3"><span class="kw">algorithm</span>(default_knife)</a></code></pre></div>
<pre><code>## $`OPeNDAP Subset`
## [1] &quot;gov.usgs.cida.gdp.wps.algorithm.FeatureCoverageOPeNDAPIntersectionAlgorithm&quot;</code></pre>
<p>Now that we can explore all of our options, we will learn how to construct each component and execute a geojob in the next lesson.</p>
</div>
<div id="setting-up-a-geojob" class="section level2">
<h2><span class="header-section-number">8.25</span> Setting up a geojob</h2>
<p>A <code>geojob</code> is the object that contains all of the necessary processing information to execute a data request to GDP. The <code>geojob</code> is made up of the <code>stencil</code>, <code>fabric</code>, and <code>knife</code> (if you need to learn what these components are, please visit <a href="/usgs-packages/geoknife-data">the previous lesson</a>).</p>
<p>To create a <code>geojob</code>, use the function <code>geoknife</code> and give the three components as arguments. <code>stencil</code> and <code>fabric</code> must be indicated, but <code>knife</code> has a default. Any additional arguments are specifications for the webprocessing step. See <code>?'webprocess-class'</code> for options. This lesson will not discuss all of the options.</p>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb889-1" data-line-number="1"><span class="co"># load the geoknife package</span></a>
<a class="sourceLine" id="cb889-2" data-line-number="2"><span class="kw">library</span>(geoknife)</a></code></pre></div>
<p>Let’s setup a <code>geojob</code> to find the unweighted annual evapotranspiration rates for the state of Indiana using the annual evapotranspiration data we saw in <a href="/usgs-packages/geoknife-data/#available-webdata">the previous lesson</a>. Since we have seen the URL and know the available variables and times, we can set all of that manually in the <code>webdata</code> function. Note: the times field must be a vector of start then end date, and be class <code>POSIXct</code>.</p>
<div class="sourceCode" id="cb890"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb890-1" data-line-number="1"><span class="co"># create fabric</span></a>
<a class="sourceLine" id="cb890-2" data-line-number="2">evap_fabric_info &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">times =</span> <span class="kw">as.POSIXct</span>(<span class="kw">c</span>(<span class="st">&quot;2005-01-01&quot;</span>, <span class="st">&quot;2015-01-01&quot;</span>)),</a>
<a class="sourceLine" id="cb890-3" data-line-number="3">                         <span class="dt">variables =</span> <span class="st">&quot;et&quot;</span>,</a>
<a class="sourceLine" id="cb890-4" data-line-number="4">                         <span class="dt">url =</span> <span class="st">&#39;https://cida.usgs.gov/thredds/dodsC/ssebopeta/yearly&#39;</span>)</a>
<a class="sourceLine" id="cb890-5" data-line-number="5">evap_fabric &lt;-<span class="st"> </span><span class="kw">webdata</span>(evap_fabric_info)</a>
<a class="sourceLine" id="cb890-6" data-line-number="6"></a>
<a class="sourceLine" id="cb890-7" data-line-number="7"><span class="co"># create stencil</span></a>
<a class="sourceLine" id="cb890-8" data-line-number="8">evap_stencil &lt;-<span class="st"> </span><span class="kw">webgeom</span>(<span class="st">&#39;state::Indiana&#39;</span>)</a>
<a class="sourceLine" id="cb890-9" data-line-number="9"></a>
<a class="sourceLine" id="cb890-10" data-line-number="10"><span class="co"># create knife (which defaults to weighted)</span></a>
<a class="sourceLine" id="cb890-11" data-line-number="11">evap_knife &lt;-<span class="st"> </span><span class="kw">webprocess</span>()</a>
<a class="sourceLine" id="cb890-12" data-line-number="12"><span class="co"># find unweighted algorithm</span></a>
<a class="sourceLine" id="cb890-13" data-line-number="13">all_algorithms &lt;-<span class="st"> </span><span class="kw">query</span>(evap_knife, <span class="st">&#39;algorithms&#39;</span>)</a>
<a class="sourceLine" id="cb890-14" data-line-number="14">unw_algorithm &lt;-<span class="st"> </span>all_algorithms[<span class="kw">grep</span>(<span class="st">&#39;unweighted&#39;</span>, <span class="kw">names</span>(all_algorithms))]</a>
<a class="sourceLine" id="cb890-15" data-line-number="15"><span class="co"># set knife algorithm to unweighted</span></a>
<a class="sourceLine" id="cb890-16" data-line-number="16"><span class="kw">algorithm</span>(evap_knife) &lt;-<span class="st"> </span>unw_algorithm</a>
<a class="sourceLine" id="cb890-17" data-line-number="17"></a>
<a class="sourceLine" id="cb890-18" data-line-number="18"><span class="co"># create the geojob</span></a>
<a class="sourceLine" id="cb890-19" data-line-number="19">evap_geojob &lt;-<span class="st"> </span><span class="kw">geoknife</span>(evap_stencil, evap_fabric, evap_knife)</a></code></pre></div>
</div>
<div id="checking-the-geojob-status" class="section level2">
<h2><span class="header-section-number">8.26</span> Checking the geojob status</h2>
<p>The geojob has been created and started on the server. Now, you can check to see if the processing is complete by using <code>check</code>.</p>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb891-1" data-line-number="1"><span class="kw">check</span>(evap_geojob)</a></code></pre></div>
<pre><code>## $status
## [1] &quot;Process successful&quot;
## 
## $URL
## [1] &quot;https://cida.usgs.gov:443/gdp/process/RetrieveResultServlet?id=1033380f-85b6-4023-9bcb-99b669a8bfa0OUTPUT&quot;
## 
## $statusType
## [1] &quot;ProcessSucceeded&quot;
## 
## $percentComplete
## [1] &quot;100&quot;</code></pre>
<p>Other helpful functions to get status information about the job are <code>running</code> (returns T/F to say if the job is still processing), <code>error</code> (returns T/F to say if there was an error during the processing), and <code>successful</code> (returns T/F indicating whether the job process was able to complete without any issues). Only one of these can return <code>TRUE</code> at a time.</p>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb893-1" data-line-number="1"><span class="kw">running</span>(evap_geojob)</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb895-1" data-line-number="1"><span class="kw">error</span>(evap_geojob)</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb897-1" data-line-number="1"><span class="kw">successful</span>(evap_geojob)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>The results of all the status checks say that our job was successful! These status checks are useful if you put a geojob in a script and want to fail gracefully when there is an error in the job.</p>
</div>
<div id="getting-geojob-data" class="section level2">
<h2><span class="header-section-number">8.27</span> Getting geojob data</h2>
<p>Since this job has finished processing and was successful, you can now get the data. You’ll notice that <code>evap_geojob</code> does not actually contain any data. It only contains information about the job that you submitted. To get the data, you need to use <code>result</code> or <code>download</code>. The feature summary algorithms will return simple tabular data, so you can use <code>result</code> to automatically take the output and parse it into an R <code>data.frame</code>. We used a feature summary algorithm in the evapotranspiration example, which returned tabular data. So, let’s use <code>result</code> to get the <code>geojob</code> output.</p>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb899-1" data-line-number="1">evap_data &lt;-<span class="st"> </span><span class="kw">result</span>(evap_geojob)</a>
<a class="sourceLine" id="cb899-2" data-line-number="2"><span class="kw">nrow</span>(evap_data)</a></code></pre></div>
<pre><code>## [1] 11</code></pre>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb901-1" data-line-number="1"><span class="kw">head</span>(evap_data)</a></code></pre></div>
<pre><code>##     DateTime  Indiana variable statistic
## 1 2005-01-01 603.7376       et      MEAN
## 2 2006-01-01 688.1866       et      MEAN
## 3 2007-01-01 576.3254       et      MEAN
## 4 2008-01-01 691.2009       et      MEAN
## 5 2009-01-01 689.2706       et      MEAN
## 6 2010-01-01 630.4045       et      MEAN</code></pre>
<p>There are additional algorithms that return subsets of the raw data as netcdf or geotiff formats. These formats will require you to handle the output manually using <code>download</code>. Use this function to download the output to a file and then read it using your preferred data parsing method. <code>download</code> can also be used for tabular data if you have a parsing method that differs from what is used in <code>result</code>. See <code>?download</code> for more information.</p>
</div>
<div id="wait-and-email" class="section level2">
<h2><span class="header-section-number">8.28</span> <code>wait</code> and <code>email</code></h2>
<p>This was not a computationally or spatially intensive request, so the job finished almost immediately. However, if we had setup a more complex job, it could still be running. Even though the processing of these large gridded datasets uses resources on a remote server, your workflow needs to account for processing time before using the results. There are a few scenarios to consider:</p>
<ol style="list-style-type: decimal">
<li>You are manually executing a job and manually checking it.</li>
<li>You are running a script that kicks off a <code>geoknife</code> process followed by lines of code that use the returned data.</li>
<li>You are running a long <code>geoknife</code> process and want to be able to close R/RStudio and come back to a completed job later.</li>
</ol>
<p>For the first scenario, the workflow from above was fine. If you are manually checking that the job has completed before trying to extract results, then nothing should fail.</p>
<p>For the second scenario, your code will fail because it will continue to execute the code line by line after starting the job. So, your code will fail at the code that gets the data (<code>result</code>/<code>download</code>) since the job is still running. You can prevent scripts from continuing until the job is complete by using the function <code>wait</code>. This function makes a call to GDP at specified intervals to see if the job is complete, and allows the code to continue once the job is complete. This function has two arguments: the <code>geojob</code> object and <code>sleep.time</code>. <code>sleep.time</code> defines the interval at which to check the status of the job in seconds (the default for <code>sleep.time</code> is 5 seconds). Please try to adjust <code>sleep.time</code> to limit the number of calls to GDP, e.g. if you know the job will take about an hour, set <code>sleep.time=120</code> (2 min) because every 5 seconds would be excessive.</p>
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb903-1" data-line-number="1"><span class="co"># typical wait workflow</span></a>
<a class="sourceLine" id="cb903-2" data-line-number="2">evap_geojob &lt;-<span class="st"> </span><span class="kw">geoknife</span>(evap_stencil, evap_fabric, evap_knife)</a>
<a class="sourceLine" id="cb903-3" data-line-number="3"><span class="kw">wait</span>(evap_geojob, <span class="dt">sleep.time =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb903-4" data-line-number="4">evap_data &lt;-<span class="st"> </span><span class="kw">result</span>(evap_geojob)</a></code></pre></div>
<p>If you know ahead of time that your process will be long, you can tell the job to wait when defining your knife (the default is to not wait). <code>sleep.time</code> can be specified as an argument to <code>webprocess</code>. The following is functionally the same as the use of <code>wait()</code> from above.</p>
<div class="sourceCode" id="cb904"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb904-1" data-line-number="1"><span class="co"># create knife with the args wait and sleep.time</span></a>
<a class="sourceLine" id="cb904-2" data-line-number="2">evap_knife &lt;-<span class="st"> </span><span class="kw">webprocess</span>(<span class="dt">wait=</span><span class="ot">TRUE</span>, <span class="dt">sleep.time=</span><span class="dv">20</span>)</a>
<a class="sourceLine" id="cb904-3" data-line-number="3"></a>
<a class="sourceLine" id="cb904-4" data-line-number="4"><span class="co"># follow the same code from before to get the unweighted algorithm</span></a>
<a class="sourceLine" id="cb904-5" data-line-number="5">all_algorithms &lt;-<span class="st"> </span><span class="kw">query</span>(evap_knife, <span class="st">&#39;algorithms&#39;</span>)</a>
<a class="sourceLine" id="cb904-6" data-line-number="6">unw_algorithm &lt;-<span class="st"> </span>all_algorithms[<span class="kw">grep</span>(<span class="st">&#39;unweighted&#39;</span>, <span class="kw">names</span>(all_algorithms))]</a>
<a class="sourceLine" id="cb904-7" data-line-number="7"><span class="kw">algorithm</span>(evap_knife) &lt;-<span class="st"> </span>unw_algorithm</a>
<a class="sourceLine" id="cb904-8" data-line-number="8"></a>
<a class="sourceLine" id="cb904-9" data-line-number="9"><span class="co"># create geojob using knife w/ wait</span></a>
<a class="sourceLine" id="cb904-10" data-line-number="10">evap_geojob &lt;-<span class="st"> </span><span class="kw">geoknife</span>(evap_stencil, evap_fabric, evap_knife)</a>
<a class="sourceLine" id="cb904-11" data-line-number="11"></a>
<a class="sourceLine" id="cb904-12" data-line-number="12"><span class="co"># get result</span></a>
<a class="sourceLine" id="cb904-13" data-line-number="13">evap_data &lt;-<span class="st"> </span><span class="kw">result</span>(evap_geojob)</a></code></pre></div>
<p>As in the third scenario, if you have a job that will take a long time and plan to close R in the interim, you can specify the argument <code>email</code> when creating the knife. Then when you use your new knife in the <code>geoknife</code> call, it will send an email with appropriate information upon job completion (you will see <code>gdp_data@usgs.gov</code> as the sender).</p>
<div class="sourceCode" id="cb905"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb905-1" data-line-number="1"><span class="co"># example of how to specify an email address to get a job completion alert</span></a>
<a class="sourceLine" id="cb905-2" data-line-number="2">knife_willemail &lt;-<span class="st"> </span><span class="kw">webprocess</span>(<span class="dt">email=</span><span class="st">&#39;fake.email@gmail.com&#39;</span>)</a>
<a class="sourceLine" id="cb905-3" data-line-number="3">knife_willemail</a></code></pre></div>
<pre><code>## An object of class &quot;webprocess&quot;:
## url: https://cida.usgs.gov/gdp/process/WebProcessingService 
## algorithm: Area Grid Statistics (weighted) 
## web processing service version: 1.0.0 
## process inputs: 
##    SUMMARIZE_TIMESTEP: false
##    SUMMARIZE_FEATURE_ATTRIBUTE: false
##    DELIMITER: COMMA
##    REQUIRE_FULL_COVERAGE: true
##    STATISTICS: 
##    GROUP_BY: 
## wait: FALSE 
## email: fake.email@gmail.com</code></pre>
<p>The email alert will contain the completed job URL. Since this process requires you to leave R and get information from an email, it is often only recommended if you don’t plan to do further analysis in R. Otherwise, we recommend using the <code>wait()</code> function in a script. Use the URL as a string in this workflow to get your results:</p>
<div class="sourceCode" id="cb907"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb907-1" data-line-number="1">geojob &lt;-<span class="st"> </span><span class="kw">geojob</span>(<span class="st">&quot;my url as a string&quot;</span>)</a>
<a class="sourceLine" id="cb907-2" data-line-number="2"><span class="kw">check</span>(geojob)</a>
<a class="sourceLine" id="cb907-3" data-line-number="3">mydata &lt;-<span class="st"> </span><span class="kw">result</span>(geojob)</a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="nasas-earth-observing-system-eos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="frequently-asked-questions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/katharynduffy/katharynduffy.github.io/edit/master/08-USGS.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Environmental Informatics Using Research Infrastructures and their Data.pdf", "Environmental Informatics Using Research Infrastructures and their Data.epub"],
"toc": {
"collapse": "subsection"
},
"search": true
});
});
</script>

</body>

</html>
